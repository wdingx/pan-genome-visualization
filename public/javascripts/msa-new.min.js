require=function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require
if(!a&&l)return l(s,!0)
if(o)return o(s,!0)
var h=new Error("Cannot find module '"+s+"'")
throw h.code="MODULE_NOT_FOUND",h}var c=n[s]={exports:{}}
e[s][0].call(c.exports,function(t){var n=e[s][1][t]
return r(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s])
return r}({1:[function(t,e,n){function i(){}var r=e.exports={}
r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener
if(t)return function(t){return window.setImmediate(t)}
var i=[]
if(e){var r=document.createElement("div"),o=new MutationObserver(function(){var t=i.slice()
i.length=0,t.forEach(function(t){t()})})
return o.observe(r,{attributes:!0}),function(t){i.length||r.setAttribute("yes","no"),i.push(t)}}return n?(window.addEventListener("message",function(t){var e=t.source
if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),i.length>0)){var n=i.shift()
n()}},!0),function(t){i.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=i,r.addListener=i,r.once=i,r.off=i,r.removeListener=i,r.removeAllListeners=i,r.emit=i,r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],2:[function(t,e,n){var i,r,o,s=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e
return-1}
i=t("msa-colorschemes"),o=t("backbone-thin").Model,e.exports=r=o.extend({defaults:{scheme:"nucleotide",colorBackground:!0,showLowerCase:!0,opacity:.6},initialize:function(t,e,n){return this.colors=new i({seqs:e,conservation:function(){return n.scale(n.conservation())}}),n.on("reset",function(){return"dyn"===this.getSelectedScheme().type&&s.call(this.getSelectedScheme(),"reset")>=0?this.getSelectedScheme().reset():void 0},this)},addStaticScheme:function(t,e){return this.colors.addStaticScheme(t,e)},addDynScheme:function(t,e){return this.colors.addDynScheme(t,e)},getScheme:function(t){return this.colors.getScheme(t)},getSelectedScheme:function(){return this.colors.getScheme(this.get("scheme"))}})},{"backbone-thin":62,"msa-colorschemes":137}],3:[function(t,e,n){var i,r,o
r=t("backbone-thin").Model,o=t("underscore"),e.exports=i=r.extend({initialize:function(t,e){return null==this.get("hidden")&&this.set("hidden",[]),this.stats=e},calcHiddenColumns:function(t){var e,n,i,r,o
for(e=this.get("hidden"),o=t,i=0,r=e.length;r>i;i++)n=e[i],o>=n&&o++
return o-t}})},{"backbone-thin":62,underscore:150}],4:[function(t,e,n){var i,r
r=t("backbone-thin").Model,e.exports=i=r.extend({defaults:{registerMouseHover:!1,registerMouseClicks:!0,importProxy:"https://cors-anywhere.herokuapp.com/",eventBus:!0,alphabetSize:20,dropImport:!1,debug:!1,hasRef:!1,bootstrapMenu:!1,manualRendering:!1}})},{"backbone-thin":62}],5:[function(t,e,n){var i,r,o
i=t("../utils/loader"),r=t("backbone-thin").Model,e.exports=o=r.extend({initialize:function(t){return this.g=t},development:{"msa-tnt":"/node_modules/msa-tnt/build/bundle.js","biojs-io-newick":"/node_modules/biojs-io-newick/build/biojs-io-newick.min.js"},loadPackage:function(e,n){var r
try{return r=t(e),n(r)}catch(o){return i.loadScript(this._pkgURL(e),n)}},loadPackages:function(t,e){var n
return n=i.joinCb(function(){return e()},t.length),t.forEach(function(t){return function(e){return t.loadPackage(e,n)}}(this))},_pkgURL:function(t){var e
return e=this.g.config.get("debug")?this.development[t]:"http://wzrd.in/bundle/"+t+"@latest"}})},{"../utils/loader":35,"backbone-thin":62}],6:[function(t,e,n){var i,r,o,s,a,l
l=t("underscore"),r=t("backbone-thin").Model,a=r.extend({defaults:{type:"super"}}),s=a.extend({defaults:l.extend({},a.prototype.defaults,{type:"row",seqId:""}),inRow:function(t){return t===this.get("seqId")},inColumn:function(t){return!0},getLength:function(){return 1}}),i=a.extend({defaults:l.extend({},a.prototype.defaults,{type:"column",xStart:-1,xEnd:-1}),inRow:function(){return!0},inColumn:function(t){return xStart<=t&&t<=xEnd},getLength:function(){return xEnd-xStart}}),o=s.extend(l.extend({},l.pick(i,"inColumn"),l.pick(i,"getLength"),{defaults:l.extend({},i.prototype.defaults,s.prototype.defaults,{type:"pos"})})),e.exports.sel=a,e.exports.possel=o,e.exports.rowsel=s,e.exports.columnsel=i},{"backbone-thin":62,underscore:150}],7:[function(t,e,n){var i,r,o,s
s=t("./Selection"),o=t("underscore"),i=t("backbone-thin").Collection,e.exports=r=i.extend({model:s.sel,initialize:function(t,e){return null!=e?(this.g=e.g,this.listenTo(this.g,"residue:click",function(t){return this._handleE(t.evt,new s.possel({xStart:t.rowPos,xEnd:t.rowPos,seqId:t.seqId}))}),this.listenTo(this.g,"row:click",function(t){return this._handleE(t.evt,new s.rowsel({seqId:t.seqId}))}),this.listenTo(this.g,"column:click",function(t){return this._handleE(t.evt,new s.columnsel({xStart:t.rowPos,xEnd:t.rowPos+t.stepSize-1}))})):void 0},getSelForRow:function(t){return this.filter(function(e){return e.inRow(t)})},getSelForColumns:function(t){return this.filter(function(e){return e.inColumn(t)})},addJSON:function(t){return this.add(this._fromJSON(t))},_fromJSON:function(t){switch(t.type){case"column":return new s.columnsel(t)
case"row":return new s.rowsel(t)
case"pos":return new s.possel(t)}},resetJSON:function(t){return t=o.map(t,this._fromJSON),this.reset(t)},getBlocksForRow:function(t,e){var n,i,r,o,s,a,l,h
for(h=this.filter(function(e){return e.inRow(t)}),n=[],i=0,r=h.length;r>i;i++){if(l=h[i],"row"===l.attributes.type){n=function(){s=[]
for(var t=0;e>=0?e>=t:t>=e;e>=0?t++:t--)s.push(t)
return s}.apply(this)
break}n=n.concat(function(){a=[]
for(var t=o=l.attributes.xStart,e=l.attributes.xEnd;e>=o?e>=t:t>=e;e>=o?t++:t--)a.push(t)
return a}.apply(this))}return n},getAllColumnBlocks:function(t){var e,n,i,r,s,a,l,h,c
for(s=t.maxLen,c=t.withPos,e=[],n=t.withPos?this.filter(function(t){return null!=t.get("xStart")}):this.filter(function(t){return"column"===t.get("type")}),i=0,r=n.length;r>i;i++)h=n[i],e=e.concat(function(){l=[]
for(var t=a=h.attributes.xStart,e=h.attributes.xEnd;e>=a?e>=t:t>=e;e>=a?t++:t--)l.push(t)
return l}.apply(this))
return e=o.uniq(e)},invertRow:function(t){var e,n,i,r,a,l
for(l=this.where({type:"row"}),l=o.map(l,function(t){return t.attributes.seqId}),i=o.filter(t,function(t){return!(l.indexOf(t)>=0)}),a=[],n=0,r=i.length;r>n;n++)e=i[n],a.push(new s.rowsel({seqId:e}))
return this.reset(a)},invertCol:function(t){var e,n,i,r,a,l,h,c
if(l=this.where({type:"column"}),l=o.reduce(l,function(t,e){var n,i
return t.concat(function(){i=[]
for(var t=n=e.attributes.xStart,r=e.attributes.xEnd;r>=n?r>=t:t>=r;r>=n?t++:t--)i.push(t)
return i}.apply(this))},[]),i=o.filter(t,function(t){return!(l.indexOf(t)>=0)}),0!==i.length){for(a=[],c=h=i[0],n=0,r=i.length;r>n;n++)e=i[n],h+1===e?h=e:(a.push(new s.columnsel({xStart:c,xEnd:h})),c=h=e)
return c!==h&&a.push(new s.columnsel({xStart:c,xEnd:i[i.length-1]})),this.reset(a)}},_handleE:function(t,e){return t.ctrlKey||t.metaKey?this.add(e):this.reset([e])},_reduceColumns:function(){return this.each(function(t,e,n){var i,r,s,a,l,h,c,u,d,f,g
for(i=o.filter(n,function(t){return"column"===t.get("type")}),g=t.get("xStart"),f=t.get("xEnd"),l=o.filter(i,function(t){return t.get("xEnd")===g-1}),r=0,h=l.length;h>r;r++)a=l[r],a.set("xEnd",g)
for(d=o.filter(i,function(t){return t.get("xStart")===f+1}),s=0,c=d.length;c>s;s++)u=d[s],u.set("xStart",f)
return l.length>0||d.length>0?(console.log("removed el"),t.collection.remove(t)):void 0})}})},{"./Selection":6,"backbone-thin":62,underscore:150}],8:[function(t,e,n){var i,r
r=t("backbone-thin").Model,e.exports=i=r.extend({defaults:{searchText:""}})},{"backbone-thin":62}],9:[function(t,e,n){var i,r
i=t("backbone-thin").Model,e.exports=r=i.extend({defaults:{searchBox:-10,overviewBox:30,headerBox:-1,alignmentBody:0}})},{"backbone-thin":62}],10:[function(t,e,n){var i,r
i=t("backbone-thin").Model,e.exports=r=i.extend({defaults:{sequences:!0,markers:!0,metacell:!1,conserv:!1,overviewbox:!1,seqlogo:!1,gapHeader:!1,leftHeader:!0,labels:!0,labelName:!0,labelId:!0,labelPartition:!1,labelCheckbox:!1,metaGaps:!0,metaIdentity:!0,metaLinks:!0},constructor:function(t,e){return this.calcDefaults(e.model),i.apply(this,arguments)},initialize:function(){return this.listenTo(this,"change:metaLinks change:metaIdentity change:metaGaps",function(){return this.trigger("change:metacell")},this),this.listenTo(this,"change:labelName change:labelId change:labelPartition change:labelCheckbox",function(){return this.trigger("change:labels")},this),this.listenTo(this,"change:markers change:conserv change:seqlogo change:gapHeader",function(){return this.trigger("change:header")},this)},calcDefaults:function(t){var e,n
return t.length>0&&(n=t.at(0),e=n.get("ids"),void 0!==e&&0===Object.keys(e).length)?this.defaults.metaLinks=!1:void 0}})},{"backbone-thin":62}],11:[function(t,e,n){var i,r
i=t("backbone-thin").Model,e.exports=r=i.extend({constructor:function(t,e){return this.calcDefaults(e.model),i.apply(this,arguments),this.g=e.g,this.listenTo(this,"change:labelIdLength change:labelNameLength change:labelPartLength change:labelCheckLength",function(){return this.trigger("change:labelWidth",this.getLabelWidth())},this),this.listenTo(this,"change:metaLinksWidth change:metaIdentWidth change:metaGapWidth",function(){return this.trigger("change:metaWidth",this.getMetaWidth())},this),this},defaults:{alignmentWidth:"auto",alignmentHeight:225,columnWidth:15,rowHeight:15,autoResize:!0,textVisible:!0,labelIdLength:50,labelNameLength:100,labelPartLength:15,labelCheckLength:15,labelFontsize:13,labelLineHeight:"13px",markerFontsize:"10px",stepSize:1,markerStepSize:2,markerHeight:20,residueFont:"13",canvasEventScale:1,boxRectHeight:2,boxRectWidth:2,overviewboxPaddingTop:10,menuFontsize:"14px",menuItemFontsize:"14px",menuItemLineHeight:"14px",menuMarginLeft:"3px",menuPadding:"3px 4px 3px 4px",metaGapWidth:35,metaIdentWidth:40,metaLinksWidth:25,_alignmentScrollLeft:0,_alignmentScrollTop:0},calcDefaults:function(t){var e
return e=t.getMaxLength(),200>e&&t.length<30?this.defaults.boxRectWidth=this.defaults.boxRectHeight=5:void 0},getAlignmentWidth:function(t){return this.get("autoResize")&&void 0!==t?this.get("columnWidth")*t:void 0===this.get("alignmentWidth")||"auto"===this.get("alignmentWidth")||0===this.get("alignmentWidth")?this._adjustWidth():this.get("alignmentWidth")},setLeftOffset:function(t){var e
return e=t,e=Math.max(0,e),e-=this.g.columns.calcHiddenColumns(e),this.set("_alignmentScrollLeft",e*this.get("columnWidth"))},setTopOffset:function(t){var e,n,i,r,o,s
for(s=Math.max(0,t-1),e=0,n=i=0,r=s;r>=i;n=i+=1)o=this.model.at(n),e+=o.attributes.height||1
return this.set("_alignmentScrollTop",e*this.get("rowHeight"))},getLeftBlockWidth:function(){var t
return t=0,this.g.vis.get("labels")&&(t+=this.getLabelWidth()),this.g.vis.get("metacell")&&(t+=this.getMetaWidth()),t},getMetaWidth:function(){var t
return t=0,this.g.vis.get("metaGaps")&&(t+=this.get("metaGapWidth")),this.g.vis.get("metaIdentity")&&(t+=this.get("metaIdentWidth")),this.g.vis.get("metaLinks")&&(t+=this.get("metaLinksWidth")),t},getLabelWidth:function(){var t
return t=0,this.g.vis.get("labelName")&&(t+=this.get("labelNameLength")),this.g.vis.get("labelId")&&(t+=this.get("labelIdLength")),this.g.vis.get("labelPartition")&&(t+=this.get("labelPartLength")),this.g.vis.get("labelCheckbox")&&(t+=this.get("labelCheckLength")),t},_adjustWidth:function(){var t,e,n,i
if(void 0!==this.el&&void 0!==this.model)return n=null!=this.el.parentNode&&0!==this.el.parentNode.offsetWidth?this.el.parentNode.offsetWidth:document.body.clientWidth-35,e=n-this.getLeftBlockWidth(),t=this.getAlignmentWidth(this.model.getMaxLength()-this.g.columns.get("hidden").length),i=Math.min(e,t),i=Math.floor(i/this.get("columnWidth"))*this.get("columnWidth"),this.attributes.alignmentWidth=i},autoResize:function(){return this.get("autoResize")?this._adjustWidth(this.el,this.model):void 0},autoHeight:function(t){var e
return e=this.getMaxAlignmentHeight(),void 0!==t&&t>0&&(e=Math.min(e,t)),this.set("alignmentHeight",e)},setEl:function(t,e){return this.el=t,this.model=e},_checkScrolling:function(t,e){var n,i
return n=t[0],i=t[1],this.set("_alignmentScrollLeft",n,e),this.set("_alignmentScrollTop",i,e)},getMaxAlignmentHeight:function(){var t
return t=0,this.model.each(function(e){return t+=e.attributes.height||1}),t*this.get("rowHeight")},getMaxAlignmentWidth:function(){return this.model.getMaxLength()*this.get("columnWidth")}})},{"backbone-thin":62}],12:[function(t,e,n){var i,r,o,s,a,l,h,c,u,d,f,g
g=t("backbone-childs"),h=t("./views/ImportMenu"),a=t("./views/FilterMenu"),d=t("./views/SelectionMenu"),f=t("./views/VisMenu"),i=t("./views/ColorMenu"),u=t("./views/OrderingMenu"),s=t("./views/ExtraMenu"),o=t("./views/ExportMenu"),l=t("./views/HelpMenu"),r=t("./views/DebugMenu"),e.exports=c=g.extend({initialize:function(t){this.msa=t.msa,this.addView("10_import",new h({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("15_ordering",new u({model:this.msa.seqs,g:this.msa.g})),this.addView("30_selection",new d({model:this.msa.seqs,g:this.msa.g})),this.addView("50_color",new i({model:this.msa.seqs,g:this.msa.g})),this.addView("70_extra",new s({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("80_export",new o({model:this.msa.seqs,g:this.msa.g,msa:this.msa}))},render:function(){return this.renderSubviews(),this.el.setAttribute("class","smenubar"),this.el.appendChild(document.createElement("p"))}})},{"./views/ColorMenu":15,"./views/DebugMenu":16,"./views/ExportMenu":17,"./views/ExtraMenu":18,"./views/FilterMenu":19,"./views/HelpMenu":20,"./views/ImportMenu":21,"./views/OrderingMenu":22,"./views/SelectionMenu":23,"./views/VisMenu":24,"backbone-childs":60}],13:[function(t,e,n){e.exports.defaultmenu=t("./defaultmenu"),e.exports.menubuilder=t("./menubuilder")},{"./defaultmenu":12,"./menubuilder":14}],14:[function(t,e,n){var i,r
r=t("menu-builder"),e.exports=i=r.extend({buildDOM:function(){return this.on("new:node",this.buildNode),this.on("new:button",this.buildButton),this.on("new:menu",this.buildMenu),r.prototype.buildDOM.call(this)},buildNode:function(t){return null!=this.g?t.style.lineHeight=this.g.zoomer.get("menuItemLineHeight"):void 0},buildButton:function(t){return null!=this.g?(t.style.fontSize=this.g.zoomer.get("menuFontsize"),t.style.marginLeft=this.g.zoomer.get("menuMarginLeft"),t.style.padding=this.g.zoomer.get("menuPadding")):void 0},buildMenu:function(t){return null!=this.g?t.style.fontSize=this.g.zoomer.get("menuItemFontsize"):void 0}})},{"menu-builder":128}],15:[function(t,e,n){var i,r,o,s
r=t("../menubuilder"),o=t("underscore"),s=t("dom-helper"),e.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.listenTo(this.g.colorscheme,"change",function(){return this.render()})},render:function(){var t,e,n,i,r,o
for(i=this.setName("Color scheme"),this.removeAllNodes(),t=this.getColorschemes(),e=0,n=t.length;n>e;e++)r=t[e],this.addScheme(i,r)
return o="Background",o=this.g.colorscheme.get("colorBackground")?"Hide "+o:"Show "+o,this.addNode(o,function(t){return function(){return t.g.colorscheme.set("colorBackground",!t.g.colorscheme.get("colorBackground"))}}(this)),this.grey(i),s.removeAllChilds(this.el),this.el.appendChild(this.buildDOM()),this},addScheme:function(t,e){var n,i
return i={},n=this.g.colorscheme.get("scheme"),n===e.id&&(i.backgroundColor="#77ED80"),this.addNode(e.name,function(t){return function(){return t.g.colorscheme.set("scheme",e.id)}}(this),{style:i})},getColorschemes:function(){var t
return t=[],t.push({name:"Taylor",id:"taylor"}),t.push({name:"Buried",id:"buried"}),t.push({name:"Cinema",id:"cinema"}),t.push({name:"Clustal",id:"clustal"}),t.push({name:"Clustal2",id:"clustal2"}),t.push({name:"Helix",id:"helix"}),t.push({name:"Hydrophobicity",id:"hydro"}),t.push({name:"Lesk",id:"lesk"}),t.push({name:"MAE",id:"mae"}),t.push({name:"Nucleotide",id:"nucleotide"}),t.push({name:"Purine",id:"purine"}),t.push({name:"PID",id:"pid"}),t.push({name:"Strand",id:"strand"}),t.push({name:"Turn",id:"turn"}),t.push({name:"Zappo",id:"zappo"}),t.push({name:"No color",id:"foo"}),t},grey:function(t){return this.addNode("Shade",function(t){return function(){return t.g.colorscheme.set("showLowerCase",!1),t.model.each(function(t){var e,n
return n=t.get("seq"),e=[],o.each(n,function(t,n){return t===t.toLowerCase()?e.push(n):void 0}),t.set("grey",e)})}}(this)),this.addNode("Shade by threshold",function(t){return function(){var e,n,i,r,o,s,a
for(a=prompt("Enter threshold (in percent)",20),a/=100,o=t.model.getMaxLength(),e=t.g.stats.scale(t.g.stats.conservation()),n=[],i=r=0,s=o-1;s>=0?s>=r:r>=s;i=s>=0?++r:--r)e[i]<a&&n.push(i)
return t.model.each(function(t){return t.set("grey",n)})}}(this)),this.addNode("Shade selection",function(t){return function(){var e
return e=t.model.getMaxLength(),t.model.each(function(n){var i
return i=t.g.selcol.getBlocksForRow(n.get("id"),e),n.set("grey",i)})}}(this)),this.addNode("Reset shade",function(t){return function(){return t.g.colorscheme.set("showLowerCase",!0),t.model.each(function(t){return t.set("grey",[])})}}(this))}})},{"../menubuilder":14,"dom-helper":125,underscore:150}],16:[function(t,e,n){var i,r
r=t("../menubuilder"),e.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){return this.setName("Debug"),this.addNode("Get the code",function(t){return function(){return window.open("https://github.com/greenify/msa")}}(this)),this.addNode("Toggle mouseover events",function(t){return function(){return t.g.config.set("registerMouseHover",!t.g.config.get("registerMouseHover")),t.g.onAll(function(){return console.log(arguments)})}}(this)),this.addNode("Minimized width",function(t){return function(){return t.g.zoomer.set("alignmentWidth",600)}}(this)),this.addNode("Minimized height",function(t){return function(){return t.g.zoomer.set("alignmentHeight",120)}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":14}],17:[function(t,e,n){var i,r,o,s,a
s=t("../menubuilder"),o=t("biojs-io-fasta").writer,a=t("underscore"),r=t("../../utils/export"),e.exports=i=s.extend({initialize:function(t){return this.g=t.g,this.msa=t.msa,this.el.style.display="inline-block"},render:function(){return this.setName("Export"),this.addNode("Share view (URL)",function(t){return function(){return r.shareLink(t.msa,function(t){return window.open(t,"_blank")})}}(this)),this.addNode("View in Jalview",function(t){return function(){var e
return e=t.g.config.get("url"),null==e?alert("Sequence weren't imported via an URL"):e.indexOf("localhost")?r.publishWeb(t.msa,function(e){return r.openInJalview(e,t.g.colorscheme.get("scheme"))}):r.openInJalview(e,t.g.colorscheme.get("scheme"))}}(this)),this.addNode("Export alignment (FASTA)",function(t){return function(){return r.saveAsFile(t.msa,"all.fasta")}}(this)),this.addNode("Export alignment (URL)",function(t){return function(){return r.publishWeb(t.msa,function(t){return window.open(t,"_blank")})}}(this)),this.addNode("Export selected sequences (FASTA)",function(t){return function(){return r.saveSelection(t.msa,"selection.fasta")}}(this)),this.addNode("Export features (GFF)",function(t){return function(){return r.saveAnnots(t.msa,"features.gff3")}}(this)),this.addNode("Export MSA image (PNG)",function(t){return function(){return r.saveAsImg(t.msa,"biojs-msa.png")}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../../utils/export":32,"../menubuilder":14,"biojs-io-fasta":84,underscore:150}],18:[function(t,e,n){var i,r,o,s,a
o=t("../menubuilder"),s=t("../../model/Sequence"),r=t("../../utils/loader"),a=t("xhr"),e.exports=i=o.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.msa=t.msa},render:function(){var t,e
return this.setName("Extras"),e=this.g.stats,t=this.msa,this.addNode("Add consensus seq",function(t){return function(){var n,i
return n=e.consensus(),i=new s({seq:n,id:"0c",name:"Consenus"}),t.model.add(i),t.model.setRef(i),t.model.comparator=function(t){return!t.get("ref")},t.model.sort()}}(this)),this.addNode("Increase font size",function(t){return function(){var e,n,i
return e=t.g.zoomer.get("columnWidth"),n=e+5,t.g.zoomer.set("columnWidth",n),t.g.zoomer.set("rowHeight",n),i=.7*n,t.g.zoomer.set("residueFont",i),t.g.zoomer.set("labelFontSize",i)}}(this)),this.addNode("Decrease font size",function(t){return function(){var e,n,i
return e=t.g.zoomer.get("columnWidth"),n=e-2,t.g.zoomer.set("columnWidth",n),t.g.zoomer.set("rowHeight",n),i=.6*n,t.g.zoomer.set("residueFont",i),t.g.zoomer.set("labelFontSize",i),t.g.zoomer.get("columnWidth")<8?t.g.zoomer.set("textVisible",!1):void 0}}(this)),this.addNode("Jump to a column",function(t){return function(){var e
return e=prompt("Column","20"),0>e||e>t.model.getMaxLength()||isNaN(e)?void alert("invalid column"):t.g.zoomer.setLeftOffset(e)}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../../model/Sequence":28,"../../utils/loader":35,"../menubuilder":14,xhr:151}],19:[function(t,e,n){var i,r,o
r=t("../menubuilder"),o=t("underscore"),e.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){return this.setName("Filter"),this.addNode("Hide columns by threshold",function(t){return function(e){var n,i,r,o,s,a,l
for(l=prompt("Enter threshold (in percent)",20),l/=100,s=t.model.getMaxLength(),i=[],n=t.g.stats.scale(t.g.stats.conservation()),r=o=0,a=s-1;a>=0?a>=o:o>=a;r=a>=0?++o:--o)n[r]<l&&i.push(r)
return t.g.columns.set("hidden",i)}}(this)),this.addNode("Hide columns by selection",function(t){return function(){var e,n
return n=t.g.columns.get("hidden"),e=n.concat(t.g.selcol.getAllColumnBlocks({maxLen:t.model.getMaxLength(),withPos:!0})),t.g.selcol.reset([]),t.g.columns.set("hidden",e)}}(this)),this.addNode("Hide columns by gaps",function(t){return function(){var e,n,i,r,o,s,a,l,h
for(l=prompt("Enter threshold (in percent)",20),l/=100,s=t.model.getMaxLength(),i=[],r=o=0,a=s-1;a>=0?a>=o:o>=a;r=a>=0?++o:--o)n=0,h=0,t.model.each(function(t){return"-"===t.get("seq")[r]&&n++,h++}),e=n/h,e>l&&i.push(r)
return t.g.columns.set("hidden",i)}}(this)),this.addNode("Hide seqs by identity",function(t){return function(){var e
return e=prompt("Enter threshold (in percent)",20),e/=100,t.model.each(function(t){return t.get("identity")<e?t.set("hidden",!0):void 0})}}(this)),this.addNode("Hide seqs by selection",function(t){return function(){var e,n
return e=t.g.selcol.where({type:"row"}),n=o.map(e,function(t){return t.get("seqId")}),t.g.selcol.reset([]),t.model.each(function(t){return n.indexOf(t.get("id"))>=0?t.set("hidden",!0):void 0})}}(this)),this.addNode("Hide seqs by gaps",function(t){return function(){var e
return e=prompt("Enter threshold (in percent)",40),t.model.each(function(t,n){var i,r
return r=t.get("seq"),i=o.reduce(r,function(t,e){return"-"===e&&t++,t},0),i>e?t.set("hidden",!0):void 0})}}(this)),this.addNode("Reset",function(t){return function(){return t.g.columns.set("hidden",[]),t.model.each(function(t){return t.get("hidden")?t.set("hidden",!1):void 0})}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":14,underscore:150}],20:[function(t,e,n){var i,r
r=t("../menubuilder"),e.exports=i=r.extend({initialize:function(t){return this.g=t.g},render:function(){return this.setName("Help"),this.addNode("About the project",function(t){return function(){return window.open("https://github.com/greenify/msa")}}(this)),this.addNode("Report issues",function(t){return function(){return window.open("https://github.com/greenify/msa/issues")}}(this)),this.addNode("User manual",function(t){return function(){return window.open("https://github.com/greenify/msa/wiki")}}(this)),this.el.style.display="inline-block",this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":14}],21:[function(t,e,n){var i,r,o
r=t("../menubuilder"),o=t("koala-js"),e.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.msa=t.msa},render:function(){var t,e,n
return e=this.msa,n=o.mk("input"),n.type="file",n.style.display="none",n.multiple=!0,n.addEventListener("change",function(){var t
return t=n.files||[],e.u.file.importFiles(t)}),this.el.appendChild(n),t="(Fasta, Clustal, GFF, Jalview features, Newick)",this.setName("Import"),this.addNode("URL",function(e){return function(n){var i
return i=prompt("URL "+t,"http://rostlab.org/~goldberg/clustalw2-I20140818-215249-0556-53699878-pg.clustalw"),i.length>5?e.msa.u.file.importURL(i,function(){}):void 0}}(this)),this.addNode("From file "+t,function(t){return function(){return n.click()}}(this)),this.addNode("Drag & Drop",function(e){return function(){return alert("Yep. Just drag & drop your file "+t)}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":14,"koala-js":127}],22:[function(t,e,n){var i,r,o,s
i=t("../menubuilder"),s=t("dom-helper"),o=t("underscore"),e.exports=r=i.extend({initialize:function(t){return this.g=t.g,this.order="ID",this.el.style.display="inline-block"},setOrder:function(t){return this.order=t,this.render()},render:function(){var t,e,n,i,r
for(this.setName("Ordering"),this.removeAllNodes(),t=this.getComparators(),n=0,i=t.length;i>n;n++)r=t[n],this._addNode(r)
return e=this.buildDOM(),s.removeAllChilds(this.el),this.el.appendChild(e),this},_addNode:function(t){var e,n
return n=t.text,e={},n===this.order&&(e.backgroundColor="#77ED80"),this.addNode(n,function(e){return function(){return null!=t.precode&&t.precode(),e.model.comparator=t.comparator,e.model.sort(),e.setOrder(t.text)}}(this),{style:e})},getComparators:function(){var t,e,n
return t=[],t.push({text:"ID ↑",comparator:"id"}),t.push({text:"ID ↓",comparator:function(t,e){return-(""+t.get("id")).localeCompare(""+e.get("id"),[],{numeric:!0})}}),t.push({text:"Label ↑",comparator:"name"}),t.push({text:"Label ↓",comparator:function(t,e){return-t.get("name").localeCompare(e.get("name"))}}),t.push({text:"Seq ↑",comparator:"seq"}),t.push({text:"Seq ↓",comparator:function(t,e){return-t.get("seq").localeCompare(e.get("seq"))}}),n=function(t){return function(){return t.ident=t.g.stats.identity()}}(this),e=function(t){return function(){return t.gaps={},t.model.each(function(e){var n
return n=e.attributes.seq,t.gaps[e.id]=o.reduce(n,function(t,e){return"-"===e&&t++,t},0)/n.length})}}(this),t.push({text:"Identity ↑",comparator:function(t){return function(e,n){var i
return i=t.ident[e.id]-t.ident[n.id],i>0?1:0>i?-1:0}}(this),precode:n}),t.push({text:"Identity ↓",comparator:function(t){return function(e,n){var i
return i=t.ident[e.id]-t.ident[n.id],i>0?-1:0>i?1:0}}(this),precode:n}),t.push({text:"Gaps ↑",comparator:function(t){return function(e,n){var i
return i=t.gaps[e.id]-t.gaps[n.id],i>0?1:0>i?-1:0}}(this),precode:e}),t.push({text:"Gaps ↓",comparator:function(t){return function(e,n){var i
return i=t.gaps[e.id]-t.gaps[n.id],0>i?1:i>0?-1:0}}(this),precode:e}),t.push({text:"Consensus to top",comparator:function(t){return!t.get("ref")}}),t}})},{"../menubuilder":14,"dom-helper":125,underscore:150}],23:[function(t,e,n){var i,r
i=t("../menubuilder"),e.exports=r=i.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){return this.setName("Selection"),this.addNode("Find Motif (supports RegEx)",function(t){return function(){var e
return e=prompt("your search","D"),t.g.user.set("searchText",e)}}(this)),this.addNode("Invert columns",function(t){return function(){var e
return t.g.selcol.invertCol(function(){e=[]
for(var n=0,i=t.model.getMaxLength();i>=0?i>=n:n>=i;i>=0?n++:n--)e.push(n)
return e}.apply(this))}}(this)),this.addNode("Invert rows",function(t){return function(){return t.g.selcol.invertRow(t.model.pluck("id"))}}(this)),this.addNode("Reset",function(t){return function(){return t.g.selcol.reset()}}(this)),this.el.appendChild(this.buildDOM()),this}})},{"../menubuilder":14}],24:[function(t,e,n){var i,r,o
i=t("../menubuilder"),o=t("dom-helper"),e.exports=r=i.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.listenTo(this.g.vis,"change",this.render)},render:function(){var t,e,n,i
for(this.removeAllNodes(),this.setName("Vis.elements"),i=this.getVisElements(),t=0,e=i.length;e>t;t++)n=i[t],this._addVisEl(n)
return this.addNode("Reset",function(t){return function(){return t.g.vis.set("labels",!0),t.g.vis.set("sequences",!0),t.g.vis.set("metacell",!0),t.g.vis.set("conserv",!0),t.g.vis.set("labelId",!0),t.g.vis.set("labelName",!0),t.g.vis.set("labelCheckbox",!1),t.g.vis.set("seqlogo",!1),t.g.vis.set("gapHeader",!1),t.g.vis.set("leftHeader",!0),t.g.vis.set("metaGaps",!0),t.g.vis.set("metaIdentity",!0),t.g.vis.set("metaLinks",!0)}}(this)),o.removeAllChilds(this.el),this.el.appendChild(this.buildDOM()),this},_addVisEl:function(t){var e,n
return n={},this.g.vis.get(t.id)?(e="Hide ",n.color="red"):(e="Show ",n.color="green"),this.addNode(e+t.name,function(e){return function(){return e.g.vis.set(t.id,!e.g.vis.get(t.id))}}(this),{style:n})},getVisElements:function(){var t
return t=[],t.push({name:"Position markers",id:"markers"}),t.push({name:"Id/Name",id:"labels"}),t.push({name:"Meta info (gaps/identity)",id:"metacell"}),t.push({name:"Overviewpanel",id:"overviewbox"}),t.push({name:"Sequence logo",id:"seqlogo"}),t.push({name:"Gap weights",id:"gapHeader"}),t.push({name:"Conservation weights",id:"conserv"}),t.push({name:"Seq. name",id:"labelName"}),t.push({name:"Seq. id",id:"labelId"}),t.push({name:"Gaps %",id:"metaGaps"}),t.push({name:"Identity score",id:"metaIdentity"}),t.push({name:"Meta links",id:"metaLinks"}),t}})},{"../menubuilder":14,"dom-helper":125}],25:[function(t,e,n){var i,r
i=t("./Feature"),r=t("backbone-thin").Model,e.exports=i=r.extend({defaults:{xStart:-1,xEnd:-1,height:-1,text:"",fillColor:"red",fillOpacity:.5,type:"rectangle",borderSize:1,borderColor:"black",borderOpacity:.5,validate:!0,row:0},initialize:function(t){return null!=t.start&&this.set("xStart",t.start),null!=t.end&&this.set("xEnd",t.end),null!=t.attributes&&(null!=t.attributes.Name&&this.set("text",t.attributes.Name),null!=t.attributes.Color&&this.set("fillColor",t.attributes.Color)),this.attributes.xEnd<this.attributes.xStart&&console.warn("invalid feature range for",this.attributes),_.isNumber(this.attributes.xStart)&&_.isNumber(this.attributes.xEnd)?void 0:(console.warn("please provide numeric feature ranges",t),this.set("xStart",parseInt(this.attributes.xStart)),this.set("xEnd",parseInt(this.attributes.xEnd)))},validate:function(){return isNaN(this.attributes.xStart||isNaN(this.attributes.xEnd))?"features need integer start and end.":void 0},contains:function(t){return this.attributes.xStart<=t&&t<=this.attributes.xEnd}})},{"./Feature":25,"backbone-thin":62}],26:[function(t,e,n){var i,r,o,s
r=t("./Feature"),i=t("backbone-thin").Collection,s=t("underscore"),e.exports=o=i.extend({model:r,constructor:function(){return this.startOnCache=[],this.on("all",function(){return this.startOnCache=[]},this),i.apply(this,arguments)},startOn:function(t){return null==this.startOnCache[t]&&(this.startOnCache[t]=this.where({xStart:t})),this.startOnCache[t]},contains:function(t){return this.reduce(function(e,n){return n||e.contains(t)},!1)},getFeatureOnRow:function(t,e){return this.filter(function(n){return n.get("row")===t&&n.get("xStart")<=e&&e<=n.get("xEnd")})},assignRows:function(){var t,e,n
return t=this.max(function(t){return t.get("xEnd")}).attributes.xEnd,e=function(){var e,i,r
for(r=[],n=e=0,i=t;i>=0?i>=e:e>=i;n=i>=0?++e:--e)r.push(0)
return r}(),this.each(function(t){var i,r,o,s
for(r=0,n=i=o=t.get("xStart"),s=t.get("xEnd");s>=i;n=i+=1)e[n]>r&&(r=e[n]),e[n]++
return t.set("row",r)}),s.max(e)},getCurrentHeight:function(){return this.max(function(t){return t.get("row")}).attributes.row+1},getMinRows:function(){var t,e,n
return t=this.max(function(t){return t.get("xEnd")}).attributes.xEnd,e=function(){var e,i,r
for(r=[],n=e=0,i=t;i>=0?i>=e:e>=i;n=i>=0?++e:--e)r.push(0)
return r}(),this.each(function(t){var i,r,o,s
for(s=[],n=i=r=t.get("xStart"),o=t.get("xEnd");o>=i;n=i+=1)s.push(e[n]++)
return s}),s.max(e)}})},{"./Feature":25,"backbone-thin":62,underscore:150}],27:[function(t,e,n){var i,r,o,s
s=t("./Sequence"),r=t("./FeatureCol"),i=t("backbone-thin").Collection,e.exports=o=i.extend({model:s,constructor:function(t,e){return i.apply(this,arguments),this.g=e,this.on("add reset remove",function(t){return function(){return t.lengthCache=null,t._bindSeqsWithFeatures()}}(this),this),this.on("reset",function(t){return function(){return t._autoSetRefSeq()}}(this)),this._autoSetRefSeq(),this.lengthCache=null,this.features={},this},getMaxLength:function(){return 0===this.models.length?0:(null===this.lengthCache&&(this.lengthCache=this.max(function(t){return t.get("seq").length}).get("seq").length),this.lengthCache)},prev:function(t,e){var n
return n=this.indexOf(t)-1,0>n&&e&&(n=this.length-1),this.at(n)},next:function(t,e){var n
return n=this.indexOf(t)+1,n===this.length&&e&&(n=0),this.at(n)},calcHiddenSeqs:function(t){var e,n,i,r
for(i=t,e=n=0,r=i;r>=0?r>=n:n>=r;e=r>=0?++n:--n)this.at(e).get("hidden")&&i++
return i-t},addFeatures:function(t){var e,n
return null!=t.config&&(n=t,t=t.seqs,null!=n.config.colors&&(e=n.config.colors,_.each(t,function(t){return _.each(t,function(t){return null!=e[t.feature]?t.fillColor=e[t.feature]:void 0})}))),_.isEmpty(this.features)?this.features=t:_.each(t,function(t){return function(e,n){return t.features.hasOwnProperty(n)?t.features[n]=_.union(t.features[n],e):t.features[n]=e}}(this)),this._bindSeqsWithFeatures()},_bindSeqWithFeatures:function(t){var e
return e=this.features[t.attributes.name],e?(t.set("features",new r(e)),t.attributes.features.assignRows(),t.set("height",t.attributes.features.getCurrentHeight()+1)):void 0},_bindSeqsWithFeatures:function(){return this.each(function(t){return function(e){return t._bindSeqWithFeatures(e)}}(this))},removeAllFeatures:function(){return delete this.features},_autoSetRefSeq:function(){return this.length>0?this.at(0).set("ref",!0):void 0},setRef:function(t){var e
return e=this.get(t),this.each(function(n){return t.cid?e.cid===n.cid?n.set("ref",!0):n.set("ref",!1):void 0}),this.g.config.set("hasRef",!0),this.trigger("change:reference",t)}})},{"./FeatureCol":26,"./Sequence":28,"backbone-thin":62}],28:[function(t,e,n){var i,r,o
r=t("backbone-thin").Model,i=t("./FeatureCol"),e.exports=o=r.extend({defaults:{name:"",id:"",seq:"",height:1,ref:!1},initialize:function(){return this.set("grey",[]),null==this.get("features")?this.set("features",new i):void 0}})},{"./FeatureCol":26,"backbone-thin":62}],29:[function(t,e,n){e.exports.seq=t("./Sequence"),e.exports.seqcol=t("./SeqCollection"),e.exports.feature=t("./Feature"),e.exports.featurecol=t("./FeatureCol")},{"./Feature":25,"./FeatureCol":26,"./SeqCollection":27,"./Sequence":28}],30:[function(t,e,n){var i,r,o,s,a,l,h,c,u,d,f,g,p,m,v,b,x,w
d=t("./model/SeqCollection"),r=t("./g/colorscheme"),o=t("./g/columns"),s=t("./g/config"),h=t("./g/package"),u=t("./g/selection/SelectionCol"),m=t("./g/user"),b=t("./g/visibility"),v=t("./g/visOrdering"),x=t("./g/zoomer"),w=t("backbone-childs"),a=t("biojs-events"),f=t("./views/Stage"),g=t("stat.seqs"),i=t("jbone"),l=t("./utils/file"),p=t("./utils/tree"),c=t("./utils/proxy"),e.exports=w.extend({initialize:function(t){var e,n
return null==t&&(t={}),null==t.colorscheme&&(t.colorscheme={}),null==t.columns&&(t.columns={}),null==t.conf&&(t.conf={}),null==t.vis&&(t.vis={}),null==t.zoomer&&((null!=(n=t.visorder)?n:t.zoomer={})||(t.visorder={})),this.g=a.mixin({}),this.seqs=this.g.seqs=new d(t.seqs,this.g),this.g.config=new s(t.conf),this.g["package"]=new h(this.g),this.g.selcol=new u([],{g:this.g}),this.g.user=new m,this.g.vis=new b(t.vis,{model:this.seqs}),this.g.visorder=new v(t.visorder),this.g.zoomer=new x(t.zoomer,{g:this.g,model:this.seqs}),"localhost"===window.location.hostname&&this.g.config.set("debug",!0),this._loadSeqs(t),this.u={},this.u.file=new l(this),this.u.proxy=new c({g:this.g}),this.u.tree=new p(this),this.g.config.get("eventBus")===!0&&this.startEventBus(),this.g.config.get("dropImport")&&(e={dragover:this.dragOver,drop:this.dropFile},this.delegateEvents(e)),t.importURL&&this.u.file.importURL(t.importURL,function(t){return function(){return t.render()}}(this)),t.bootstrapMenu&&this.g.config.set("bootstrapMenu",!0),this.draw(),this.m()},_loadSeqs:function(t){var e
return e=this.seqs.pluck("seq"),this.g.stats=new g(this.seqs,{useGaps:!0}),this.g.stats.alphabetSize=this.g.config.get("alphabetSize"),this.g.columns=new o(t.columns,this.g.stats),this.g.colorscheme=new r(t.colorscheme,e,this.g.stats),this.g.zoomer.setEl(this.el,this.seqs)},importURL:function(){return this.u.file.importURL.apply(this.u.file,arguments)},m:function(){var e
return e={},e.model=t("./model"),e.selection=t("./g/selection/Selection"),e.selcol=t("./g/selection/SelectionCol"),e.view=t("backbone-viewj"),e.boneView=t("backbone-childs"),this.m=e},draw:function(){var t,e,n
return this.removeViews(),this.addView("stage",new f({model:this.seqs,g:this.g})),this.el.setAttribute("class","biojs_msa_div"),this.g.config.get("bootstrapMenu")&&(e=document.createElement("div"),n=document.createElement("div"),this.el.parentNode?(this.el.parentNode.replaceChild(n,this.el),n.appendChild(e),n.appendChild(this.el)):(n.appendChild(e),n.appendChild(this.el)),t=new msa.menu.defaultmenu({el:e,msa:this}),t.render()),i(window).on("resize",function(t){return function(e){var n
return n=function(){return this.g.zoomer.autoResize()},setTimeout(n.bind(t),5)}}(this))},dragOver:function(t){return t.preventDefault(),t.target.className="hover",!1},dropFile:function(t){var e
return t.preventDefault(),e=t.target.files||t.dataTransfer.files,this.u.file.importFiles(e),!1},startEventBus:function(){var t,e,n,i,r
for(t=["config","columns","colorscheme","selcol","vis","visorder","zoomer"],r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(this._proxyToG(n))
return r},_proxyToG:function(t){return this.listenTo(this.g[t],"all",function(e,n,i,r){return"change"!==e?null!=r?this.g.trigger(t+":"+e,i,n,r):this.g.trigger(t+":"+e,i,n):void 0})},render:function(){return void 0!==this.seqs&&0!==this.seqs.length||console.log("warning. empty seqs."),this.renderSubviews(),this.g.vis.set("loaded",!0),this}})},{"./g/colorscheme":2,"./g/columns":3,"./g/config":4,"./g/package":5,"./g/selection/Selection":6,"./g/selection/SelectionCol":7,"./g/user":8,"./g/visOrdering":9,"./g/visibility":10,"./g/zoomer":11,"./model":29,"./model/SeqCollection":27,"./utils/file":33,"./utils/proxy":36,"./utils/tree":39,"./views/Stage":43,"backbone-childs":60,"backbone-viewj":67,"biojs-events":71,jbone:126,"stat.seqs":149}],31:[function(t,e,n){var i
e.exports=i=function(){function t(){}return t.randomInt=function(t,e){var n,i
return null==e&&(n=[0,t],t=n[0],e=n[1]),t>e&&(i=[e,t],t=i[0],e=i[1]),Math.floor(Math.random()*(e-t+1)+t)},t.uniqueId=function(t){var e
for(null==t&&(t=8),e="";e.length<t;)e+=Math.random().toString(36).substr(2)
return e.substr(0,t)},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t}()},{}],32:[function(t,e,n){var i,r,o,s,a,l,h
r=t("biojs-io-fasta"),o=t("biojs-io-gff"),h=t("xhr"),a=t("blueimp_canvastoblob"),l=t("browser-saveas"),s=t("underscore"),e.exports=i={openInJalview:function(t,e){var n,i
return"."===t.charAt(0)&&(t=document.URL.substr(0,document.URL.lastIndexOf("/"))+"/"+t),t.indexOf("http")<0&&(n="http://"+window.location.hostname,t=n+t),t=encodeURIComponent(t),i="http://www.jalview.org/services/launchApp?open="+t,i+="&colour="+e,window.open(i,"_blank")},publishWeb:function(t,e){var n,i
return n=r.write(t.seqs.toJSON()),n=encodeURIComponent(n),i=t.u.proxy.corsURL("http://sprunge.biojs.net"),h({method:"POST",body:"sprunge="+n,uri:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(t,n,i){var r
return r=i.trim(),e(r)})},shareLink:function(t,e){var n,r,o
return o=t.g.config.get("importURL"),r="http://msa.biojs.net/app/?seq=",n=function(t){var n
return n=r+t,e?e(n):void 0},o?n(o):i.publishWeb(t,n)},saveAsFile:function(t,e){var n,i
return i=r.write(t.seqs.toJSON()),n=new Blob([i],{type:"text/plain"}),l(n,e)},saveSelection:function(t,e){var n,i,o,a,h,c
if(h=t.g.selcol.pluck("seqId"),console.log(h),h.length>0)for(h=t.seqs.filter(function(t){return s.contains(h,t.get("id"))}),i=o=0,a=h.length-1;a>=o;i=o+=1)h[i]=h[i].toJSON()
else h=t.seqs.toJSON(),console.warn("no selection found")
return c=r.write(h),n=new Blob([c],{type:"text/plain"}),l(n,e)},saveAnnots:function(t,e){var n,i,r
return i=t.seqs.map(function(t){var e
return i=t.get("features"),0!==i.length?(e=t.get("name"),i.each(function(t){return t.set("seqname",e)}),i.toJSON()):void 0}),i=s.flatten(s.compact(i)),console.log(i),r=o.exportLines(i),n=new Blob([r],{type:"text/plain"}),l(n,e)},saveAsImg:function(t,e){var n,i
return n=t.getView("stage").getView("body").getView("seqblock").el,null!=n?(i=n.toDataURL("image/png"),l(a(i),e,"image/png")):void 0}}},{"biojs-io-fasta":84,"biojs-io-gff":94,blueimp_canvastoblob:123,"browser-saveas":124,underscore:150,xhr:151}],33:[function(t,e,n){var i,r,o,s,a,l,h
r=t("biojs-io-fasta"),i=t("biojs-io-clustal"),s=t("biojs-io-gff"),a=t("underscore"),h=t("xhr"),e.exports=o=function(t){return this.msa=t,this},l={guessFileType:function(t){var e
switch(t=t.split("."),e=t[t.length(-1)]){case"aln":case"clustal":return i
case"fasta":return r
default:return r}},guessFileFromText:function(t){var e,n
return null==t?(console.warn("invalid file format"),["","error"]):("CLUSTAL"===t.substring(0,7)?(e=i,n="seqs"):">"===t.substring(0,1)?(e=r,n="seqs"):"("===t.substring(0,1)?n="newick":(e=s,n="features"),[e,n])},parseText:function(t){var e,n,i,r,o
return i=this.guessFileFromText(t),n=i[0],o=i[1],"seqs"===o?(r=n.parse(t),[r,o]):"features"===o?(e=n.parseSeqs(t),[e,o]):[t,o]},importFiles:function(t){var e,n,i,r,o,s
for(s=[],n=i=0,o=t.length-1;o>=i;n=i+=1)e=t[n],r=new FileReader,r.onload=function(t){return function(e){return t.importFile(e.target.result)}}(this),s.push(r.readAsText(e))
return s},importFile:function(t){var e,n,i,r
return i=this.parseText(t),n=i[0],r=i[1],"error"===r?"error":("seqs"===r?(this.msa.seqs.reset(n),this.msa.g.config.set("url","userimport"),this.msa.g.trigger("url:userImport")):"features"===r?this.msa.seqs.addFeatures(n):"newick"===r&&this.msa.u.tree.loadTree(function(e){return function(){return e.msa.u.tree.showTree(t)}}(this)),e=t.name)},importURL:function(t,e){return t=this.msa.u.proxy.corsURL(t),this.msa.g.config.set("url",t),h(t,function(n){return function(i,r,o){var s
if(i)return console.log(i)
if(s=n.importFile(o),"error"!==s)return n.msa.g.trigger("import:url",t),e?e():void 0}}(this))}},a.extend(o.prototype,l)},{"biojs-io-clustal":74,"biojs-io-fasta":84,"biojs-io-gff":94,underscore:150,xhr:151}],34:[function(t,e,n){e.exports.bmath=t("./bmath"),e.exports.proxy=t("./proxy"),e.exports.seqgen=t("./seqgen"),e.exports.file=t("./file"),e.exports["export"]=t("./export")},{"./bmath":31,"./export":32,"./file":33,"./proxy":36,"./seqgen":37}],35:[function(t,e,n){var i,r,o=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e
return-1}
i=t("koala-js"),e.exports=r={loadScript:function(t,e){var n,r
return n=i.mk("script"),n.type="text/javascript",n.src=t,n.async=!0,n.onload=n.onreadystatechange=function(){var t
return t||this.readyState&&"complete"!==this.readyState?void 0:(t=!0,e())},r=document.getElementsByTagName("script")[0],r.parentNode.appendChild(n)},joinCb:function(t,e,n){var i,r,s
return e=e||1,r=0,i=function(t,e){return null==t?s():function(){return o.call(t,"apply")>=0&&t.apply(e,arguments),s()}},s=function(){return r++,r===e?t.call(n):void 0},i}}},{"koala-js":127}],36:[function(t,e,n){var i,r,o
r=t("underscore"),e.exports=i=function(t){return this.g=t.g,this},o={corsURL:function(t){return document.URL.indexOf("localhost")>=0&&"/"===t[0]?t:"."===t.charAt(0)||"/"===t.charAt(0)?t:(t=t.replace("www.",""),t=t.replace("http://",""),t=this.g.config.get("importProxy")+t)}},r.extend(i.prototype,o)},{underscore:150}],37:[function(t,e,n){var i,r,o,s
r=t("biojs-model").seq,i=t("./bmath"),o=t("stat.seqs"),s=e.exports={_generateSequence:function(t){var e,n,i,r
for(r="",e=n=0,i=t-1;i>=n;e=n+=1)r+=s.getRandomChar()
return r},getDummySequences:function(t,e){var n,o,a,l
for(l=[],null==t&&(t=i.getRandomInt(3,5)),null==e&&(e=i.getRandomInt(50,200)),n=o=1,a=t;a>=o;n=o+=1)l.push(new r(s._generateSequence(e),"seq"+n,"r"+n))
return l},getRandomChar:function(t){var e
return e=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZ",e.charAt(Math.floor(Math.random()*e.length))},genConservedSequences:function(t,e,n){var a,l,h,c,u,d,f,g,p,m,v,b,x,w,y,_,S,k
for(S=[],null==t&&(t=i.getRandomInt(3,5)),null==e&&(e=i.getRandomInt(50,200)),n=n||"ACDEFGHIKLMNPQRSTVWY---",u=f=1,x=t;x>=f;u=f+=1)S[u-1]=""
for(k=.2,h=1,u=g=0,w=e-1;w>=g;u=g+=1)for(u%3===0&&(h=i.getRandomInt(50,100)/100),v=[],d=p=0,y=t-1;y>=p;d=p+=1){for(c=0;100>c&&(a=s.getRandomChar(n),l=o(v),l.addSeq(a),c++,!(Math.abs(h-l.scale(l.conservation())[0])<k)););S[d]+=a,v.push(a)}for(b=[],u=m=1,_=t;_>=m;u=m+=1)b.push(new r(S[u-1],"seq"+u,"r"+u))
return b}}},{"./bmath":31,"biojs-model":106,"stat.seqs":149}],38:[function(t,e,n){var i,r,o,s,a,l
l="http://www.w3.org/2000/svg",a=function(t,e){var n,i
for(n in e)i=e[n],t.setAttributeNS(null,n,i)
return t},i=function(t){var e
return e=document.createElementNS(l,"svg"),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e},s=function(t){var e
return e=document.createElementNS(l,"rect"),a(e,t)},r=function(t){var e
return e=document.createElementNS(l,"line"),a(e,t)},o=function(t){var e
return e=document.createElementNS(l,"polygon"),a(e,t)},e.exports.rect=s,e.exports.line=r,e.exports.polygon=o,e.exports.base=i},{}],39:[function(t,e,n){var i,r,o,s
r=t("underscore"),i=t("../model/SeqCollection"),e.exports=s=function(t){return this.msa=t,this},o={loadTree:function(t){return this.msa.g["package"].loadPackages(["msa-tnt","biojs-io-newick"],t)},showTree:function(e){var n,i,o,s,a,l,h,c
return o=this.require("biojs-io-newick"),s="string"==typeof e?o.parse_newick(e):e,i=this.require("msa-tnt"),l=new i.selections,c=document.createElement("div"),this.msa.el.insertBefore(c,this.msa.el.childNodes[0]),console.log(this.msa.seqs.models),console.log(s),a=i.app({seqs:this.msa.seqs.toJSON(),tree:s}),console.log("nodes",a),h=new i.adapters.tree({model:a,el:c,sel:l}),n=new i.adapters.msa({model:a,sel:l,msa:this.msa}),r.each(a.models,function(e){return delete e.collection,Object.setPrototypeOf(e,t("backbone-thin").Model.prototype)}),this.msa.seqs.reset(a.models),console.log(this.msa.seqs)},require:function(e){return t(e)}},r.extend(s.prototype,o)},{"../model/SeqCollection":27,"backbone-thin":62,underscore:150}],40:[function(t,e,n){var i,r,o
o=t("backbone-childs"),r=t("./canvas/CanvasSeqBlock"),i=t("./labels/LabelBlock"),e.exports=o.extend({initialize:function(t){var e,n
return this.g=t.g,e=new i({model:this.model,g:this.g}),e.ordering=-1,this.addView("labelblock",e),this.g.vis.get("sequences")&&(n=new r({model:this.model,g:this.g}),n.ordering=0,this.addView("seqblock",n)),this.listenTo(this.g.zoomer,"change:alignmentHeight",this.adjustHeight),this.listenTo(this.g.zoomer,"change:alignmentWidth",this.adjustWidth),this.listenTo(this.g.columns,"change:hidden",this.adjustHeight)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_albody",this.el.style.whiteSpace="nowrap",this.adjustHeight(),this.adjustWidth(),this},adjustHeight:function(){return"auto"===this.g.zoomer.get("alignmentHeight")?this.el.style.height=this.g.zoomer.get("rowHeight")*this.model.length+5:this.el.style.height=this.g.zoomer.get("alignmentHeight")},adjustWidth:function(){return this.el.style.width=this.getWidth()},getWidth:function(){var t
return t=0,t+=this.g.zoomer.getLeftBlockWidth(),this.g.vis.get("sequences")&&(t+=this.g.zoomer.get("alignmentWidth")),t}})},{"./canvas/CanvasSeqBlock":47,"./labels/LabelBlock":56,"backbone-childs":60}],41:[function(t,e,n){var i,r,o,s,a,l
l=t("backbone-viewj"),s=t("mouse-pos"),a=t("../g/selection/Selection"),o=t("jbone"),r=t("underscore"),e.exports=i=l.extend({className:"biojs_msa_overviewbox",tagName:"canvas",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:boxRectWidth change:boxRectHeight change:overviewboxPaddingTop",this.rerender),this.listenTo(this.g.selcol,"add reset change",this.rerender),this.listenTo(this.g.columns,"change:hidden",this.rerender),this.listenTo(this.g.colorscheme,"change:showLowerCase",this.rerender),this.listenTo(this.model,"change",r.debounce(this.rerender,5)),this.color=this.g.colorscheme.getSelectedScheme(),this.listenTo(this.g.colorscheme,"change:scheme",function(){return this.color=this.g.colorscheme.getSelectedScheme(),this.rerender()}),this.dragStart=[]},events:{click:"_onclick",mousedown:"_onmousedown"},rerender:function(){return this.g.config.get("manualRendering")?void 0:this.render()},render:function(){var t,e,n,i,r,o,s,a,l,h,c,u,d,f,g
for(this._createCanvas(),this.el.textContent="overview",this.el.style.marginTop=this.g.zoomer.get("overviewboxPaddingTop"),this.ctx.fillStyle="#999999",this.ctx.fillRect(0,0,this.el.width,this.el.height),l=this.g.zoomer.get("boxRectWidth"),a=this.g.zoomer.get("boxRectHeight"),n=this.g.columns.get("hidden"),d=this.g.colorscheme.get("showLowerCase"),g=-a,i=o=0,h=this.model.length-1;h>=o;i=o+=1)if(u=this.model.at(i).get("seq"),f=0,g+=a,this.model.at(i).get("hidden"))console.log(this.model.at(i).get("hidden")),this.ctx.fillStyle="grey",this.ctx.fillRect(0,g,u.length*l,a)
else for(r=s=0,c=u.length-1;c>=s;r=s+=1)t=u[r],d&&(t=t.toUpperCase()),e=this.color.getColor(t,{pos:r}),n.indexOf(r)>=0&&(e="grey"),null!=e&&(this.ctx.fillStyle=e,this.ctx.fillRect(f,g,l,a)),f+=l
return this._drawSelection()},_drawSelection:function(){var t,e,n,i,r,o,s,a,l
if(!(this.dragStart.length>0)||this.prolongSelection){for(o=this.g.zoomer.get("boxRectWidth"),r=this.g.zoomer.get("boxRectHeight"),n=r*this.model.length,this.ctx.fillStyle="#666666",this.ctx.globalAlpha=.9,t=e=0,s=this.g.selcol.length-1;s>=e;t=e+=1)a=this.g.selcol.at(t),"column"===a.get("type")?this.ctx.fillRect(o*a.get("xStart"),0,o*(a.get("xEnd")-a.get("xStart")+1),n):"row"===a.get("type")?(l=this.model.filter(function(t){return t.get("id")===a.get("seqId")})[0],i=this.model.indexOf(l),this.ctx.fillRect(0,r*i,o*l.get("seq").length,r)):"pos"===a.get("type")&&(l=this.model.filter(function(t){return t.get("id")===a.get("seqId")})[0],i=this.model.indexOf(l),this.ctx.fillRect(o*a.get("xStart"),r*i,o*(a.get("xEnd")-a.get("xStart")+1),r))
return this.ctx.globalAlpha=1}},_onclick:function(t){return this.g.trigger("meta:click",{seqId:this.model.get("id",{evt:t})})},_onmousemove:function(t){var e
if(0!==this.dragStart.length)return this.render(),this.ctx.fillStyle="#666666",this.ctx.globalAlpha=.9,e=this._calcSelection(s.abs(t)),this.ctx.fillRect(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0]),t.preventDefault(),t.stopPropagation()},_onmousedown:function(t){return this.dragStart=s.abs(t),this.dragStartRel=s.rel(t),t.ctrlKey||t.metaKey?this.prolongSelection=!0:this.prolongSelection=!1,o(document.body).on("mousemove.overmove",function(t){return function(e){return t._onmousemove(e)}}(this)),o(document.body).on("mouseup.overup",function(t){return function(e){return t._onmouseup(e)}}(this)),this.dragStart},_calcSelection:function(t){var e,n,i,r,o
for(e=[t[0]-this.dragStart[0],t[1]-this.dragStart[1]],n=i=0;1>=i;n=i+=1)e[n]=this.dragStartRel[n]+e[n]
for(o=[[this.dragStartRel[0],e[0]],[this.dragStartRel[1],e[1]]],n=r=0;1>=r;n=r+=1)o[n][1]<o[n][0]&&(o[n]=[o[n][1],o[n][0]]),o[n][0]=Math.max(o[n][0],0)
return o},_endSelection:function(t){var e,n,i,r,s,l,h,c,u,d
if(o(document.body).off(".overmove"),o(document.body).off(".overup"),0!==this.dragStart.length){for(h=this._calcSelection(t),n=r=0;1>=r;n=++r)h[0][n]=Math.floor(h[0][n]/this.g.zoomer.get("boxRectWidth"))
for(n=s=0;1>=s;n=++s)h[1][n]=Math.floor(h[1][n]/this.g.zoomer.get("boxRectHeight"))
for(h[0][1]=Math.min(this.model.getMaxLength()-1,h[0][1]),h[1][1]=Math.min(this.model.length-1,h[1][1]),d=[],i=l=c=h[1][0],u=h[1][1];u>=l;i=l+=1)e={seqId:this.model.at(i).get("id"),xStart:h[0][0],xEnd:h[0][1]},d.push(new a.possel(e))
return this.dragStart=[],this.prolongSelection?this.g.selcol.add(d):this.g.selcol.reset(d),this.g.zoomer.setLeftOffset(h[0][0]),this.g.zoomer.setTopOffset(h[1][0])}},_onmouseup:function(t){return this._endSelection(s.abs(t))},_onmouseout:function(t){return this._endSelection(s.abs(t))},_createCanvas:function(){var t,e
return e=this.g.zoomer.get("boxRectWidth"),t=this.g.zoomer.get("boxRectHeight"),this.el.height=this.model.length*t,this.el.width=this.model.getMaxLength()*e,this.ctx=this.el.getContext("2d"),this.el.style.overflow="scroll",this.el.style.cursor="crosshair"}})},{"../g/selection/Selection":6,"backbone-viewj":67,jbone:126,"mouse-pos":130,underscore:150}],42:[function(t,e,n){var i,r,o,s,a
r=t("backbone-childs"),i=t("underscore"),s=t("koala-js"),o=t("dom-helper"),a=t("../g/selection/Selection"),e.exports=r.extend({initialize:function(t){return this.g=t.g,this.listenTo(this.g.user,"change:searchText",function(t,e){return this.search(e),this.render()}),this.sel=[],this.selPos=0},events:{scroll:"_sendScrollEvent"},render:function(){var t
return this.renderSubviews(),this.el.className="biojs_msa_searchresult",t=this.g.user.get("searchText"),null!=t&&t.length>0&&(0===this.sel.length?this.el.textContent="no selection found":(this.resultBox=s.mk("div"),this.resultBox.className="biojs_msa_searchresult_ovbox",this.updateResult(),this.el.appendChild(this.resultBox),this.el.appendChild(this.buildBtns()))),this},updateResult:function(){var t,e
return e="search pattern: "+this.g.user.get("searchText"),e+=", selection: "+(this.selPos+1),t=this.sel[this.selPos],e+=" (",e+=t.get("xStart")+" - "+t.get("xEnd"),e+=", id: "+t.get("seqId"),e+=")",this.resultBox.textContent=e},buildBtns:function(){var t,e,n,i
return n=s.mk("button"),n.textContent="Prev",n.addEventListener("click",function(t){return function(){return t.moveSel(-1)}}(this)),e=s.mk("button"),e.textContent="Next",e.addEventListener("click",function(t){return function(){return t.moveSel(1)}}(this)),t=s.mk("button"),t.textContent="All",t.addEventListener("click",function(t){return function(){return t.g.selcol.reset(t.sel)}}(this)),i=s.mk("div"),i.appendChild(n),i.appendChild(e),i.appendChild(t),i.className="biojs_msa_searchresult_row",i},moveSel:function(t){var e
return e=this.selPos+t,0>e||e>=this.sel.length?-1:(this.focus(e),this.selPos=e,this.updateResult())},focus:function(t){var e,n
return n=this.sel[t],e=n.get("xStart"),this.g.zoomer.setLeftOffset(e),this.g.selcol.reset([n])},search:function(t){var e,n,i,r
return r=new RegExp(t,"gi"),n=[],e=i=100042,this.model.each(function(t){var i,o,s,l,h
for(h=t.get("seq"),l=[];s=r.exec(h);)o=s.index,i={xStart:o,xEnd:o+s[0].length-1,seqId:t.get("id")},n.push(new a.possel(i)),l.push(e=Math.min(o,e))
return l}),this.g.selcol.reset(n),e===i&&(e=0),this.g.zoomer.setLeftOffset(e),this.sel=n}})},{"../g/selection/Selection":6,"backbone-childs":60,"dom-helper":125,"koala-js":127,underscore:150}],43:[function(t,e,n){var i,r,o,s,a,l
l=t("backbone-childs"),i=t("./AlignmentBody"),r=t("./header/HeaderBlock"),o=t("./OverviewBox"),s=t("./Search"),a=t("underscore"),e.exports=l.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.stats,"reset",function(){return this.rerender()}),this.listenTo(this.model,"change:hidden",a.debounce(this.rerender,10)),this.listenTo(this.model,"sort",this.rerender),this.listenTo(this.model,"add",function(){return console.log("seq add")}),this.listenTo(this.g.vis,"change:sequences",this.rerender),this.listenTo(this.g.vis,"change:overviewbox",this.rerender),this.listenTo(this.g.visorder,"change",this.rerender)},draw:function(){var t,e,n,a
return this.removeViews(),this.g.vis.get("overviewbox")&&(n=new o({model:this.model,g:this.g}),n.ordering=this.g.visorder.get("overviewBox"),this.addView("overviewBox",n)),e=new r({model:this.model,g:this.g}),e.ordering=this.g.visorder.get("headerBox"),this.addView("headerBox",e),a=new s({model:this.model,g:this.g}),a.ordering=this.g.visorder.get("searchBox"),this.addView("searchbox",a),t=new i({model:this.model,g:this.g}),t.ordering=this.g.visorder.get("alignmentBody"),this.addView("body",t)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_stage",this},rerender:function(){return this.g.config.get("manualRendering")?void 0:(this.draw(),this.render())}})},{"./AlignmentBody":40,"./OverviewBox":41,"./Search":42,"./header/HeaderBlock":51,"backbone-childs":60,underscore:150}],44:[function(t,e,n){var i,r
r=t("biojs-events"),e.exports=i=function(){function t(t){this.g=t,this.cache={},this.cacheHeight=0,this.cacheWidth=0}return t.prototype.getFontTile=function(t,e,n){return e===this.cacheWidth&&n===this.cacheHeight||(this.cacheHeight=n,this.cacheWidth=e,this.cache={}),void 0===this.cache[t]&&this.createTile(t,e,n),this.cache[t]},t.prototype.createTile=function(t,e,n){var i
return i=this.cache[t]=document.createElement("canvas"),i.width=e,i.height=n,this.ctx=i.getContext("2d"),this.ctx.font=this.g.zoomer.get("residueFont")+"px mono",this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.fillText(t,e/2,n/2,e)},t}()},{"biojs-events":71}],45:[function(t,e,n){var i,r,o,s
r=t("underscore"),i=t("biojs-events"),o={setMaxScrollHeight:function(){return this.maxScrollHeight=this.g.zoomer.getMaxAlignmentHeight()-this.g.zoomer.get("alignmentHeight")},setMaxScrollWidth:function(){return this.maxScrollWidth=this.g.zoomer.getMaxAlignmentWidth()-this.g.zoomer.getAlignmentWidth()}},e.exports=s=function(t,e){return this.g=t,this.model=e,this.maxScrollWidth=0,this.maxScrollHeight=0,this.setMaxScrollHeight(),this.setMaxScrollWidth(),this.listenTo(this.g.zoomer,"change:rowHeight",this.setMaxScrollHeight),this.listenTo(this.g.zoomer,"change:columnWidth",this.setMaxScrollWidth),this.listenTo(this.g.zoomer,"change:alignmentWidth",this.setMaxScrollWidth),this.listenTo(this.g.zoomer,"change:alignmentHeight",this.setMaxScrollHeight),this.listenTo(this.model,"add change reset",function(){return this.setMaxScrollHeight(),this.setMaxScrollWidth()},this),this},r.extend(s.prototype,o),i.mixin(s.prototype)},{"biojs-events":71,underscore:150}],46:[function(t,e,n){var i,r
r=t("underscore"),e.exports=i=function(t,e){return this.g=t,this.ctx=e,this},r.extend(i.prototype,{_getSelection:function(t){var e,n,i,o,s,a,l,h,c,u,d,f,g
if(s=t.get("seq").length,f=[],g=this.g.selcol.getSelForRow(t.get("id")),u=r.find(g,function(t){return"row"===t.get("type")}),null!=u)for(a=e=0,l=s-1;l>=e;a=e+=1)f.push(a)
else if(g.length>0)for(n=0,i=g.length;i>n;n++)for(d=g[n],a=o=h=d.get("xStart"),c=d.get("xEnd");c>=o;a=o+=1)f.push(a)
return f},_appendSelection:function(t){var e,n,i,r,o,s,a,l,h,c,u,d,f
if(f=t.model.get("seq"),d=this._getSelection(t.model),h=this._getPrevNextSelection(t.model),a=h[0],s=h[1],n=this.g.zoomer.get("columnWidth"),e=this.g.zoomer.get("rowHeight"),0!==d.length){for(i=0,u=[],l=r=0,c=f.length-1;c>=r;l=r+=1)t.hidden.indexOf(l)>=0?u.push(i++):(o=l-i,d.indexOf(l)>=0&&(0===o||d.indexOf(l-1)<0)?u.push(this._renderSelection({n:l,k:o,selection:d,mPrevSel:a,mNextSel:s,xZero:t.xZero,yZero:t.yZero,model:t.model})):u.push(void 0))
return u}},_renderSelection:function(t){var e,n,i,r,o,s,a,l,h,c,u,d,f,g,p,m,v,b,x,w,y,_
for(y=t.xZero,_=t.yZero,d=t.n,l=t.k,m=t.selection,u=t.mPrevSel,c=t.mNextSel,v=0,s=a=f=d,g=t.model.get("seq").length-1;g>=a&&m.indexOf(s)>=0;s=a+=1)v++
for(r=this.g.zoomer.get("columnWidth"),i=this.g.zoomer.get("rowHeight"),b=r*v+1,o=this.g.columns.get("hidden"),this.ctx.beginPath(),n=this.ctx.lineWidth,this.ctx.lineWidth=3,e=this.ctx.strokeStyle,this.ctx.strokeStyle="#FF0000",y+=l*r,x=0,s=h=0,p=v-1;p>=0?p>=h:h>=p;s=p>=0?++h:--h)w=d+s,o.indexOf(w)>=0||(null!=u&&u.indexOf(w)>=0||(this.ctx.moveTo(y+x,_),this.ctx.lineTo(x+r+y,_)),null!=c&&c.indexOf(w)>=0||(this.ctx.moveTo(x+y,i+_),this.ctx.lineTo(x+r+y,i+_)),x+=r)
return this.ctx.moveTo(y,_),this.ctx.lineTo(y,i+_),this.ctx.moveTo(y+b,_),this.ctx.lineTo(y+b,i+_),this.ctx.stroke(),this.ctx.strokeStyle=e,this.ctx.lineWidth=n},_getPrevNextSelection:function(t){var e,n,i,r
return r=t.collection.prev(t),i=t.collection.next(t),null!=r&&(n=this._getSelection(r)),null!=i&&(e=this._getSelection(i)),[n,e]}})},{underscore:150}],47:[function(t,e,n){var i,r,o,s,a,l,h,c
l=t("backbone-childs"),c=t("mouse-pos"),a=t("underscore"),h=t("jbone"),o=t("./CanvasCharCache"),s=t("./CanvasSelection"),r=t("./CanvasSeqDrawer"),i=t("./CanvasCoordsCache"),e.exports=l.extend({tagName:"canvas",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:_alignmentScrollLeft change:_alignmentScrollTop",function(t,e,n){return null==(null!=n?n.origin:void 0)||"canvasseq"!==n.origin?this.render():void 0}),this.listenTo(this.g.columns,"change:hidden",this.render),this.listenTo(this.g.zoomer,"change:alignmentWidth change:alignmentHeight",this.render),this.listenTo(this.g.colorscheme,"change",this.render),this.listenTo(this.g.selcol,"reset add",this.render),this.listenTo(this.model,"reset add",this.render),this.el.style.display="inline-block",this.el.style.overflowX="hidden",this.el.style.overflowY="hidden",this.el.className="biojs_msa_seqblock",this.ctx=this.el.getContext("2d"),this.cache=new o(this.g),this.coordsCache=new i(this.g,this.model),this.listenTo(this.g.zoomer,"change:residueFont",function(){return this.cache=new o(this.g),this.render()}),this.sel=new s(this.g,this.ctx),this._setColor(),this.throttleTime=0,this.throttleCounts=0,null!=document.documentElement.style.webkitAppearance?this.throttledDraw=function(){var t,e
return t=+new Date,this.draw(),this.throttleTime+=+new Date-t,this.throttleCounts++,this.throttleCounts>15?(e=Math.ceil(this.throttleTime/this.throttleCounts),console.log("avgDrawTime/WebKit",e),this.throttledDraw=this.draw):void 0}:this.throttledDraw=a.throttle(this.throttledDraw,30),this.manageEvents()},throttledDraw:function(){var t,e
return t=+new Date,this.draw(),this.throttleTime+=+new Date-t,this.throttleCounts++,this.throttleCounts>15?(e=Math.ceil(this.throttleTime/this.throttleCounts),console.log("avgDrawTime",e),e*=1.2,e=Math.max(20,e),this.throttledDraw=a.throttle(this.draw,e)):void 0},manageEvents:function(){var t
return t={},t.mousedown="_onmousedown",t.touchstart="_ontouchstart",this.g.config.get("registerMouseClicks")&&(t.dblclick="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),t.mousewheel="_onmousewheel",t.DOMMouseScroll="_onmousewheel",this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents),this.dragStart=[]},_setColor:function(){return this.color=this.g.colorscheme.getSelectedScheme()},draw:function(){return this.el.width=this.el.width,null!=this.seqDrawer&&this.model.length>0?(this.seqDrawer.drawLetters(),this.seqDrawer.drawRows(this.sel._appendSelection,this.sel),this.seqDrawer.drawRows(this.drawFeatures,this)):void 0},drawFeatures:function(t){var e,n,i
return i=this.g.zoomer.get("columnWidth"),n=this.g.zoomer.get("rowHeight"),t.model.attributes.height>1?(e=this.ctx,t.model.attributes.features.each(function(r){var o,s
return e.fillStyle=r.attributes.fillColor||"red",o=r.attributes.xEnd-r.attributes.xStart+1,s=(r.attributes.row+1)*n,e.fillRect(r.attributes.xStart*i+t.xZero,s+t.yZero,i*o,n)}),e.fillStyle="black",e.font=this.g.zoomer.get("residueFont")+"px mono",e.textBaseline="middle",e.textAlign="center",t.model.attributes.features.each(function(r){var o,s
return o=r.attributes.xEnd-r.attributes.xStart+1,s=(r.attributes.row+1)*n,e.fillText(r.attributes.text,t.xZero+r.attributes.xStart*i+o/2*i,t.yZero+.5*n+s)})):void 0},render:function(){return this.el.setAttribute("height",this.g.zoomer.get("alignmentHeight")+"px"),this.el.setAttribute("width",this.g.zoomer.getAlignmentWidth()+"px"),this.g.zoomer._checkScrolling(this._checkScrolling([this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")]),{header:"canvasseq"}),this._setColor(),this.seqDrawer=new r(this.g,this.ctx,this.model,{width:this.el.width,height:this.el.height,color:this.color,cache:this.cache}),this.throttledDraw(),this},_onmousemove:function(t,e){var n,i,r,o,s,a,l,h,u
if(0!==this.dragStart.length){for(n=c.abs(t),l=[n[0]-this.dragStart[0],n[1]-this.dragStart[1]],h=this.g.zoomer.get("canvasEventScale"),e&&(h=3),i=r=0;1>=r;i=r+=1)l[i]=l[i]*h
for(a=[this.dragStartScroll[0]-l[0],this.dragStartScroll[1]-l[1]],i=o=0;1>=o;i=o+=1)a[i]=Math.round(a[i])
for(u=this._checkScrolling(a),this.g.zoomer._checkScrolling(u,{origin:"canvasseq"}),i=s=0;1>=s;i=s+=1)u[i]!==a[i]&&(0===u[i]?(this.dragStart[i]=n[i],this.dragStartScroll[i]=0):this.dragStart[i]=n[i]-u[i])
return this.throttledDraw(),null!=t.preventDefault?(t.preventDefault(),t.stopPropagation()):void 0}},_ontouchmove:function(t){return this._onmousemove(t.changedTouches[0],!0),t.preventDefault(),t.stopPropagation()},_onmousedown:function(t){return this.dragStart=c.abs(t),this.dragStartScroll=[this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")],h(document.body).on("mousemove.overmove",function(t){return function(e){return t._onmousemove(e)}}(this)),h(document.body).on("mouseup.overup",function(t){return function(){return t._cleanup()}}(this)),t.preventDefault()},_ontouchstart:function(t){return this.dragStart=c.abs(t.changedTouches[0]),this.dragStartScroll=[this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")],h(document.body).on("touchmove.overtmove",function(t){return function(e){return t._ontouchmove(e)}}(this)),h(document.body).on("touchend.overtend touchleave.overtleave touchcancel.overtcanel",function(t){return function(e){return t._touchCleanup(e)}}(this))},_onmousewinout:function(t){return t.toElement===document.body.parentNode?this._cleanup():void 0},_cleanup:function(){return this.dragStart=[],h(document.body).off(".overmove"),h(document.body).off(".overup"),h(document.body).off(".overout")},_touchCleanup:function(t){return t.changedTouches.length>0&&this._onmousemove(t.changedTouches[0],!0),this.dragStart=[],h(document.body).off(".overtmove"),h(document.body).off(".overtend"),h(document.body).off(".overtleave"),h(document.body).off(".overtcancel")},_onmousewheel:function(t){var e
return e=c.wheelDelta(t),this.g.zoomer.set("_alignmentScrollLeft",this.g.zoomer.get("_alignmentScrollLeft")+e[0]),this.g.zoomer.set("_alignmentScrollTop",this.g.zoomer.get("_alignmentScrollTop")+e[1]),t.preventDefault()},_onclick:function(t){var e
return e=this._getClickPos(t),null!=e&&(null!=e.feature?this.g.trigger("feature:click",e):this.g.trigger("residue:click",e)),this.throttledDraw()},_onmousein:function(t){var e
return e=this._getClickPos(t),null!=e&&(null!=e.feature?this.g.trigger("feature:mousein",e):this.g.trigger("residue:mousein",e)),this.throttledDraw()},_onmouseout:function(t){var e
return e=this._getClickPos(t),null!=e&&(null!=e.feature?this.g.trigger("feature:mouseout",e):this.g.trigger("residue:mouseout",e)),this.throttledDraw()},_getClickPos:function(t){var e,n,i,r,o,s,a,l
return e=c.rel(t),e[0]+=this.g.zoomer.get("_alignmentScrollLeft"),a=Math.floor(e[0]/this.g.zoomer.get("columnWidth")),r=this.seqDrawer._getSeqForYClick(e[1]),l=r[0],o=r[1],a+=this.g.columns.calcHiddenColumns(a),l+=this.model.calcHiddenSeqs(l),a=Math.max(0,a),l=Math.max(0,l),s=this.model.at(l).get("id"),o>0?(i=this.model.at(l).get("features").getFeatureOnRow(o-1,a),0!==i.length?(n=i[0],console.log(i[0].attributes),{seqId:s,feature:n,rowPos:a,evt:t}):void 0):{seqId:s,rowPos:a,evt:t}},_checkScrolling:function(t){var e,n,i
for(i=[this.coordsCache.maxScrollWidth,this.coordsCache.maxScrollHeight],e=n=0;1>=n;e=n+=1)t[e]>i[e]&&(t[e]=i[e]),t[e]<0&&(t[e]=0)
return t}})},{"./CanvasCharCache":44,"./CanvasCoordsCache":45,"./CanvasSelection":46,"./CanvasSeqDrawer":48,"backbone-childs":60,jbone:126,"mouse-pos":130,underscore:150}],48:[function(t,e,n){var i,r,o
i=t("underscore"),o={drawLetters:function(){var t
return t=this.rectHeight,this.ctx.globalAlpha=this.g.colorscheme.get("opacity"),this.drawSeqs(function(t){return this.drawSeq(t,this._drawRect)}),this.ctx.globalAlpha=1,this.drawSeqs(function(t){return this.drawSeq(t,this._drawLetter)})},drawSeqs:function(t,e){var n,i,r,o,s,a,l,h,c,u,d
for(n=this.g.columns.get("hidden"),e=e||this,o=this.getStartSeq(),u=o[0],d=o[1],l=[],i=r=s=u,a=this.model.length-1;a>=r;i=r+=1)if(h=this.model.at(i),!h.get("hidden")){if(t.call(e,{model:h,yPos:d,y:i,hidden:n}),c=(h.attributes.height||1)*this.rectHeight,d+=c,d>this.height)break
l.push(void 0)}return l},drawRows:function(t,e){return this.drawSeqs(function(n){return this.drawRow(n,t,e)})},drawRow:function(t,e,n){var i,r,o,s,a
return i=this.g.zoomer.get("columnWidth"),r=Math.max(0,Math.abs(Math.ceil(-this.g.zoomer.get("_alignmentScrollLeft")/i))),o=-Math.abs(-this.g.zoomer.get("_alignmentScrollLeft")%i),s=o-r*i,a=t.yPos,e.call(n,{model:t.model,xZero:s,yZero:a,hidden:t.hidden})},getStartSeq:function(){var t,e,n,i
for(n=Math.max(0,Math.floor(this.g.zoomer.get("_alignmentScrollTop")/this.rectHeight))+1,t=0,e=0;n>t&&e<this.model.length;)t+=this.model.at(e).attributes.height||1,e++
return i=Math.max(0,this.g.zoomer.get("_alignmentScrollTop")-t*this.rectHeight+(this.model.at(e-1).attributes.height||1)*this.rectHeight),[e-1,-i]},_getSeqForYClick:function(t){var e,n,i,r,o,s,a,l
for(r=this.getStartSeq(),s=r[0],a=r[1],l=a%this.rectHeight,e=Math.max(0,Math.floor((t-l)/this.rectHeight))+1,n=0,i=s;e>n&&i<this.model.length;)n+=this.model.at(i).attributes.height||1,i++
return o=Math.max(0,Math.floor(t/this.rectHeight)-n+(this.model.at(i-1).get("height")||1)),[i-1,o]},drawSeq:function(t,e){var n,i,r,o,s,a,l,h,c,u,d,f,g,p
for(d=t.model.get("seq"),p=t.yPos,a=this.rectWidth,s=this.rectHeight,f=Math.max(0,Math.abs(Math.ceil(-this.g.zoomer.get("_alignmentScrollLeft")/a))),g=-Math.abs(-this.g.zoomer.get("_alignmentScrollLeft")%a),c={rectWidth:a,rectHeight:s,yPos:p,y:t.y},i=this.width,u=[],r=o=l=f,h=d.length-1;h>=o;r=o+=1)if(n=d[r],n=n.toUpperCase(),c.x=r,c.c=n,c.xPos=g,t.hidden.indexOf(r)<0){if(e(this,c),g+=a,g>i)break
u.push(void 0)}return u},_drawRect:function(t,e){var n
return n=t.color.getColor(e.c,{pos:e.x,y:e.y}),null!=n?(t.ctx.fillStyle=n,t.ctx.fillRect(e.xPos,e.yPos,e.rectWidth,e.rectHeight)):void 0},_drawLetter:function(t,e){return t.ctx.drawImage(t.cache.getFontTile(e.c,e.rectWidth,e.rectHeight),e.xPos,e.yPos,e.rectWidth,e.rectHeight)}},e.exports=r=function(t,e,n,i){return this.g=t,this.ctx=e,this.model=n,this.width=i.width,this.height=i.height,this.color=i.color,this.cache=i.cache,this.rectHeight=this.g.zoomer.get("rowHeight"),this.rectWidth=this.g.zoomer.get("columnWidth"),this},i.extend(r.prototype,o)},{underscore:150}],49:[function(t,e,n){var i,r,o,s
s=t("backbone-viewj"),r=t("dom-helper"),o=t("../../utils/svg"),i=s.extend({className:"biojs_msa_conserv",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.listenTo(this.g.columns,"change:scaling",this.render),this.listenTo(this.g.stats,"reset",this.render),this.manageEvents()},render:function(){var t,e,n,i,s,a,l,h,c,u,d,f,g,p,m,v
for(n=this.g.stats.scale(this.g.stats.conservation()),r.removeAllChilds(this.el),u=this.model.getMaxLength(),e=this.g.zoomer.get("columnWidth"),h=20,m=e*(u-this.g.columns.get("hidden").length),g=o.base({height:h,width:m}),g.style.display="inline-block",g.style.cursor="pointer",p=this.g.zoomer.get("stepSize"),s=this.g.columns.get("hidden"),v=0,c=0;u>c;)if(s.indexOf(c)>=0)c+=p
else{for(m=e*p,t=0,a=l=0,f=p-1;f>=0?f>=l:l>=f;a=f>=0?++l:--l)t+=n[c]
i=h*(t/p),d=o.rect({x:v,y:h-i,width:m-e/4,height:i,style:"stroke:red;stroke-width:1;"}),d.rowPos=c,g.appendChild(d),v+=m,c+=p}return this.el.appendChild(g),this},_onclick:function(t){var e,n,i,r,o,s
for(o=t.target.rowPos,s=this.g.zoomer.get("stepSize"),r=[],e=n=0,i=s-1;i>=n;e=n+=1)r.push(this.g.trigger("bar:click",{rowPos:o+e,evt:t}))
return r},manageEvents:function(){var t
return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onmousein:function(t){var e
return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("bar:mousein",{rowPos:e,evt:t})},_onmouseout:function(t){var e
return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("bar:mouseout",{rowPos:e,evt:t})}}),e.exports=i},{"../../utils/svg":38,"backbone-viewj":67,"dom-helper":125}],50:[function(t,e,n){var i,r,o,s
s=t("backbone-viewj"),r=t("dom-helper"),o=t("../../utils/svg"),i=s.extend({className:"biojs_msa_gapview",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.listenTo(this.g.columns,"change:scaling",this.render),this.listenTo(this.model,"reset",this.render),this.manageEvents()},render:function(){var t,e,n,i,s,a,l,h,c,u,d,f,g,p,m,v
for(n=this.g.stats.gaps(),r.removeAllChilds(this.el),u=this.model.getMaxLength(),e=this.g.zoomer.get("columnWidth"),h=20,m=e*(u-this.g.columns.get("hidden").length),g=o.base({height:h,width:m}),g.style.display="inline-block",g.style.cursor="pointer",p=this.g.zoomer.get("stepSize"),s=this.g.columns.get("hidden"),v=0,c=0;u>c;)if(s.indexOf(c)>=0)c+=p
else{for(m=e*p,t=0,a=l=0,f=p-1;f>=0?f>=l:l>=f;a=f>=0?++l:--l)t+=n[c]
i=h*(t/p),d=o.rect({x:v,y:h-i,width:m-e/4,height:i,style:"stroke:red;stroke-width:1;"}),d.rowPos=c,g.appendChild(d),v+=m,c+=p}return this.el.appendChild(g),this},_onclick:function(t){var e,n,i,r,o,s
for(o=t.target.rowPos,s=this.g.zoomer.get("stepSize"),r=[],e=n=0,i=s-1;i>=n;e=n+=1)r.push(this.g.trigger("gap:click",{rowPos:o+e,evt:t}))
return r},manageEvents:function(){var t
return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onmousein:function(t){var e
return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("gap:mousein",{rowPos:e,evt:t})},_onmouseout:function(t){var e
return e=this.g.zoomer.get("stepSize"*t.rowPos),this.g.trigger("gap:mouseout",{rowPos:e,evt:t})}}),e.exports=i},{"../../utils/svg":38,"backbone-viewj":67,"dom-helper":125}],51:[function(t,e,n){var i,r,o
o=t("backbone-childs"),i=t("./LabelHeader"),r=t("./RightHeaderBlock"),e.exports=o.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.vis,"change:labels change:metacell change:leftHeader",function(t){return function(){return t.draw(),t.render()}}(this))},draw:function(){var t,e
return this.removeViews(),this.g.vis.get("leftHeader")&&(this.g.vis.get("labels")||this.g.vis.get("metacell"))&&(t=new i({model:this.model,g:this.g}),t.ordering=-50,this.addView("lHeader",t)),e=new r({model:this.model,g:this.g}),e.ordering=0,this.addView("rHeader",e)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_header"}})},{"./LabelHeader":52,"./RightHeaderBlock":54,"backbone-childs":60}],52:[function(t,e,n){var i,r,o,s
o=t("koala-js"),s=t("backbone-viewj"),r=t("dom-helper"),e.exports=i=s.extend({className:"biojs_msa_headers",initialize:function(t){return this.g=t.g,this.listenTo(this.g.vis,"change:metacell change:labels",this.render),this.listenTo(this.g.zoomer,"change:labelWidth change:metaWidth",this.render)},render:function(){var t
return r.removeAllChilds(this.el),t=0,t+=this.g.zoomer.getLeftBlockWidth(),this.el.style.width=t+"px",this.g.vis.get("labels")&&this.el.appendChild(this.labelDOM()),this.g.vis.get("metacell")&&this.el.appendChild(this.metaDOM()),this.el.style.display="inline-block",this.el.style.fontSize=this.g.zoomer.get("markerFontsize"),this},labelDOM:function(){var t,e
return t=o.mk("div"),t.style.width=this.g.zoomer.getLabelWidth(),t.style.display="inline-block",this.g.vis.get("labelCheckbox")&&t.appendChild(this.addEl(".",10)),this.g.vis.get("labelId")&&t.appendChild(this.addEl("ID",this.g.zoomer.get("labelIdLength"))),this.g.vis.get("labelPartition")&&t.appendChild(this.addEl("part",15)),this.g.vis.get("labelName")&&(e=this.addEl("Label"),t.appendChild(e)),t},addEl:function(t,e){var n
return n=document.createElement("span"),n.textContent=t,null!=e&&(n.style.width=e+"px"),n.style.display="inline-block",n},metaDOM:function(){var t
return t=o.mk("div"),t.style.width=this.g.zoomer.getMetaWidth(),t.style.display="inline-block",this.g.vis.get("metaGaps")&&t.appendChild(this.addEl("Gaps",this.g.zoomer.get("metaGapWidth"))),this.g.vis.get("metaIdentity")&&t.appendChild(this.addEl("Ident",this.g.zoomer.get("metaIdentWidth"))),this.g.vis.get("metaLinks")&&t.appendChild(this.addEl("Links")),t}})},{"backbone-viewj":67,"dom-helper":125,"koala-js":127}],53:[function(t,e,n){var i,r,o,s,a
a=t("backbone-viewj"),r=t("dom-helper"),s=t("../../utils/svg"),o=t("jbone"),i=a.extend({className:"biojs_msa_marker",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth change:markerStepSize change:markerFontsize",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.manageEvents()},render:function(){var t,e,n,i,o,s,a
for(r.removeAllChilds(this.el),this.el.style.fontSize=this.g.zoomer.get("markerFontsize"),e=document.createElement("span"),i=0,t=this.g.zoomer.get("columnWidth"),o=this.model.getMaxLength(),a=this.g.zoomer.get("stepSize"),n=this.g.columns.get("hidden");o>i;)n.indexOf(i)>=0?(this.markerHidden(s,i,a),i+=a):(s=document.createElement("span"),s.style.width=t*a+"px",s.style.display="inline-block",(i+1)%this.g.zoomer.get("markerStepSize")===0?s.textContent=i+1:s.textContent=".",s.rowPos=i,i+=a,e.appendChild(s))
return this.el.appendChild(e),this},markerHidden:function(t,e,n){var i,r,a,l,h,c,u,d,f,g,p,m,v,b,x
for(i=this.g.columns.get("hidden").slice(0),u=Math.max(0,e-n),f=!0,l=r=g=u,p=e;p>=r;l=r+=1)f&=i.indexOf(l)>=0
if(!f){for(d=this.model.getMaxLength(),c=0,a=-1,e=h=m=e,v=d;v>=h&&(a>=0||(a=i.indexOf(e)),i.indexOf(e)>=0);e=h+=1)c++
return b=s.base({height:10,width:10}),b.style.position="relative",x=s.polygon({points:"0,0 5,5 10,0",style:"fill:lime;stroke:purple;stroke-width:1"}),o(x).on("click",function(t){return function(e){return i.splice(a,c),t.g.columns.set("hidden",i)}}(this)),b.appendChild(x),t.appendChild(b),b}},manageEvents:function(){var t
return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onclick:function(t){var e,n
return e=t.target.rowPos,n=this.g.zoomer.get("stepSize"),this.g.trigger("column:click",{rowPos:e,stepSize:n,evt:t})},_onmousein:function(t){var e,n
return e=this.g.zoomer.get("stepSize"*t.rowPos),n=this.g.zoomer.get("stepSize"),this.g.trigger("column:mousein",{rowPos:e,stepSize:n,evt:t})},_onmouseout:function(t){var e,n
return e=this.g.zoomer.get("stepSize"*t.rowPos),n=this.g.zoomer.get("stepSize"),this.g.trigger("column:mouseout",{rowPos:e,stepSize:n,evt:t})}}),e.exports=i},{"../../utils/svg":38,"backbone-viewj":67,"dom-helper":125,jbone:126}],54:[function(t,e,n){var i,r,o,s,a,l
o=t("./MarkerView"),i=t("./ConservationView"),l=t("backbone-childs"),a=t("underscore"),s=t("./SeqLogoWrapper"),r=t("./GapView"),e.exports=l.extend({initialize:function(t){return this.g=t.g,this.blockEvents=!1,this.listenTo(this.g.vis,"change:header",function(){return this.draw(),this.render()}),this.listenTo(this.g.vis,"change",this._setSpacer),this.listenTo(this.g.zoomer,"change:alignmentWidth",this._setWidth),this.listenTo(this.g.zoomer,"change:_alignmentScrollLeft",this._adjustScrollingLeft),this.listenTo(this.g.columns,"change:hidden",function(){return this.draw(),this.render()}),this.draw(),this.g.vis.once("change:loaded",this._adjustScrollingLeft,this)},events:{scroll:"_sendScrollEvent"},draw:function(){var t,e,n,a
return this.removeViews(),this.g.vis.get("conserv")&&(t=new i({model:this.model,g:this.g}),t.ordering=-20,this.addView("conserv",t)),this.g.vis.get("markers")&&(n=new o({model:this.model,g:this.g}),n.ordering=-10,this.addView("marker",n)),this.g.vis.get("seqlogo")&&(a=new s({model:this.model,g:this.g}),a.ordering=-30,this.addView("seqlogo",a)),this.g.vis.get("gapHeader")?(e=new r({model:this.model,g:this.g}),e.ordering=-25,this.addView("gapview",e)):void 0},render:function(){return this.renderSubviews(),this._setSpacer(),this.el.className="biojs_msa_rheader",this.el.style.overflowX="auto",this.el.style.display="inline-block",this._setWidth(),this._adjustScrollingLeft(),this},_sendScrollEvent:function(){return this.blockEvents||this.g.zoomer.set("_alignmentScrollLeft",this.el.scrollLeft,{origin:"header"}),this.blockEvents=!1},_adjustScrollingLeft:function(t,e,n){var i
return null==(null!=n?n.origin:void 0)||"header"!==n.origin?(i=this.g.zoomer.get("_alignmentScrollLeft"),this.blockEvents=!0,this.el.scrollLeft=i):void 0},_setSpacer:function(){return this.el.style.marginLeft=this._getLabelWidth()+"px"},_getLabelWidth:function(){var t
return t=0,this.g.vis.get("leftHeader")||(t+=this.g.zoomer.getLeftBlockWidth()),t},_setWidth:function(){return this.el.style.width=this.g.zoomer.getAlignmentWidth()+"px"}})},{"./ConservationView":49,"./GapView":50,"./MarkerView":53,"./SeqLogoWrapper":55,"backbone-childs":60,underscore:150}],55:[function(t,e,n){var i,r,o
i=t("biojs-vis-seqlogo/light"),o=t("backbone-viewj"),r=t("dom-helper"),e.exports=o.extend({initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:alignmentWidth",this.render),this.listenTo(this.g.colorscheme,"change",function(){var t
return t=this.g.colorscheme.getSelectedScheme(),this.seqlogo.changeColors(t),this.render()}),this.listenTo(this.g.zoomer,"change:columnWidth",function(){return this.seqlogo.column_width=this.g.zoomer.get("columnWidth"),this.render()}),this.listenTo(this.g.stats,"reset",function(){return this.draw(),this.render()}),this.draw()},draw:function(){var t,e,n
return r.removeAllChilds(this.el),console.log("redraw seqlogo"),t=this.g.stats.conservResidue({scaled:!0}),t=_.map(t,function(t){return _.pick(t,function(t,e){return"-"!==e})}),n={alphabet:"aa",heightArr:t},e=this.g.colorscheme.getSelectedScheme(),this.seqlogo=new i({model:this.model,g:this.g,data:n,yaxis:!1,scroller:!1,xaxis:!1,height:100,column_width:this.g.zoomer.get("columnWidth"),positionMarker:!1,zoom:1,el:this.el,colors:e})},render:function(){return this.seqlogo.render()}})},{"backbone-viewj":67,"biojs-vis-seqlogo/light":108,"dom-helper":125}],56:[function(t,e,n){var i,r
i=t("./LabelRowView"),r=t("backbone-childs"),e.exports=r.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.zoomer,"change:_alignmentScrollTop",this._adjustScrollingTop),this.g.vis.once("change:loaded",this._adjustScrollingTop,this),this.listenTo(this.g.zoomer,"change:alignmentHeight",this._setHeight),this.listenTo(this.model,"change:reference",this.draw),this.listenTo(this.model,"reset add remove",function(t){return function(){return t.draw(),t.render()}}(this))},draw:function(){var t,e,n,r,o
for(this.removeViews(),r=[],t=e=0,n=this.model.length-1;n>=e;t=e+=1)this.model.at(t).get("hidden")||(o=new i({model:this.model.at(t),g:this.g}),o.ordering=t,r.push(this.addView("row_"+t,o)))
return r},events:{scroll:"_sendScrollEvent"},_sendScrollEvent:function(){return this.g.zoomer.set("_alignmentScrollTop",this.el.scrollTop,{origin:"label"})},_adjustScrollingTop:function(){return this.el.scrollTop=this.g.zoomer.get("_alignmentScrollTop")},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_labelblock",this.el.style.display="inline-block",this.el.style.verticalAlign="top",this.el.style.overflowY="auto",this.el.style.overflowX="hidden",this.el.style.fontSize=this.g.zoomer.get("labelFontsize")+"px",this.el.style.lineHeight=""+this.g.zoomer.get("labelLineHeight"),this._setHeight(),this},_setHeight:function(){return this.el.style.height=this.g.zoomer.get("alignmentHeight")+"px"}})},{"./LabelRowView":57,"backbone-childs":60}],57:[function(t,e,n){var i,r,o
o=t("backbone-childs"),i=t("./LabelView"),r=t("./MetaView"),e.exports=o.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.vis,"change:labels",this.drawR),this.listenTo(this.g.vis,"change:metacell",this.drawR),this.listenTo(this.g.zoomer,"change:rowHeight",function(){return this.el.style.height=this.g.zoomer.get("rowHeight")+"px"}),this.listenTo(this.g.selcol,"change reset add",this.setSelection)},draw:function(){var t
return this.removeViews(),this.g.vis.get("labels")&&this.addView("labels",new i({model:this.model,g:this.g})),this.g.vis.get("metacell")?(t=new r({model:this.model,g:this.g}),this.addView("metacell",t)):void 0},drawR:function(){return this.draw(),this.render()},render:function(){return this.renderSubviews(),this.el.setAttribute("class","biojs_msa_labelrow"),this.el.style.height=this.g.zoomer.get("rowHeight")*(this.model.attributes.height||1)+"px",this.setSelection(),this},setSelection:function(){var t
return t=this.g.selcol.getSelForRow(this.model.id),t.length>0?this.el.style.fontWeight="bold":this.el.style.fontWeight="normal"}})},{"./LabelView":58,"./MetaView":59,"backbone-childs":60}],58:[function(t,e,n){var i,r,o
o=t("backbone-viewj"),r=t("dom-helper"),i=o.extend({initialize:function(t){return this.seq=t.seq,this.g=t.g,this.manageEvents()},manageEvents:function(){var t
return t={},this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents),this.listenTo(this.g.vis,"change:labelName change:labelId change:labelPartition change:labelCheckbox",this.render),this.listenTo(this.g.zoomer,"change:labelIdLength change:labelNameLength change:labelPartLength change:labelCheckLength",this.render),this.listenTo(this.g.zoomer,"change:labelFontSize change:labelLineHeight change:labelWidth change:rowHeight",this.render)},render:function(){var t,e,n,i,o
return r.removeAllChilds(this.el),this.el.style.width=this.g.zoomer.getLabelWidth()+"px",this.el.setAttribute("class","biojs_msa_labels"),this.g.vis.get("labelCheckbox")&&(t=document.createElement("input"),t.setAttribute("type","checkbox"),t.value=this.model.get("id"),t.name="seq",t.style.width=this.g.zoomer.get("labelCheckLength")+"px",this.el.appendChild(t)),this.g.vis.get("labelId")&&(e=document.createElement("span"),o=this.model.get("id"),isNaN(o)||o++,e.textContent=o,e.style.width=this.g.zoomer.get("labelIdLength")+"px",e.style.display="inline-block",this.el.appendChild(e)),this.g.vis.get("labelPartition")&&(i=document.createElement("span"),i.style.width=this.g.zoomer.get("labelPartLength")+"px",i.textContent=this.model.get("partition"),i.style.display="inline-block",this.el.appendChild(e),this.el.appendChild(i)),this.g.vis.get("labelName")&&(n=document.createElement("span"),n.textContent=this.model.get("name"),this.model.get("ref")&&this.g.config.get("hasRef")&&(n.style.fontWeight="bold"),n.style.width=this.g.zoomer.get("labelNameLength")+"px",this.el.appendChild(n)),this.el.style.overflow=scroll,this.el.style.fontSize=this.g.zoomer.get("labelFontsize")+"px",this},_onclick:function(t){var e
return e=this.model.get("id"),this.g.trigger("row:click",{seqId:e,evt:t})},_onmousein:function(t){var e
return e=this.model.get("id"),this.g.trigger("row:mouseout",{seqId:e,evt:t})},_onmouseout:function(t){var e
return e=this.model.get("id"),this.g.trigger("row:mouseout",{seqId:e,evt:t})}}),e.exports=i},{"backbone-viewj":67,"dom-helper":125}],59:[function(t,e,n){var i,r,o,s,a,l
l=t("backbone-viewj"),i=t("../../menu/menubuilder"),o=t("underscore"),s=t("dom-helper"),a=t("msa-seqtools"),e.exports=r=l.extend({className:"biojs_msa_metaview",initialize:function(t){return this.g=t.g,this.listenTo(this.g.vis,"change:metacell",this.render),this.listenTo(this.g.zoomer,"change:metaWidth",this.render)},events:{click:"_onclick",mousein:"_onmousein",mouseout:"_onmouseout"},render:function(){var t,e,n,r,l,h,c,u,d
return s.removeAllChilds(this.el),this.el.style.display="inline-block",d=this.g.zoomer.getMetaWidth(),this.el.style.width=d-10,this.el.style.paddingRight=5,this.el.style.paddingLeft=5,this.el.style.fontSize=this.g.zoomer.get("labelFontsize")-2+"px",this.g.vis.get("metaGaps")&&(u=this.model.get("seq"),e=o.reduce(u,function(t,e){return"-"===e&&t++,t},0),e=(100*e/u.length).toFixed(0)+"%",t=document.createElement("span"),t.textContent=e,t.style.display="inline-block",t.style.width=35,this.el.appendChild(t)),this.g.vis.get("metaIdentity")&&(n=this.g.stats.identity()[this.model.id],r=document.createElement("span"),this.model.get("ref")&&this.g.config.get("hasRef")?r.textContent="ref.":null!=n&&(r.textContent=n.toFixed(2)),r.style.display="inline-block",r.style.width=40,this.el.appendChild(r)),this.g.vis.get("metaLinks")&&this.model.attributes.ids&&(h=a.buildLinks(this.model.attributes.ids),o.keys(h).length>0)?(c=new i({name:"鈫?"}),console.log(o.keys(h)),o.each(h,function(t,e){return c.addNode(e,function(e){return window.open(t)})}),l=c.buildDOM(),l.style.cursor="pointer",this.el.appendChild(l)):void 0},_onclick:function(t){return this.g.trigger("meta:click",{seqId:this.model.get("id",{evt:t})})},_onmousein:function(t){return this.g.trigger("meta:mousein",{seqId:this.model.get("id",{evt:t})})},_onmouseout:function(t){return this.g.trigger("meta:mouseout",{seqId:this.model.get("id",{evt:t})})}})},{"../../menu/menubuilder":14,"backbone-viewj":67,"dom-helper":125,"msa-seqtools":148,underscore:150}],60:[function(t,e,n){function i(t){var e=t.parentNode,n=t.nextSibling
return e.removeChild(t),function(){n?e.insertBefore(t,n):e.appendChild(t)}}var r,o=t("underscore"),s=t("backbone-viewj"),a=function(t){for(var e;e=t.lastChild;)t.removeChild(e)}
e.exports=r=s.extend({renderSubviews:function(){var t=this.el,e=void 0!=t.parentNode
if(e)var n=i(t)
a(t)
for(var r,s,l=document.createDocumentFragment(),h=this._views(),c=o.sortBy(h,function(t){return t.ordering}),u=0;u<c.length;u++)r=c[u],r.render(),s=r.el,null!=s&&l.appendChild(s)
return t.appendChild(l),e&&n(),t},addView:function(t,e){var n=this._views()
if(null==e)throw"Invalid plugin. "
return null==e.ordering&&(e.ordering=t),n[t]=e},removeViews:function(){var t,e,n=this._views()
for(e in n)t=n[e],t.undelegateEvents(),t.unbind(),null!=t.removeViews&&t.removeViews(),t.remove()
return this.views={}},removeView:function(t){var e=this._views()
return e[t].remove(),delete e[t]},getView:function(t){var e=this._views()
return e[t]},remove:function(){return this.removeViews(),s.prototype.remove.apply(this)},_views:function(){return null==this.views&&(this.views={}),this.views}})},{"backbone-viewj":67,underscore:150}],61:[function(t,e,n){var i=t("backbone-events-standalone"),r=t("backbone-extend-standalone"),o=t("underscore"),s=t("./model"),a=[],l=a.slice,h=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,o.extend({silent:!0},e))},c={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1}
o.extend(h.prototype,i,{model:s,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.extend({merge:!1},e,u))},remove:function(t,e){var n=!o.isArray(t)
t=n?[t]:o.clone(t),e||(e={})
for(var i=0,r=t.length;r>i;i++){var s=t[i]=this.get(t[i])
if(s){var a=this.modelId(s.attributes)
null!=a&&delete this._byId[a],delete this._byId[s.cid]
var l=this.indexOf(s)
this.models.splice(l,1),this.length--,e.silent||(e.index=l,s.trigger("remove",s,this,e)),this._removeReference(s,e)}}return n?t[0]:t},set:function(t,e){e=o.defaults({},e,c),e.parse&&(t=this.parse(t,e))
var n=!o.isArray(t)
t=n?t?[t]:[]:t.slice()
for(var i,r,s,a,l,h=e.at,u=this.comparator&&null==h&&e.sort!==!1,d=o.isString(this.comparator)?this.comparator:null,f=[],g=[],p={},m=e.add,v=e.merge,b=e.remove,x=!u&&m&&b?[]:!1,w=0,y=t.length;y>w;w++){if(s=t[w],a=this.get(s))b&&(p[a.cid]=!0),v&&s!==a&&(s=this._isModel(s)?s.attributes:s,e.parse&&(s=a.parse(s,e)),a.set(s,e),u&&!l&&a.hasChanged(d)&&(l=!0)),t[w]=a
else if(m){if(r=t[w]=this._prepareModel(s,e),!r)continue
f.push(r),this._addReference(r,e)}r=a||r,r&&(i=this.modelId(r.attributes),!x||!r.isNew()&&p[i]||x.push(r),p[i]=!0)}if(b){for(var w=0,y=this.length;y>w;w++)p[(r=this.models[w]).cid]||g.push(r)
g.length&&this.remove(g,e)}if(f.length||x&&x.length)if(u&&(l=!0),this.length+=f.length,null!=h)for(var w=0,y=f.length;y>w;w++)this.models.splice(h+w,0,f[w])
else{x&&(this.models.length=0)
for(var _=x||f,w=0,y=_.length;y>w;w++)this.models.push(_[w])}if(l&&this.sort({silent:!0}),!e.silent){for(var S=null!=h?o.clone(e):e,w=0,y=f.length;y>w;w++)null!=h&&(S.index=h+w),(r=f[w]).trigger("add",r,this,S);(l||x&&x.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={})
for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n],e)
return e.previousModels=this.models,this._reset(),t=this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,o.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1)
return this.remove(e,t),e},unshift:function(t,e){return this.add(t,o.extend({at:0},e))},shift:function(t){var e=this.at(0)
return this.remove(e,t),e},slice:function(){return l.apply(this.models,arguments)},get:function(t){if(null!=t){var e=this.modelId(this._isModel(t)?t.attributes:t)
return this._byId[t]||this._byId[e]||this._byId[t.cid]}},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){return o.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1
return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator")
return t||(t={}),o.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(o.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0)
var e=t.success,n=this
return t.success=function(i){var r=t.reset?"reset":"set"
n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},wrapError(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?o.clone(e):{},!(t=this._prepareModel(t,e)))return!1
e.wait||this.add(t,e)
var n=this,i=e.success
return e.success=function(t,r){e.wait&&n.add(t,e),i&&i(t,r,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t
e=e?o.clone(e):{},e.collection=this
var n=new this.model(t,e)
return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_isModel:function(t){return t instanceof s},_addReference:function(t,e){this._byId[t.cid]=t
var n=this.modelId(t.attributes)
null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if("add"!==t&&"remove"!==t||n===this){if("destroy"===t&&this.remove(e,i),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes)
r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}this.trigger.apply(this,arguments)}}})
var d=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"]
o.each(d,function(t){o[t]&&(h.prototype[t]=function(){var e=l.call(arguments)
return e.unshift(this.models),o[t].apply(o,e)})})
var f=["groupBy","countBy","sortBy","indexBy"]
o.each(f,function(t){o[t]&&(h.prototype[t]=function(e,n){var i=o.isFunction(e)?e:function(t){return t.get(e)}
return o[t](this.models,i,n)})}),h.extend=r,e.exports=h},{"./model":63,"backbone-events-standalone":65,"backbone-extend-standalone":66,underscore:150}],62:[function(t,e,n){e.exports.Model=t("./model"),e.exports.Collection=t("./collection"),e.exports.Events=t("backbone-events-standalone"),e.exports.extend=t("backbone-extend-standalone")},{"./collection":61,"./model":63,"backbone-events-standalone":65,"backbone-extend-standalone":66}],63:[function(t,e,n){var i=t("backbone-events-standalone"),r=t("backbone-extend-standalone"),o=t("underscore"),s=function(t,e){var n=t||{}
e||(e={}),this.cid=o.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=o.defaults({},n,o.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)}
o.extend(s.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return o.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,s,a,l,h,c,u
if(null==t)return this
if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1
s=n.unset,l=n.silent,a=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=o.clone(this.attributes),this.changed={}),u=this.attributes,c=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute])
for(i in r)e=r[i],o.isEqual(u[i],e)||a.push(i),o.isEqual(c[i],e)?delete this.changed[i]:this.changed[i]=e,s?delete u[i]:u[i]=e
if(!l){a.length&&(this._pending=n)
for(var d=0,f=a.length;f>d;d++)this.trigger("change:"+a[d],this,u[a[d]],n)}if(h)return this
if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n)
return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:!0}))},clear:function(t){var e={}
for(var n in this.attributes)e[n]=void 0
return this.set(e,o.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!o.isEmpty(this.changed):o.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1
var e,n=!1,i=this._changing?this._previousAttributes:this.attributes
for(var r in t)o.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e)
return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0)
var e=this,n=t.success
return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},wrapError(this,t),this.sync("read",this,t)},save:function(t,e,n){var i,r,s,a=this.attributes
if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,n=o.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1
i&&n.wait&&(this.attributes=o.extend({},a,i)),void 0===n.parse&&(n.parse=!0)
var l=this,h=n.success
return n.success=function(t){l.attributes=a
var e=l.parse(t,n)
return n.wait&&(e=o.extend(i||{},e)),o.isObject(e)&&!l.set(e,n)?!1:(h&&h(l,t,n),void l.trigger("sync",l,t,n))},wrapError(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"!==r||n.attrs||(n.attrs=i),s=this.sync(r,this,n),i&&n.wait&&(this.attributes=a),s},destroy:function(t){t=t?o.clone(t):{}
var e=this,n=t.success,i=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)}
if(t.success=function(r){(t.wait||e.isNew())&&i(),n&&n(e,r,t),e.isNew()||e.trigger("sync",e,r,t)},this.isNew())return t.success(),!1
wrapError(this,t)
var r=this.sync("delete",this,t)
return t.wait||i(),r},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||urlError()
return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},o.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0
t=o.extend({},this.attributes,t)
var n=this.validationError=this.validate(t,e)||null
return n?(this.trigger("invalid",this,n,o.extend(e,{validationError:n})),!1):!0}})
var a=["keys","values","pairs","invert","pick","omit","chain","isEmpty"]
o.each(a,function(t){o[t]&&(s.prototype[t]=function(){var e=slice.call(arguments)
return e.unshift(this.attributes),o[t].apply(o,e)})}),s.extend=r,e.exports=s},{"backbone-events-standalone":65,"backbone-extend-standalone":66,underscore:150}],64:[function(t,e,n){!function(){function t(){return{keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object")
var e,n=[]
for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e)
return n},uniqueId:function(t){var e=++l+""
return t?t+e:e},has:function(t,e){return s.call(t,e)},each:function(t,e,n){if(null!=t)if(o&&t.forEach===o)t.forEach(e,n)
else if(t.length===+t.length)for(var i=0,r=t.length;r>i;i++)e.call(n,t[i],i,t)
else for(var s in t)this.has(t,s)&&e.call(n,t[s],s,t)},once:function(t){var e,n=!1
return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}}}var i,r=this,o=Array.prototype.forEach,s=Object.prototype.hasOwnProperty,a=Array.prototype.slice,l=0,h=t()
i={on:function(t,e,n){if(!u(this,"on",t,[e,n])||!e)return this
this._events||(this._events={})
var i=this._events[t]||(this._events[t]=[])
return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this
var i=this,r=h.once(function(){i.off(t,r),e.apply(this,arguments)})
return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,o,s,a,l,c,d
if(!this._events||!u(this,"off",t,[e,n]))return this
if(!t&&!e&&!n)return this._events={},this
for(s=t?[t]:h.keys(this._events),a=0,l=s.length;l>a;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=i=[],e||n)for(c=0,d=o.length;d>c;c++)r=o[c],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r)
i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this
var e=a.call(arguments,1)
if(!u(this,"trigger",t,e))return this
var n=this._events[t],i=this._events.all
return n&&d(n,e),i&&d(i,arguments),this},stopListening:function(t,e,n){var i=this._listeners
if(!i)return this
var r=!e&&!n
"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t)
for(var o in i)i[o].off(e,n,this),r&&delete this._listeners[o]
return this}}
var c=/\s+/,u=function(t,e,n,i){if(!n)return!0
if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i))
return!1}if(c.test(n)){for(var o=n.split(c),s=0,a=o.length;a>s;s++)t[e].apply(t,[o[s]].concat(i))
return!1}return!0},d=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2]
switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx)
return
case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o)
return
case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s)
return
case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a)
return
default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},f={listenTo:"on",listenToOnce:"once"}
h.each(f,function(t,e){i[e]=function(e,n,i){var r=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=h.uniqueId("l"))
return r[o]=e,"object"==typeof n&&(i=this),e[t](n,i,this),this}}),i.bind=i.on,i.unbind=i.off,i.mixin=function(t){var e=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"]
return h.each(e,function(e){t[e]=this[e]},this),t},"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=i),n.BackboneEvents=i):"function"==typeof define&&"object"==typeof define.amd?define(function(){return i}):r.BackboneEvents=i}(this)},{}],65:[function(t,e,n){e.exports=t("./backbone-events-standalone")},{"./backbone-events-standalone":64}],66:[function(t,e,n){!function(t){"object"==typeof n?e.exports=t():"function"==typeof define&&define.amd?define(t):window.BackboneExtend=t()}(function(){"use strict"
var t={has:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},extend:function(t){for(var e=1;e<arguments.length;++e){var n=arguments[e]
if(n)for(var i in n)t[i]=n[i]}return t}},e=function(e,n){var i,r=this
i=e&&t.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},t.extend(i,r,n)
var o=function(){this.constructor=i}
return o.prototype=r.prototype,i.prototype=new o,e&&t.extend(i.prototype,e),i.__super__=r.prototype,i}
return e})},{}],67:[function(t,e,n){var i=t("underscore"),r=t("backbone-events-standalone"),o=t("backbone-extend-standalone"),s=t("jbone"),a=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,h)),this._ensureElement(),this.initialize.apply(this,arguments)},l=/^(\S+)\s*(.*)$/,h=["model","collection","el","id","attributes","className","tagName","events"]
i.extend(a.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof s?t:s(t),this.el=this.$el[0]},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this
this.undelegateEvents()
for(var e in t){var n=t[e]
if(i.isFunction(n)||(n=this[t[e]]),n){var r=e.match(l)
this.delegate(r[1],r[2],i.bind(n,this))}}return this},delegate:function(t,e,n){this.$el.on(t+".delegateEvents"+this.cid,e,n)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){this.$el.off(t+".delegateEvents"+this.cid,e,n)},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"))
else{var t=i.extend({},i.result(this,"attributes"))
this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),a.extend=o,e.exports=a},{"backbone-events-standalone":69,"backbone-extend-standalone":70,jbone:126,underscore:150}],68:[function(t,e,n){arguments[4][64][0].apply(n,arguments)},{dup:64}],69:[function(t,e,n){arguments[4][65][0].apply(n,arguments)},{"./backbone-events-standalone":68,dup:65}],70:[function(t,e,n){arguments[4][66][0].apply(n,arguments)},{dup:66}],71:[function(t,e,n){var i=t("backbone-events-standalone")
i.onAll=function(t,e){return this.on("all",t,e),this},i.oldMixin=i.mixin,i.mixin=function(t){i.oldMixin(t)
for(var e=["onAll"],n=0;n<e.length;n++){var r=e[n]
t[r]=this[r]}return t},e.exports=i},{"backbone-events-standalone":73}],72:[function(t,e,n){arguments[4][64][0].apply(n,arguments)},{dup:64}],73:[function(t,e,n){arguments[4][65][0].apply(n,arguments)},{"./backbone-events-standalone":72,dup:65}],74:[function(t,e,n){var i,r,o
r=t("biojs-io-parser"),o=t("msa-seqtools"),e.exports=i={parse:function(t){var e,n,i,r,s,a,l,h,c,u,d,f,g
if(f=[],l="[object Array]"===Object.prototype.toString.call(t)?t:t.split("\n"),l[0].slice(0,6)===!1)throw new Error("Invalid CLUSTAL Header")
for(i=0,e=1,d=0;i<l.length;)i++,a=l[i],null!=a&&0!==a.length&&0!==a.trim().length?o.contains(a,"*")||(1===e&&(d=0,e=0),u=/^(?:\s*)(\S+)(?:\s+)(\S+)(?:\s*)(\d*)(?:\s*|$)/g,h=u.exec(a),null!=h?(s=h[1],g=h[2],d>=f.length?(c=o.getMeta(s),s=c.name,n=new o.model(g,s,d),n.ids=c.ids||{},n.details=c.details||{},r=Object.keys(n.ids),r.length>0&&(n.id=n.ids[r[0]]),f.push(n)):f[d].seq+=g,d++):console.log("parse error",a)):e=1
return f}},r.mixin(i)},{"biojs-io-parser":75,"msa-seqtools":148}],75:[function(t,e,n){var i,r=t("request"),o=t("vow")
e.exports=i=function(){function t(){}return t.read=function(e,n){var i
if(i=function(e){return function(i,r,o){return t._onRetrieval(i,o,n,e)}}(this),"undefined"==typeof n){var s=o.defer()
return n=function(t,e){t?s.reject(t):s.resolve(e)},r(e,i),s.promise()}return r(e,i)},t._onRetrieval=function(t,e,n,i){var r
return"undefined"!=typeof t&&(r=i.parse(e)),n.call(i,t,r)},t.extend=function(e,n){return extend(t,e,n)},t.mixin=function(e){var n=["read"]
return"object"!=typeof e&&(e=e.prototype),n.forEach(function(n){e[n]=t[n]},this),e},t}()},{request:77,vow:76}],76:[function(t,e,n){(function(t){!function(n){var i,r=function(){var e=[],i=function(t){return 1===e.push(t)},r=function(){var t=e,n=0,i=e.length
for(e=[];i>n;)t[n++]()}
if("function"==typeof setImmediate)return function(t){i(t)&&setImmediate(r)}
if("object"==typeof t&&t.nextTick)return function(e){i(e)&&t.nextTick(r)}
var o=n.MutationObserver||n.WebKitMutationObserver
if(o){var s=1,a=document.createTextNode("")
return new o(r).observe(a,{characterData:!0}),function(t){i(t)&&(a.data=s*=-1)}}if(n.postMessage){var l=!0
if(n.attachEvent){var h=function(){l=!1}
n.attachEvent("onmessage",h),n.postMessage("__checkAsync","*"),n.detachEvent("onmessage",h)}if(l){var c="__promise"+ +new Date,u=function(t){t.data===c&&(t.stopPropagation&&t.stopPropagation(),r())}
return n.addEventListener?n.addEventListener("message",u,!0):n.attachEvent("onmessage",u),function(t){i(t)&&n.postMessage(c,"*")}}}var d=n.document
if("onreadystatechange"in d.createElement("script")){var f=function(){var t=d.createElement("script")
t.onreadystatechange=function(){t.parentNode.removeChild(t),t=t.onreadystatechange=null,r()},(d.documentElement||d.body).appendChild(t)}
return function(t){i(t)&&f()}}return function(t){i(t)&&setTimeout(r,0)}}(),o=function(t){r(function(){throw t})},s=function(t){return"function"==typeof t},a=function(t){return null!==t&&"object"==typeof t},l=Object.prototype.toString,h=Array.isArray||function(t){return"[object Array]"===l.call(t)},c=function(t){for(var e=[],n=0,i=t.length;i>n;)e.push(n++)
return e},u=Object.keys||function(t){var e=[]
for(var n in t)t.hasOwnProperty(n)&&e.push(n)
return e},d=function(t){var e=function(e){this.name=t,this.message=e}
return e.prototype=new Error,e},f=function(t,e){return function(n){t.call(this,n,e)}},g=function(){this._promise=new m}
g.prototype={promise:function(){return this._promise},resolve:function(t){this._promise.isResolved()||this._promise._resolve(t)},reject:function(t){this._promise.isResolved()||(x.isPromise(t)?(t=t.then(function(t){var e=x.defer()
return e.reject(t),e.promise()}),this._promise._resolve(t)):this._promise._reject(t))},notify:function(t){this._promise.isResolved()||this._promise._notify(t)}}
var p={PENDING:0,RESOLVED:1,FULFILLED:2,REJECTED:3},m=function(t){if(this._value=i,this._status=p.PENDING,this._fulfilledCallbacks=[],this._rejectedCallbacks=[],this._progressCallbacks=[],t){var e=this,n=t.length
t(function(t){e.isResolved()||e._resolve(t)},n>1?function(t){e.isResolved()||e._reject(t)}:i,n>2?function(t){e.isResolved()||e._notify(t)}:i)}}
m.prototype={valueOf:function(){return this._value},isResolved:function(){return this._status!==p.PENDING},isFulfilled:function(){return this._status===p.FULFILLED},isRejected:function(){return this._status===p.REJECTED},then:function(t,e,n,i){var r=new g
return this._addCallbacks(r,t,e,n,i),r.promise()},"catch":function(t,e){return this.then(i,t,e)},fail:function(t,e){return this.then(i,t,e)},always:function(t,e){var n=this,i=function(){return t.call(this,n)}
return this.then(i,i,e)},progress:function(t,e){return this.then(i,i,t,e)},spread:function(t,e,n){return this.then(function(e){return t.apply(this,e)},e,n)},done:function(t,e,n,i){this.then(t,e,n,i).fail(o)},delay:function(t){var e,n=this.then(function(n){var i=new g
return e=setTimeout(function(){i.resolve(n)},t),i.promise()})
return n.always(function(){clearTimeout(e)}),n},timeout:function(t){var e=new g,n=setTimeout(function(){e.reject(new x.TimedOutError("timed out"))},t)
return this.then(function(t){e.resolve(t)},function(t){e.reject(t)}),e.promise().always(function(){clearTimeout(n)}),e.promise()},_vow:!0,_resolve:function(t){if(!(this._status>p.RESOLVED)){if(t===this)return void this._reject(TypeError("Can't resolve promise with itself"))
if(this._status=p.RESOLVED,t&&t._vow)return void(t.isFulfilled()?this._fulfill(t.valueOf()):t.isRejected()?this._reject(t.valueOf()):t.then(this._fulfill,this._reject,this._notify,this))
if(a(t)||s(t)){var e
try{e=t.then}catch(n){return void this._reject(n)}if(s(e)){var i=this,r=!1
try{e.call(t,function(t){r||(r=!0,i._resolve(t))},function(t){r||(r=!0,i._reject(t))},function(t){i._notify(t)})}catch(n){r||this._reject(n)}return}}this._fulfill(t)}},_fulfill:function(t){this._status>p.RESOLVED||(this._status=p.FULFILLED,this._value=t,this._callCallbacks(this._fulfilledCallbacks,t),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=i)},_reject:function(t){this._status>p.RESOLVED||(this._status=p.REJECTED,this._value=t,this._callCallbacks(this._rejectedCallbacks,t),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=i)},_notify:function(t){this._callCallbacks(this._progressCallbacks,t)},_addCallbacks:function(t,e,n,r,o){n&&!s(n)?(o=n,n=i):r&&!s(r)&&(o=r,r=i)
var a
this.isRejected()||(a={defer:t,fn:s(e)?e:i,ctx:o},this.isFulfilled()?this._callCallbacks([a],this._value):this._fulfilledCallbacks.push(a)),this.isFulfilled()||(a={defer:t,fn:n,ctx:o},this.isRejected()?this._callCallbacks([a],this._value):this._rejectedCallbacks.push(a)),this._status<=p.RESOLVED&&this._progressCallbacks.push({defer:t,fn:r,ctx:o})},_callCallbacks:function(t,e){var n=t.length
if(n){var i=this.isResolved(),o=this.isFulfilled()
r(function(){for(var r,s,a,l=0;n>l;)if(r=t[l++],s=r.defer,a=r.fn){var h,c=r.ctx
try{h=c?a.call(c,e):a(e)}catch(u){s.reject(u)
continue}i?s.resolve(h):s.notify(h)}else i?o?s.resolve(e):s.reject(e):s.notify(e)})}}}
var v={cast:function(t){return x.cast(t)},all:function(t){return x.all(t)},race:function(t){return x.anyResolved(t)},resolve:function(t){return x.resolve(t)},reject:function(t){return x.reject(t)}}
for(var b in v)v.hasOwnProperty(b)&&(m[b]=v[b])
var x={Deferred:g,Promise:m,defer:function(){return new g},when:function(t,e,n,i,r){return x.cast(t).then(e,n,i,r)},fail:function(t,e,n){return x.when(t,i,e,n)},always:function(t,e,n){return x.when(t).always(e,n)},progress:function(t,e,n){return x.when(t).progress(e,n)},spread:function(t,e,n,i){return x.when(t).spread(e,n,i)},done:function(t,e,n,i,r){x.when(t).done(e,n,i,r)},isPromise:function(t){return a(t)&&s(t.then)},cast:function(t){return t&&t._vow?t:x.resolve(t)},valueOf:function(t){return t&&s(t.valueOf)?t.valueOf():t},isFulfilled:function(t){return t&&s(t.isFulfilled)?t.isFulfilled():!0},isRejected:function(t){return t&&s(t.isRejected)?t.isRejected():!1},isResolved:function(t){return t&&s(t.isResolved)?t.isResolved():!0},resolve:function(t){var e=x.defer()
return e.resolve(t),e.promise()},fulfill:function(t){var e=x.defer(),n=e.promise()
return e.resolve(t),n.isFulfilled()?n:n.then(null,function(t){return t})},reject:function(t){var e=x.defer()
return e.reject(t),e.promise()},invoke:function(t,e){var i,r=Math.max(arguments.length-1,0)
if(r){i=Array(r)
for(var o=0;r>o;)i[o++]=arguments[o]}try{return x.resolve(i?t.apply(n,i):t.call(n))}catch(s){return x.reject(s)}},all:function(t){var e=new g,n=h(t),i=n?c(t):u(t),r=i.length,o=n?[]:{}
if(!r)return e.resolve(o),e.promise()
var s=r
return x._forEach(t,function(t,n){o[i[n]]=t,--s||e.resolve(o)},e.reject,e.notify,e,i),e.promise()},allResolved:function(t){var e=new g,n=h(t),i=n?c(t):u(t),r=i.length,o=n?[]:{}
if(!r)return e.resolve(o),e.promise()
var s=function(){--r||e.resolve(t)}
return x._forEach(t,s,s,e.notify,e,i),e.promise()},allPatiently:function(t){return x.allResolved(t).then(function(){var e,n,i,r,o=h(t),s=o?c(t):u(t),a=s.length,l=0
if(!a)return o?[]:{}
for(;a>l;)i=s[l++],r=t[i],x.isRejected(r)?(e||(e=o?[]:{}),o?e.push(r.valueOf()):e[i]=r.valueOf()):e||((n||(n=o?[]:{}))[i]=x.valueOf(r))
if(e)throw e
return n})},any:function(t){var e=new g,n=t.length
if(!n)return e.reject(Error()),e.promise()
var i,r=0
return x._forEach(t,e.resolve,function(t){r||(i=t),++r===n&&e.reject(i)},e.notify,e),e.promise()},anyResolved:function(t){var e=new g,n=t.length
return n?(x._forEach(t,e.resolve,e.reject,e.notify,e),e.promise()):(e.reject(Error()),e.promise())},delay:function(t,e){return x.resolve(t).delay(e)},timeout:function(t,e){return x.resolve(t).timeout(e)},_forEach:function(t,e,n,i,r,o){for(var s=o?o.length:t.length,a=0;s>a;)x.when(t[o?o[a]:a],f(e,a),n,i,r),++a},TimedOutError:d("TimedOut")},w=!0
"object"==typeof e&&"object"==typeof e.exports&&(e.exports=x,w=!1),"object"==typeof modules&&s(modules.define)&&(modules.define("vow",function(t){t(x)}),w=!1),"function"==typeof define&&(define(function(t,e,n){n.exports=x}),w=!1),w&&(n.vow=x)}(this)}).call(this,t("_process"))},{_process:1}],77:[function(t,e,n){"use strict"
function i(t){for(var e in t)if(t.hasOwnProperty(e))return!1
return!0}function r(t,e){function n(){4===u.readyState&&h()}function o(){var t=void 0
if(u.response?t=u.response:"text"!==u.responseType&&u.responseType||(t=u.responseText||u.responseXML),w)try{t=JSON.parse(t)}catch(e){}return t}function s(t){clearTimeout(g),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,e(t,c)}function h(){if(!f){var n
clearTimeout(g),n=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status
var i=c,r=null
0!==n?(i={body:o(),statusCode:n,method:m,headers:{},url:p,rawRequest:u},u.getAllResponseHeaders&&(i.headers=l(u.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),e(r,i,i.body)}}var c={body:void 0,headers:{},statusCode:0,method:m,url:p,rawRequest:u}
if("string"==typeof t&&(t={uri:t}),t=t||{},"undefined"==typeof e)throw new Error("callback argument missing")
e=a(e)
var u=t.xhr||null
u||(u=t.cors||t.useXDR?new r.XDomainRequest:new r.XMLHttpRequest)
var d,f,g,p=u.url=t.uri||t.url,m=u.method=t.method||"GET",v=t.body||t.data,b=u.headers=t.headers||{},x=!!t.sync,w=!1
if("json"in t&&(w=!0,b.accept||b.Accept||(b.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(b["content-type"]||b["Content-Type"]||(b["Content-Type"]="application/json"),v=JSON.stringify(t.json))),u.onreadystatechange=n,u.onload=h,u.onerror=s,u.onprogress=function(){},u.ontimeout=s,u.open(m,p,!x,t.username,t.password),x||(u.withCredentials=!!t.withCredentials),!x&&t.timeout>0&&(g=setTimeout(function(){f=!0,u.abort("timeout")
var t=new Error("XMLHttpRequest timeout")
t.code="ETIMEDOUT",s(t)},t.timeout)),u.setRequestHeader)for(d in b)b.hasOwnProperty(d)&&u.setRequestHeader(d,b[d])
else if(t.headers&&!i(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object")
return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(v),u}function o(){}var s=t("global/window"),a=t("once"),l=t("parse-headers")
e.exports=r,r.XMLHttpRequest=s.XMLHttpRequest||o,r.XDomainRequest="withCredentials"in new r.XMLHttpRequest?r.XMLHttpRequest:s.XDomainRequest},{"global/window":78,once:79,"parse-headers":83}],78:[function(t,e,n){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:"undefined"!=typeof self?e.exports=self:e.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],79:[function(t,e,n){function i(t){var e=!1
return function(){return e?void 0:(e=!0,t.apply(this,arguments))}}e.exports=i,i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0})})},{}],80:[function(t,e,n){function i(t,e,n){if(!a(e))throw new TypeError("iterator must be a function")
arguments.length<3&&(n=this),"[object Array]"===l.call(t)?r(t,e,n):"string"==typeof t?o(t,e,n):s(t,e,n)}function r(t,e,n){for(var i=0,r=t.length;r>i;i++)h.call(t,i)&&e.call(n,t[i],i,t)}function o(t,e,n){for(var i=0,r=t.length;r>i;i++)e.call(n,t.charAt(i),i,t)}function s(t,e,n){for(var i in t)h.call(t,i)&&e.call(n,t[i],i,t)}var a=t("is-function")
e.exports=i
var l=Object.prototype.toString,h=Object.prototype.hasOwnProperty},{"is-function":81}],81:[function(t,e,n){function i(t){var e=r.call(t)
return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}e.exports=i
var r=Object.prototype.toString},{}],82:[function(t,e,n){function i(t){return t.replace(/^\s*|\s*$/g,"")}n=e.exports=i,n.left=function(t){return t.replace(/^\s*/,"")},n.right=function(t){return t.replace(/\s*$/,"")}},{}],83:[function(t,e,n){var i=t("trim"),r=t("for-each"),o=function(t){return"[object Array]"===Object.prototype.toString.call(t)}
e.exports=function(t){if(!t)return{}
var e={}
return r(i(t).split("\n"),function(t){var n=t.indexOf(":"),r=i(t.slice(0,n)).toLowerCase(),s=i(t.slice(n+1))
"undefined"==typeof e[r]?e[r]=s:o(e[r])?e[r].push(s):e[r]=[e[r],s]}),e}},{"for-each":80,trim:82}],84:[function(t,e,n){var i,r,o
r=t("biojs-io-parser"),o=t("msa-seqtools"),e.exports=i={parse:function(t){var e,n,i,r,s,a,l,h
if(a=[],!t||0===t.length)return[]
for("[object Array]"!==Object.prototype.toString.call(t)&&(t=t.split("\n")),l=0,h=t.length;h>l;l++)r=t[l],">"===r[0]||";"===r[0]?(i=r.slice(1),s=o.getMeta(i),i=s.name,e=new o.model("",i,a.length),e.ids=s.ids||{},n=Object.keys(e.ids),n.length>0&&(e.id=e.ids[n[0]]),e.details=s.details||{},a.push(e)):e.seq+=r
return a},write:function(t,e){var n,i,r,s
for(i="",r=0,s=t.length;s>r;r++)n=t[r],null!=e&&(n=e(n)),i+=">"+n.name+"\n",i+=o.splitNChars(n.seq,80).join("\n"),i+="\n"
return i}},r.mixin(i)},{"biojs-io-parser":85,"msa-seqtools":148}],85:[function(t,e,n){arguments[4][75][0].apply(n,arguments)},{dup:75,request:87,vow:86}],86:[function(t,e,n){arguments[4][76][0].apply(n,arguments)},{_process:1,dup:76}],87:[function(t,e,n){arguments[4][77][0].apply(n,arguments)},{dup:77,"global/window":88,once:89,"parse-headers":93}],88:[function(t,e,n){arguments[4][78][0].apply(n,arguments)},{dup:78}],89:[function(t,e,n){arguments[4][79][0].apply(n,arguments)},{dup:79}],90:[function(t,e,n){arguments[4][80][0].apply(n,arguments)},{dup:80,"is-function":91}],91:[function(t,e,n){arguments[4][81][0].apply(n,arguments)},{dup:81}],92:[function(t,e,n){arguments[4][82][0].apply(n,arguments)},{dup:82}],93:[function(t,e,n){arguments[4][83][0].apply(n,arguments)},{dup:83,"for-each":90,trim:92}],94:[function(t,e,n){var i=t("biojs-io-parser"),r=function(){}
i.mixin(r),e.exports=r
var o=t("./utils"),s=t("./jalview")
r.parseLines=function(t){var e=t.split("\n"),n={},i=[]
n.type=r._guessType(e)
var o=0
if("jalview"===n.type){var a=s.readHeader(e)
o=a.offset,n.colors=a.colors,i=a.features}for(var l=o;l<e.length;l++){var h=e[l]
0!==h.length&&"#"!==h[0]&&(h=r.parseLine(h),void 0!==h&&i.push(h))}return{features:i,config:n}},r._guessType=function(t){return"##gff-version 3"===t[0].substring(0,15)?"gff3":t[0].indexOf("#")<0&&2===t[0].split("	").length?"jalview":"gff3"},r.parseSeqs=r.parse=function(t){var e=r.parseLines(t),n={}
return e.features.forEach(function(t){var e=t.seqname
void 0===n[e]&&(n[e]=[]),delete t.seqname,n[e].push(t)}),delete e.features,e.seqs=n,e},r.parseLine=function(t){var e={},n=t.split(/\s+/)
if(1!==n.length){e.seqname=n[0],e.source=n[1],e.feature=n[2],e.start=parseInt(n[3]),e.end=parseInt(n[4]),e.score=n[5],e.strand=n[6],e.frame=n[7]
var i=n.slice(8).join(" ")
return Object.keys(e).forEach(function(t){"."===e[t]&&(e[t]=void 0)}),e.score&&(e.score=parseFloat(e.score)),e.frame&&(e.frame=parseInt(e.frame)),e.attributes=o.extractKeys(i),e}},r.exportLine=function(t){var e=Object.keys(t.attributes).map(function(e){return e+"="+t.attributes[e]}).join(";"),n=[t.seqname,t.source,t.feature,t.start,t.end,t.score,t.strand,t.frame,e]
return n=n.map(function(t){return void 0===t?".":t}),n.join("	")},r.exportLines=function(t){return"##gff-version 3\n"+t.map(r.exportLine).join("\n")},r.exportSeqs=r["export"]=function(t){var e=[],n=function(t){t.seqname=i,e.push(t)}
for(var i in t)t[i].forEach(n)
return r.exportLines(e)}},{"./jalview":95,"./utils":96,"biojs-io-parser":97}],95:[function(t,e,n){var i={}
e.exports=i
var r=t("./utils")
i.readHeader=function(t){for(var e,n={},r=0,o=[];r<t.length;r++){var s=t[r]
if(s.indexOf("#")>=0)break
var a=s.split(/\t/),l=a[0].trim()
if("GFF"===l)break
if(2===a.length)if("startgroup"===l)e=a[1].trim()
else{if("endgroup"===l){e=""
continue}n[a[0]]=i.parseColor(a[1])}else if(a.length>=5){var h=i.parseLine(a)
e&&(h.attributes.Parent=e),o.push(h)}}return{offset:r,colors:n,features:o}},i.parseColor=function(t){return t.indexOf(",")>=0?r.rgbToHex(t.split(",").map(function(t){return parseInt(t)})):6===t.length&&parseInt(t.charAt(0),16)<=16&&"bisque"!==t?"#"+t:t},i.parseLine=function(t){var e={attributes:{}}
return e.attributes.Name=t[0].trim(),e.seqname=t[1].trim(),e.start=parseInt(t[3]),e.end=parseInt(t[4]),e.feature=t[5].trim(),"ID_NOT_SPECIFIED"===e.seqname&&(e.seqname=t[2].trim()),e}},{"./utils":96}],96:[function(t,e,n){function i(t){var e=t.toString(16)
return 1===e.length?"0"+e:e}var r={}
e.exports=r,r.extractKeys=function(t){var e={},n=t.split(";")
return n.forEach(function(t){var n,i,r
t.indexOf("=")>0?(n=t.split("="),i=n[0],r=n[1],e[i]=r):t.indexOf(" ")>0&&(n=t.split(" "),i=n[0],r=n[1].replace(/"/g,""),e[i]=r)}),e},r.rgbToHex=function(t,e,n){return 3===t.length?r.rgbToHex(t[0],t[1],t[2]):"#"+i(t)+i(e)+i(n)}},{}],97:[function(t,e,n){arguments[4][75][0].apply(n,arguments)},{dup:75,request:99,vow:98}],98:[function(t,e,n){arguments[4][76][0].apply(n,arguments)},{_process:1,dup:76}],99:[function(t,e,n){arguments[4][77][0].apply(n,arguments)},{dup:77,"global/window":100,once:101,"parse-headers":105}],100:[function(t,e,n){arguments[4][78][0].apply(n,arguments)},{dup:78}],101:[function(t,e,n){arguments[4][79][0].apply(n,arguments)},{dup:79}],102:[function(t,e,n){arguments[4][80][0].apply(n,arguments)},{dup:80,"is-function":103}],103:[function(t,e,n){arguments[4][81][0].apply(n,arguments)},{dup:81}],104:[function(t,e,n){arguments[4][82][0].apply(n,arguments)},{dup:82}],105:[function(t,e,n){arguments[4][83][0].apply(n,arguments)},{dup:83,"for-each":102,trim:104}],106:[function(t,e,n){e.exports.seq=t("./seq")},{"./seq":107}],107:[function(t,e,n){e.exports=function(t,e,n){this.seq=t,this.name=e,this.id=n,this.meta={}}},{}],108:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":114}],109:[function(t,e,n){e.exports={render_x_axis_label:function(){var t="Model Position"
this.display_ali_map&&(t="Alignment Column"),this.called_on.find(".logo_xaxis").remove(),this.called_on.prepend('<div class="logo_xaxis" class="centered" style="margin-left:40px"><p class="xaxis_text" style="width:10em;margin:1em auto">'+t+"</p></div>")},render_y_axis_label:function(){this.dom_element.parent().before('<canvas class="logo_yaxis" height="'+this.options.height+'" width="55"></canvas>')
var t=this.called_on.find(".logo_yaxis"),e=(Math.abs(this.data.max_height),isNaN(this.data.min_height_obs)?0:parseInt(this.data.min_height_obs,10),null),n="Information Content (bits)"
e=t[0].getContext("2d"),e.beginPath(),e.moveTo(55,1),e.lineTo(40,1),e.moveTo(55,this.info_content_height),e.lineTo(40,this.info_content_height),e.moveTo(55,this.info_content_height/2),e.lineTo(40,this.info_content_height/2),e.lineWidth=1,e.strokeStyle="#666666",e.stroke(),e.fillStyle="#666666",e.textAlign="right",e.font="bold 10px Arial",e.textBaseline="top",e.fillText(parseFloat(this.data.max_height).toFixed(1),38,0),e.textBaseline="middle",e.fillText(parseFloat(this.data.max_height/2).toFixed(1),38,this.info_content_height/2),e.fillText("0",38,this.info_content_height),"score"===this.data.height_calc&&(n="Score (bits)"),e.save(),e.translate(5,this.height/2-20),e.rotate(-Math.PI/2),e.textAlign="center",e.font="normal 12px Arial",e.fillText(n,1,0),e.restore(),e.fillText("occupancy",55,this.info_content_height+7),this.show_inserts&&(e.fillText("ins. prob.",50,280),e.fillText("ins. len.",46,296))}}},{}],110:[function(t,e,n){var i=null
e.exports=function(){if(!i){var t=document.createElement("canvas")
i=!(!t.getContext||!t.getContext("2d"))}return i}},{}],111:[function(t,e,n){e.exports={A:"#FF9966",C:"#009999",D:"#FF0000",E:"#CC0033",F:"#00FF00",G:"#f2f20c",H:"#660033",I:"#CC9933",K:"#663300",L:"#FF9933",M:"#CC99CC",N:"#336666",P:"#0099FF",Q:"#6666CC",R:"#990000",S:"#0000FF",T:"#00FFFF",V:"#FFCC33",W:"#66CC66",Y:"#006600"}},{}],112:[function(t,e,n){e.exports={A:"#cbf751",C:"#5ec0cc",G:"#ffdf59",T:"#b51f16",U:"#b51f16"}},{}],113:[function(t,e,n){var i=t("jbone")
e.exports=function(t,e,n){t.find(".logo_settings_switch, .logo_settings .close").on("click",function(t){t.preventDefault(),i(".logo_settings").toggle()}),t.find(".logo_reset").on("click",function(t){t.preventDefault(),e.changeZoom({target:e.default_zoom})}),t.find(".logo_change").on("click",function(t){t.preventDefault()}),t.find(".logo_zoomin").on("click",function(t){t.preventDefault(),e.changeZoom({distance:.1,direction:"+"})}),t.find(".logo_zoomout").on("click",function(t){t.preventDefault(),e.changeZoom({distance:.1,direction:"-"})}),t.find(".logo_scale").on("change",function(t){e.toggleScale(this.value)}),t.find(".logo_color").on("change",function(t){e.toggleColorscheme(this.value)}),t.find(".logo_ali_map").on("change",function(t){e.toggleAliMap(this.value)}),t.find(".logo_position").on("change",function(){this.value.match(/^\d+$/m)&&e.scrollToColumn(this.value,1)}),n.on("dblclick",function(n){console.log("dblclick",e),offset=e.logo_graphic.offset(),x=parseInt(n.pageX-offset.left,10),window_position=n.pageX-t.parent().offset().left,col=e.columnFromCoordinates(x),console.log("col",col),current=e.zoom,current<1?e.changeZoom({target:1,offset:window_position,column:col}):e.changeZoom({target:.3,offset:window_position,column:col})}),i(document).on(t.attr("id")+".scrolledTo",function(t,n,i,r){e.render({target:n})}),i(document).on("keydown",function(t){t.ctrlKey||(61!==t.which&&107!==t.which||(zoom+=.1,e.changeZoom({distance:.1,direction:"+"})),109!==t.which&&0!==t.which||(zoom-=.1,e.changeZoom({distance:.1,direction:"-"})))})}},{jbone:126}],114:[function(t,e,n){_=t("underscore")
var i=t("./canvasSupport.js"),r=t("./render/render.js"),o=t("./model/letter.js"),s=t("backbone-viewj"),a=t("./axis"),l=t("./eventListener.js"),h=t("./info/settings.js"),c=t("jbone")
e.exports=s.extend({options:{xaxis:!0,yaxis:!0,height:300,column_width:34,debug:!0,scale_height_enabled:!0,scaled_max:!0,zoom_buttons:!0,colorscheme:"default",data:void 0,start:1,end:void 0,zoom:.4,colors:void 0,divider:!1,show_probs:!1,divider_step:5,show_divider:!1,border:!1,settings:!1,scroller:!0,positionMarker:!0},loadDefault:function(e){this.data=e.data,this.display_ali_map=0,this.alphabet=e.data.alphabet||"dna",this.start=e.start,this.zoom=parseFloat(e.zoom)||.4,this.default_zoom=this.zoom,this.column_width=e.column_width,this.height=e.height,this.canvas_width=5e3,this.scale_height_enabled=e.scale_height_enabled,this.scrollme=null,this.previous_target=0,this.rendered=[],this.previous_zoom=0,void 0==this.data.max_height&&(this.data.max_height=this.calcMaxHeight(this.data.heightArr)),this.data.insert_probs&&this.data.delete_probs||(this.options.show_probs=!1),e.scaled_max?this.data.max_height=e.data.max_height_obs||this.data.max_height||2:this.data.max_height=e.data.max_height_theory||this.data.max_height||2,e.colors?this.changeColors(e.colors):"aa"===this.alphabet?(this.aa_colors=t("./colors/aa.js"),this.changeColors(this.aa_colors)):(this.dna_colors=t("./colors/dna.js"),this.changeColors(this.dna_colors))},initialize:function(t){if(!i())return void(this.el.textContent="Your browser doesn't support canvas.")
void 0==t.data&&(this.el.textContent="No data added."),_.extend(this.options,t)
var e=this.options
if(this.loadDefault(e),this.options.show_probs?this.data.processing&&/^observed|weighted/.test(this.data.processing)?(this.show_inserts=0,this.info_content_height=this.height-14):(this.show_inserts=1,this.info_content_height=this.height-44):this.info_content_height=this.height,this.$el=c(this.el),this.initDivs(),this.options.settings){var n=h(this,e)
this.$el.append(n)}l(this.$el,this,this.logo_graphic)},initDivs:function(){var t=u("div")
t.className="logo_graphic",this.logo_graphic=c(t)
var e=u("div")
if(e.className="logo_container",e.style.height=this.height,this.container=c(e),this.container.append(t),this.$el.append(e),this.options.divider){var n=u("div")
n.className="logo_divider",this.$el.append(n)}this.dom_element=c(t),this.called_on=this.$el,this.options.xaxis&&a.render_x_axis_label.call(this),this.options.yaxis?a.render_y_axis_label.call(this):this.container[0].style.marginLeft="0px"},render:function(){return r.call(this),this},changeColors:function(t){this.colors=t
var e=void 0!=t&&void 0!=t.type
e&&(this.colorscheme="dynamic"),this.buildAlphabet()},buildAlphabet:function(){this.letters={}
var t=this.colors
if("dynamic"==this.colorscheme){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")
t={},e.forEach(function(e){t[e]=""})}for(var n in t)if(t.hasOwnProperty(n)){var i={color:t[n]}
this.letters[n]=new o(n,i)}},toggleColorscheme:function(t){var e=this.currentColumn()
t?"default"===t?this.colorscheme="default":this.colorscheme="consensus":"default"===this.colorscheme?this.colorscheme="consensus":this.colorscheme="default",this.rendered=[],this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},toggleScale:function(t){var e=this.currentColumn()
t?"obs"===t?this.data.max_height=this.data.max_height_obs:this.data.max_height=this.data.max_height_theory:this.data.max_height===this.data.max_height_obs?this.data.max_height=this.data.max_height_theory:this.data.max_height=this.data.max_height_obs,this.rendered=[],this.logoYAxis&&this.logoYAxis.remove(),a.render_y_axis_label.call(this),this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},toggleAliMap:function(t){var e=this.currentColumn()
t?"model"===t?this.display_ali_map=0:this.display_ali_map=1:1===this.display_ali_map?this.display_ali_map=0:this.display_ali_map=1,a.render_x_axis_label(this),this.rendered=[],this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},currentColumn:function(){var t=this.scrollme.scroller.getValues().left,e=this.column_width*this.zoom,n=t/e,i=this.container.width()/e/2,r=Math.ceil(n+i)
return r},changeZoom:function(t){var e=.3,n=null
if(t.target?e=t.target:t.distance&&(e=(parseFloat(this.zoom)-parseFloat(t.distance)).toFixed(1),"+"===t.direction&&(e=(parseFloat(this.zoom)+parseFloat(t.distance)).toFixed(1))),e>1?e=1:.1>e&&(e=.1),n=this.logo_graphic.width()*e/this.zoom,n>this.container.width())if(t.column){this.zoom=e,this.render({zoom:this.zoom}),this.scrollme.reflow()
var i=this.coordinatesFromColumn(t.column)
this.scrollme.scroller.scrollTo(i-t.offset)}else{var r=this.currentColumn()
this.zoom=e,this.render({zoom:this.zoom}),this.scrollme.reflow(),this.scrollToColumn(r)}return this.zoom},columnFromCoordinates:function(t){var e=Math.ceil(t/(this.column_width*this.zoom))
return e},coordinatesFromColumn:function(t){var e=t-1,n=e*(this.column_width*this.zoom)+this.column_width*this.zoom/2
return n},scrollToColumn:function(t,e){var n=this.logo_container.width()/2,i=this.coordinatesFromColumn(t)
this.scrollme.scroller.scrollTo(i-n,0,e)},calcMaxHeight:function(t){return t.reduce(function(t,e){var n=0
for(var i in e)n+=e[i]
return n>t?n:t},0)}})
var u=function(t){return document.createElement(t)}},{"./axis":109,"./canvasSupport.js":110,"./colors/aa.js":111,"./colors/dna.js":112,"./eventListener.js":113,"./info/settings.js":115,"./model/letter.js":116,"./render/render.js":120,"backbone-viewj":67,jbone:126,underscore:150}],115:[function(t,e,n){var i=t("jbone")
e.exports=function(t,e){var n=i('<form class="logo_form"><fieldset><label for="position">Column number</label><input type="text" name="position" class="logo_position"></input><button class="button logo_change">Go</button></fieldset></form>'),r=i('<div class="logo_settings"></div>')
if(r.append('<span class="close">x</span>'),t.scale_height_enabled&&t.data.max_height_obs<t.data.max_height_theory){var o="",s="",a="",l=""
t.data.max_height_obs===t.data.max_height?o="checked":s="checked"}var h='<fieldset><legend>Scale</legend><label><input type="radio" name="scale" class="logo_scale" value="obs" '+o+"/>Maximum Observed "+l+'</label></br><label><input type="radio" name="scale" class="logo_scale" value="theory" '+s+"/>Maximum Theoretical "+a+"</label></fieldset>"
if(r.append(h),"score"!==t.data.height_calc&&"aa"===t.data.alphabet&&t.data.probs_arr){var c=null,u=null,d="",f=""
"default"===t.colorscheme?c="checked":u="checked",e.help&&(d='<a class="help" href="/help#colors_default" title="Each letter receives its own color."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>',f='<a class="help" href="/help#colors_consensus" title="Letters are colored as in Clustalx and Jalview, with colors depending on composition of the column."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>')
var g='<fieldset><legend>Color Scheme</legend><label><input type="radio" name="color" class="logo_color" value="default" '+c+"/>Default "+d+'</label></br><label><input type="radio" name="color" class="logo_color" value="consensus" '+u+"/>Consensus Colors "+f+"</label></fieldset>"
r.append(g)}if(t.data.ali_map){var p=null,m=null,v="",b=""
0===t.display_ali_map?p="checked":m="checked",e.help&&(v='<a class="help" href="/help#coords_model" title="The coordinates along the top of the plot show the model position."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>',b='<a class="help" href="/help#coords_ali" title="The coordinates along the top of the plot show the column in the alignment associated with the model"><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>')
var x='<fieldset><legend>Coordinates</legend><label><input type="radio" name="coords" class="logo_ali_map" value="model" '+p+"/>Model "+v+'</label></br><label><input type="radio" name="coords" class="logo_ali_map" value="alignment" '+m+"/>Alignment "+b+"</label></fieldset>"
r.append(x)}var w=i('<div class="logo_controls"></div>')
return t.zoom_enabled&&w.append('<button class="logo_zoomout button">-</button><button class="logo_zoomin button">+</button>'),r.children().length>0&&(w.append('<button class="logo_settings_switch button">Settings</button>'),w.append(r)),n.append(w),n}},{jbone:126}],116:[function(t,e,n){e.exports=function(t,e){e=e||{},this.value=t,this.width=parseInt(e.width,10)||100,"W"===this.value&&(this.width+=30*this.width/100),this.height=parseInt(e.height,10)||100,this.color=e.color||"#000000",this.fontSize=e.fontSize||138,this.scaled=function(){},this.draw=function(t,e,n,i,r,o){var s=e/this.height,a=n/this.width,l=t.font
t.transform(a,0,0,s,i,r),t.fillStyle=o||this.color,t.textAlign="center",t.font="bold "+this.fontSize+"px Arial",t.fillText(this.value,0,0),t.setTransform(1,0,0,1,0,0),t.fillStyle="#000000",t.font=l}}},{}],117:[function(t,e,n){e.exports=function(t,e,n){t.beginPath(),t.moveTo(0,e),t.lineTo(n,e),t.lineWidth=1,t.strokeStyle="#999999",t.stroke()}},{}],118:[function(t,e,n){e.exports=function(t,e,n,i,r,o,s){t.font=o+"px Arial",t.textAlign=s?"right":"center",t.fillStyle="#666666",t.fillText(r,e+i/2,n)}},{}],119:[function(t,e,n){e.exports=function(t,e,n,i,r){r=r||"#999999",t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+i),t.lineWidth=1,t.strokeStyle=r,t.stroke()}},{}],120:[function(t,e,n){function i(t,e,n,i,r){var o=s(t).find("#canv_"+i)
return o.length||(s(t).append('<canvas class="canvas_logo" id="canv_'+i+'"  height="'+e+'" width="'+n+'" style="left:'+r*i+'px"></canvas>'),o=s(t).find("#canv_"+i)),s(o).attr("width",n).attr("height",e),o[0]}var r=t("./render_with_text.js"),o=t("./render_with_rects.js"),s=t("jbone")
e.exports=function(t){if(this.data){t=t||{}
var e=t.zoom||this.zoom,n=t.target||1,s=(t.scaled||null,this.dom_element.parent().attr("width")),a=1,l=null,h=null,c=0
if(this.previous_target=n,t.start&&(this.start=t.start),t.end&&(this.end=t.end),.1>=e?e=.1:e>=1&&(e=1),this.zoom=e,l=this.end||this.data.heightArr.length,h=this.start||1,l=l>this.data.heightArr.length?this.data.heightArr.length:l,l=h>l?h:l,h=h>l?l:h,h=h>1?h:1,this.y=this.height-20,this.max_width=this.column_width*(l-h+1),s>this.max_width&&(e=1,this.zoom_enabled=!1),this.zoom=e,this.zoomed_column=this.column_width*e,this.total_width=this.zoomed_column*(l-h+1),1>e)for(;this.total_width<s&&(this.zoom+=.1,this.zoomed_column=this.column_width*this.zoom,this.total_width=this.zoomed_column*(l-h+1),this.zoom_enabled=!1,!(e>=1)););n>this.total_width&&(n=this.total_width),this.dom_element.attr({width:this.total_width+"px"}).css({width:this.total_width+"px"}),this.canvas_width=this.total_width
var u=Math.ceil(this.total_width/this.canvas_width)
for(this.columns_per_canvas=Math.ceil(this.canvas_width/this.zoomed_column),this.previous_zoom!==this.zoom&&(this.dom_element.find("canvas").remove(),this.previous_zoom=this.zoom,this.rendered=[]),this.canvases=[],this.contexts=[],c=0;u>c;c++){var d=this.columns_per_canvas*c+h,f=d+this.columns_per_canvas-1
f>l&&(f=l)
var g=(f-d+1)*this.zoomed_column
g>a&&(a=g)
var p=a*c,m=p+g
if(m+m/2>n&&n>p-p/2)if(this.canvases[c]=i(this.dom_element,this.height,g,c,a),this.contexts[c]=this.canvases[c].getContext("2d"),this.contexts[c].setTransform(1,0,0,1,0,0),this.contexts[c].clearRect(0,0,g,this.height),this.contexts[c].fillStyle="#ffffff",this.contexts[c].fillRect(0,0,m,this.height),this.zoomed_column>12){var v=parseInt(10*e,10)
v=v>10?10:v,this.debug&&o.call(this,d,f,c,1),r.call(this,d,f,c,v)}else o.call(this,d,f,c)}!this.scrollme&&this.options.scroller&&(this.scrollme=new EasyScroller(this.dom_element[0],{scrollingX:1,scrollingY:0,eventTarget:this.called_on})),1!==n&&this.scrollme.reflow()}}},{"./render_with_rects.js":121,"./render_with_text.js":122,jbone:126}],121:[function(t,e,n){function i(t,e,n,i,r,o,s,a){var l="#ffffff"
a?(r>.1?l="#d7301f":r>.05?l="#fc8d59":r>.03&&(l="#fdcc8a"),t.fillStyle=l,t.fillRect(e,n+15,i,10),l="#ffffff",o>9?l="#d7301f":o>7?l="#fc8d59":o>4&&(l="#fdcc8a"),t.fillStyle=l,t.fillRect(e,n+30,i,10)):n+=30,l="#ffffff",.75>s?l="#2171b5":.85>s?l="#6baed6":.95>s&&(l="#bdd7e7"),t.fillStyle=l,t.fillRect(e,n,i,10)}var r=t("./draw/border.js"),o=t("./draw/ticks.js"),s=t("./draw/column_number.js")
e.exports=function(t,e,n,a){var l=0,h=t,c=null,u=0,d=Math.abs(this.data.max_height),f=Math.abs(this.data.min_height_obs),g=d+f,p=Math.round(100*Math.abs(this.data.max_height)/g),m=Math.round(this.info_content_height*p/100),v=(this.info_content_height-m,10)
for(u=t;e>=u;u++){if(this.data.mmline&&1===this.data.mmline[u-1])this.contexts[n].fillStyle="#cccccc",this.contexts[n].fillRect(l,10,this.zoomed_column,this.height-40)
else{var b=this.data.heightArr[u-1],x=0,w=(b.length,0)
for(var w in b)if(values=[w,b[w]],values[1]>.01){var y=parseFloat(values[1])/this.data.max_height,_=l,S=(this.info_content_height-2)*y,k=this.info_content_height-2-x-S,C=null
C="dynamic"===this.colorscheme?this.colors.getColor(values[0],{pos:u-1}):"consensus"===this.colorscheme?this.cmap[u-1][values[0]]||"#7a7a7a":this.colors[values[0]],a?(this.contexts[n].strokeStyle=C,this.contexts[n].strokeRect(_,k,this.zoomed_column,S)):(this.contexts[n].fillStyle=C,this.contexts[n].fillRect(_,k,this.zoomed_column,S)),x+=S}}this.zoom<.2?v=20:this.zoom<.3&&(v=10),this.options.positionMarker&&u%v===0&&(this.options.show_probs&&o(this.contexts[n],l+this.zoomed_column,this.height-30,parseFloat(this.height),"#dddddd"),o(this.contexts[n],l+this.zoomed_column,0,5),c=this.display_ali_map?this.data.ali_map[u-1]:h,s(this.contexts[n],l-2,10,this.zoomed_column,c,10,!0)),this.options.show_probs&&i(this.contexts[n],l,this.height-42,this.zoomed_column,this.data.insert_probs[u-1],this.data.insert_lengths[u-1],this.data.delete_probs[u-1],this.show_inserts),this.options.show_probs&&(this.show_inserts?r(this.contexts[n],this.height-45,this.total_width):r(this.contexts[n],this.height-15,this.total_width)),this.options.border&&r(this.contexts[n],0,this.total_width),l+=this.zoomed_column,h++}}},{"./draw/border.js":117,"./draw/column_number.js":118,"./draw/ticks.js":119}],122:[function(t,e,n){function i(t,e,n,i,o,s,a){var l=n-4,h="#ffffff",c="#555555"
a&&(l=n-35),.75>o?(h="#2171b5",c="#ffffff"):.85>o?h="#6baed6":.95>o&&(h="#bdd7e7"),r(t,e,l,o,s,i,h,c)}function r(t,e,n,i,r,o,s,a){t.font=r+"px Arial",t.fillStyle=s,t.fillRect(e,n-10,o,14),t.textAlign="center",t.fillStyle=a,t.fillText(i,e+o/2,n)}function o(t,e){var n=e.ralign?e.x+t.zoomed_column:e.x,i=e.ralign?e.x+2:e.x
h(t.contexts[e.context_num],n,t.height-30,-30-t.height,"#dddddd"),h(t.contexts[e.context_num],n,0,5),c(t.contexts[e.context_num],i,10,t.zoomed_column,e.column_num,e.fontsize,e.ralign)}function s(t,e,n,i,o,s){var a=n-20,l="#ffffff",c="#555555"
o>.1?(l="#d7301f",c="#ffffff"):o>.05?l="#fc8d59":o>.03&&(l="#fdcc8a"),r(t,e,a,o,s,i,l,c),o>.03&&h(t,e+i,n-30,-30-n,l)}function a(t,e,n,i,o,s){var a="#ffffff",l="#555555"
o>9?(a="#d7301f",l="#ffffff"):o>7?a="#fc8d59":o>4&&(a="#fdcc8a"),r(t,e,n,o,s,i,a,l)}var l=t("./draw/border.js"),h=t("./draw/ticks.js"),c=t("./draw/column_number.js")
e.exports=function(t,e,n,r){var c=0,u=t,d=null,f=0,g=Math.abs(this.data.max_height),p=isNaN(this.data.min_height_obs)?0:parseInt(this.data.min_height_obs,10),m=g+Math.abs(p),v=Math.round(100*Math.abs(this.data.max_height)/m),b=Math.round(this.info_content_height*v/100),x=this.info_content_height-b
b/this.info_content_height,x/this.info_content_height
for(e+3<=this.end&&(e+=3),f=t;e>=f;f++){if(this.data.mmline&&1===this.data.mmline[f-1])this.contexts[n].fillStyle="#cccccc",this.contexts[n].fillRect(c,10,this.zoomed_column,this.height-40)
else{var w=this.data.heightArr[f-1],y=[]
if(w){var _=0,S=(w.length,0),k=null
for(var S in w){var C=w[S],E=[S,C]
if(x_pos=c+this.zoomed_column/2,letter_height=null,E[1]>.01){letter_height=parseFloat(E[1])/this.data.max_height
var z=this.info_content_height-2-_,j=(this.info_content_height-2)*letter_height
y[S]=[j,this.zoomed_column,x_pos,z],_+=j}}for(var S in w)y[S]&&this.letters[S]&&(k="dynamic"===this.colorscheme?this.colors.getColor(S,{pos:f-1}):"consensus"===this.colorscheme?this.cmap[f-1][S]||"#7a7a7a":null,this.letters[S].draw(this.contexts[n],y[S][0],y[S][1],y[S][2],y[S][3],k))}}d=this.display_ali_map?this.data.ali_map[f-1]:u,this.options.show_divider&&(this.zoom<.7?f%this.options.divider_step===0&&o(this,{context_num:n,x:c,fontsize:10,column_num:d,ralign:!0}):o(this,{context_num:n,x:c,fontsize:r,column_num:d})),this.options.show_probs&&(i(this.contexts[n],c,this.height,this.zoomed_column,this.data.delete_probs[f-1],r,this.show_inserts),h(this.contexts[n],c,this.height-15,5),this.show_inserts&&(s(this.contexts[n],c,this.height,this.zoomed_column,this.data.insert_probs[f-1],r),a(this.contexts[n],c,this.height-5,this.zoomed_column,this.data.insert_lengths[f-1],r),h(this.contexts[n],c,this.height-45,5),h(this.contexts[n],c,this.height-30,5))),c+=this.zoomed_column,u++}this.options.show_probs&&(this.show_inserts&&(l(this.contexts[n],this.height-30,this.total_width),l(this.contexts[n],this.height-45,this.total_width)),l(this.contexts[n],this.height-15,this.total_width)),this.options.border&&l(this.contexts[n],0,this.total_width)}},{"./draw/border.js":117,"./draw/column_number.js":118,"./draw/ticks.js":119}],123:[function(t,e,n){var i=window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype,r=window.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),o=r&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),s=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,a=(r||s)&&window.atob&&window.ArrayBuffer&&window.Uint8Array&&function(t){var e,n,i,a,l,h
for(e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),n=new ArrayBuffer(e.length),i=new Uint8Array(n),a=0;a<e.length;a+=1)i[a]=e.charCodeAt(a)
return l=t.split(",")[0].split(":")[1].split(";")[0],r?new Blob([o?i:n],{type:l}):(h=new s,h.append(n),h.getBlob(l))}
window.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(t,e,n){t(n&&i.toDataURL&&a?a(this.toDataURL(e,n)):this.mozGetAsFile("blob",e))}:i.toDataURL&&a&&(i.toBlob=function(t,e,n){t(a(this.toDataURL(e,n)))})),e.exports=a},{}],124:[function(t,e,n){var i=i||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(t){"use strict"
if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r=!t.externalHost&&"download"in i,o=function(n){var i=e.createEvent("MouseEvents")
i.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)},s=t.webkitRequestFileSystem,a=t.requestFileSystem||s||t.mozRequestFileSystem,l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},h="application/octet-stream",c=0,u=[],d=function(){for(var t=u.length;t--;){var e=u[t]
"string"==typeof e?n().revokeObjectURL(e):e.remove()}u.length=0},f=function(t,e,n){e=[].concat(e)
for(var i=e.length;i--;){var r=t["on"+e[i]]
if("function"==typeof r)try{r.call(t,n||t)}catch(o){l(o)}}},g=function(e,l){var d,g,p,m=this,v=e.type,b=!1,x=function(){var t=n().createObjectURL(e)
return u.push(t),t},w=function(){f(m,"writestart progress write writeend".split(" "))},y=function(){!b&&d||(d=x(e)),g?g.location.href=d:window.open(d,"_blank"),m.readyState=m.DONE,w()},_=function(t){return function(){return m.readyState!==m.DONE?t.apply(this,arguments):void 0}},S={create:!0,exclusive:!1}
return m.readyState=m.INIT,l||(l="download"),r?(d=x(e),i.href=d,i.download=l,o(i),m.readyState=m.DONE,void w()):(t.chrome&&v&&v!==h&&(p=e.slice||e.webkitSlice,e=p.call(e,0,e.size,h),b=!0),s&&"download"!==l&&(l+=".download"),(v===h||s)&&(g=t),a?(c+=e.size,void a(t.TEMPORARY,c,_(function(t){t.root.getDirectory("saved",S,_(function(t){var n=function(){t.getFile(l,S,_(function(t){t.createWriter(_(function(n){n.onwriteend=function(e){g.location.href=t.toURL(),u.push(t),m.readyState=m.DONE,f(m,"writeend",e)},n.onerror=function(){var t=n.error
t.code!==t.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=m["on"+t]}),n.write(e),m.abort=function(){n.abort(),m.readyState=m.DONE},m.readyState=m.WRITING}),y)}),y)}
t.getFile(l,{create:!1},_(function(t){t.remove(),n()}),_(function(t){t.code===t.NOT_FOUND_ERR?n():y()}))}),y)}),y)):void y())},p=g.prototype,m=function(t,e){return new g(t,e)}
return p.abort=function(){var t=this
t.readyState=t.DONE,f(t,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,t.addEventListener("unload",d,!1),m.unload=function(){d(),t.removeEventListener("unload",d,!1)},m}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content)
amdDefine=window.define,"undefined"==typeof amdDefine&&"undefined"!=typeof window.almond&&"define"in window.almond&&(amdDefine=window.almond.define),"undefined"!=typeof e&&null!==e?e.exports=i:"undefined"!=typeof amdDefine&&null!==amdDefine&&null!=amdDefine.amd&&amdDefine("saveAs",[],function(){return i})},{}],125:[function(t,e,n){var i={}
i.removeToInsertLater=function(t){var e,n
return n=t.parentNode,e=t.nextSibling,n.removeChild(t),function(){e?n.insertBefore(t,e):n.appendChild(t)}},i.removeAllChilds=function(t){var e
for(e=0;t.firstChild;)e++,t.removeChild(t.firstChild)},e.exports=i},{}],126:[function(t,e,n){!function(t){function n(e){var n=e.length,i=typeof e
return p(i)||e===t?!1:1===e.nodeType&&n?!0:m(i)||0===n||"number"==typeof n&&n>0&&n-1 in e}function i(t,e){var n,i
this.originalEvent=t,i=function(t,e){"preventDefault"===t?this[t]=function(){return this.defaultPrevented=!0,e[t]()}:"stopImmediatePropagation"===t?this[t]=function(){return this.immediatePropagationStopped=!0,e[t]()}:p(e[t])?this[t]=function(){return e[t]()}:this[t]=e[t]}
for(n in t)(t[n]||"function"==typeof t[n])&&i.call(this,n,t)
v.extend(this,e,{isImmediatePropagationStopped:function(){return!!this.immediatePropagationStopped}})}var r,o=t.$,s=t.jBone,a=/^<(\w+)\s*\/?>$/,l=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,h=[].slice,c=[].splice,u=Object.keys,d=document,f=function(t){return"string"==typeof t},g=function(t){return t instanceof Object},p=function(t){return"[object Function]"==={}.toString.call(t)},m=function(t){return Array.isArray(t)},v=function(t,e){return new r.init(t,e)}
v.noConflict=function(){return t.$=o,t.jBone=s,v},r=v.fn=v.prototype={init:function(t,e){var n,i,r,o
if(!t)return this
if(f(t)){if(i=a.exec(t))return this[0]=d.createElement(i[1]),this.length=1,g(e)&&this.attr(e),this
if((i=l.exec(t))&&i[1]){for(o=d.createDocumentFragment(),r=d.createElement("div"),r.innerHTML=t;r.lastChild;)o.appendChild(r.firstChild)
return n=h.call(o.childNodes),v.merge(this,n)}if(v.isElement(e))return v(e).find(t)
try{return n=d.querySelectorAll(t),v.merge(this,n)}catch(s){return this}}return t.nodeType?(this[0]=t,this.length=1,this):p(t)?t():t instanceof v?t:v.makeArray(t,this)},pop:[].pop,push:[].push,reverse:[].reverse,shift:[].shift,sort:[].sort,splice:[].splice,slice:[].slice,indexOf:[].indexOf,forEach:[].forEach,unshift:[].unshift,concat:[].concat,join:[].join,every:[].every,some:[].some,filter:[].filter,map:[].map,reduce:[].reduce,reduceRight:[].reduceRight,length:0},r.constructor=v,r.init.prototype=r,v.setId=function(e){var n=e.jid
e===t?n="window":void 0===e.jid&&(e.jid=n=++v._cache.jid),v._cache.events[n]||(v._cache.events[n]={})},v.getData=function(e){e=e instanceof v?e[0]:e
var n=e===t?"window":e.jid
return{jid:n,events:v._cache.events[n]}},v.isElement=function(t){return t&&t instanceof v||t instanceof HTMLElement||f(t)},v._cache={events:{},jid:0},r.pushStack=function(t){var e=v.merge(this.constructor(),t)
return e},v.merge=function(t,e){for(var n=e.length,i=t.length,r=0;n>r;)t[i++]=e[r++]
return t.length=i,t},v.contains=function(t,e){return t.contains(e)},v.extend=function(t){var e
return c.call(arguments,1).forEach(function(n){if(e=t,n)for(var i in n)e[i]=n[i]}),t},v.makeArray=function(t,e){var i=e||[]
return null!==t&&(n(t)?v.merge(i,f(t)?[t]:t):i.push(t)),i},v.unique=function(t){if(null==t)return[]
for(var e=[],n=0,i=t.length;i>n;n++){var r=t[n]
e.indexOf(r)<0&&e.push(r)}return e},v.Event=function(t,e){var n,i
return t.type&&!e&&(e=t,t=t.type),n=t.split(".").splice(1).join("."),i=t.split(".")[0],t=d.createEvent("Event"),t.initEvent(i,!0,!0),v.extend(t,{namespace:n,isDefaultPrevented:function(){return t.defaultPrevented}},e)},v.event={add:function(t,e,n,i,r){v.setId(t)
var o,s,a,l=function(e){v.event.dispatch.call(t,e)},h=v.getData(t).events
for(e=e.split(" "),s=e.length;s--;)a=e[s],o=a.split(".")[0],h[o]=h[o]||[],h[o].length||t.addEventListener&&t.addEventListener(o,l,!1),h[o].push({namespace:a.split(".").splice(1).join("."),fn:l,selector:r,data:i,originfn:n})},remove:function(t,e,n){var i,r,o=function(t,e,i,r,o){var s;(n&&o.originfn===n||!n)&&(s=o.fn),t[e][i].fn===s&&(t[e].splice(i,1),t[e].length||r.removeEventListener(e,s))},s=v.getData(t).events
if(s)return!e&&s?u(s).forEach(function(e){for(r=s[e],i=r.length;i--;)o(s,e,i,t,r[i])}):void e.split(" ").forEach(function(e){var n,a=e.split(".")[0],l=e.split(".").splice(1).join(".")
if(s[a])for(r=s[a],i=r.length;i--;)n=r[i],(!l||l&&n.namespace===l)&&o(s,a,i,t,n)
else l&&u(s).forEach(function(e){for(r=s[e],i=r.length;i--;)n=r[i],n.namespace.split(".")[0]===l.split(".")[0]&&o(s,e,i,t,n)})})},trigger:function(t,e){var n=[]
f(e)?n=e.split(" ").map(function(t){return v.Event(t)}):(e=e instanceof Event?e:v.Event(e),n=[e]),n.forEach(function(e){e.type&&t.dispatchEvent&&t.dispatchEvent(e)})},dispatch:function(t){for(var e,n,r,o,s,a=0,l=0,h=this,c=v.getData(h).events[t.type],u=c.length,d=[],f=[];u>a;a++)d.push(c[a])
for(a=0,u=d.length;u>a&&~c.indexOf(d[a])&&(!o||!o.isImmediatePropagationStopped());a++)if(n=null,s={},r=d[a],r.data&&(s.data=r.data),r.selector){if(~(f=v(h).find(r.selector)).indexOf(t.target)&&(n=t.target)||h!==t.target&&h.contains(t.target)){if(!n)for(e=f.length,l=0;e>l;l++)f[l]&&f[l].contains(t.target)&&(n=f[l])
if(!n)continue
s.currentTarget=n,o=new i(t,s),t.namespace&&t.namespace!==r.namespace||r.originfn.call(n,o)}}else o=new i(t,s),t.namespace&&t.namespace!==r.namespace||r.originfn.call(h,o)}},r.on=function(t,e,n,i){var r=this.length,o=0
if(null==n&&null==i?(i=e,n=e=void 0):null==i&&("string"==typeof e?(i=n,n=void 0):(i=n,n=e,e=void 0)),!i)return this
for(;r>o;o++)v.event.add(this[o],t,i,n,e)
return this},r.one=function(t){var e,n=arguments,i=0,r=this.length,o=h.call(n,1,n.length-1),s=h.call(n,-1)[0]
for(e=function(e){var n=v(e)
t.split(" ").forEach(function(t){var i=function(r){n.off(t,i),s.call(e,r)}
n.on.apply(n,[t].concat(o,i))})};r>i;i++)e(this[i])
return this},r.trigger=function(t){var e=0,n=this.length
if(!t)return this
for(;n>e;e++)v.event.trigger(this[e],t)
return this},r.off=function(t,e){for(var n=0,i=this.length;i>n;n++)v.event.remove(this[n],t,e)
return this},r.find=function(t){for(var e=[],n=0,i=this.length,r=function(n){p(n.querySelectorAll)&&[].forEach.call(n.querySelectorAll(t),function(t){e.push(t)})};i>n;n++)r(this[n])
return v(e)},r.get=function(t){return null!=t?0>t?this[t+this.length]:this[t]:h.call(this)},r.eq=function(t){return v(this[t])},r.parent=function(){for(var t,e=[],n=0,i=this.length;i>n;n++)!~e.indexOf(t=this[n].parentElement)&&t&&e.push(t)
return v(e)},r.toArray=function(){return h.call(this)},r.is=function(){var t=arguments
return this.some(function(e){return e.tagName.toLowerCase()===t[0]})},r.has=function(){var t=arguments
return this.some(function(e){return e.querySelectorAll(t[0]).length})},r.add=function(t,e){return this.pushStack(v.unique(v.merge(this.get(),v(t,e))))},r.attr=function(t,e){var n,i=arguments,r=0,o=this.length
if(f(t)&&1===i.length)return this[0]&&this[0].getAttribute(t)
for(2===i.length?n=function(n){n.setAttribute(t,e)}:g(t)&&(n=function(e){u(t).forEach(function(n){e.setAttribute(n,t[n])})});o>r;r++)n(this[r])
return this},r.removeAttr=function(t){for(var e=0,n=this.length;n>e;e++)this[e].removeAttribute(t)
return this},r.val=function(t){var e=0,n=this.length
if(0===arguments.length)return this[0]&&this[0].value
for(;n>e;e++)this[e].value=t
return this},r.css=function(e,n){var i,r=arguments,o=0,s=this.length
if(f(e)&&1===r.length)return this[0]&&t.getComputedStyle(this[0])[e]
for(2===r.length?i=function(t){t.style[e]=n}:g(e)&&(i=function(t){u(e).forEach(function(n){t.style[n]=e[n]})});s>o;o++)i(this[o])
return this},r.data=function(t,e){var n,i=arguments,r={},o=0,s=this.length,a=function(t,e,n){g(n)?(t.jdata=t.jdata||{},t.jdata[e]=n):t.dataset[e]=n},l=function(t){return"true"===t?!0:"false"===t?!1:t}
if(0===i.length)return this[0].jdata&&(r=this[0].jdata),u(this[0].dataset).forEach(function(t){r[t]=l(this[0].dataset[t])},this),r
if(1===i.length&&f(t))return this[0]&&l(this[0].dataset[t]||this[0].jdata&&this[0].jdata[t])
for(1===i.length&&g(t)?n=function(e){u(t).forEach(function(n){a(e,n,t[n])})}:2===i.length&&(n=function(n){a(n,t,e)});s>o;o++)n(this[o])
return this},r.removeData=function(t){for(var e,n,i=0,r=this.length;r>i;i++)if(e=this[i].jdata,n=this[i].dataset,t)e&&e[t]&&delete e[t],delete n[t]
else{for(t in e)delete e[t]
for(t in n)delete n[t]}return this},r.addClass=function(t){for(var e=0,n=0,i=this.length,r=t?t.trim().split(/\s+/):[];i>e;e++)for(n=0,n=0;n<r.length;n++)this[e].classList.add(r[n])
return this},r.removeClass=function(t){for(var e=0,n=0,i=this.length,r=t?t.trim().split(/\s+/):[];i>e;e++)for(n=0,n=0;n<r.length;n++)this[e].classList.remove(r[n])
return this},r.toggleClass=function(t,e){var n=0,i=this.length,r="toggle"
if(e===!0&&(r="add")||e===!1&&(r="remove"),t)for(;i>n;n++)this[n].classList[r](t)
return this},r.hasClass=function(t){var e=0,n=this.length
if(t)for(;n>e;e++)if(this[e].classList.contains(t))return!0
return!1},r.html=function(t){var e,n=arguments
return 1===n.length&&void 0!==t?this.empty().append(t):0===n.length&&(e=this[0])?e.innerHTML:this},r.append=function(t){var e,n=0,i=this.length
for(f(t)&&l.exec(t)?t=v(t):g(t)||(t=document.createTextNode(t)),t=t instanceof v?t:v(t),e=function(e,n){t.forEach(function(t){n?e.appendChild(t.cloneNode(!0)):e.appendChild(t)})};i>n;n++)e(this[n],n)
return this},r.appendTo=function(t){return v(t).append(this),this},r.empty=function(){for(var t,e=0,n=this.length;n>e;e++)for(t=this[e];t.lastChild;)t.removeChild(t.lastChild)
return this},r.remove=function(){var t,e=0,n=this.length
for(this.off();n>e;e++)t=this[e],delete t.jdata,t.parentNode&&t.parentNode.removeChild(t)
return this},"object"==typeof e&&e&&"object"==typeof e.exports?e.exports=v:"function"==typeof define&&define.amd?(define(function(){return v}),t.jBone=t.$=v):"object"==typeof t&&"object"==typeof t.document&&(t.jBone=t.$=v)}(window)},{}],127:[function(t,e,n){var i={}
i.d=i.defaultValue=function(t,e){return void 0===t?"function"==typeof t?e():e:t},i.id=function(t){return document.getElementById(t)},i.mk=function(t){return document.createElement(t)},void 0!==e&&void 0!==e.exports&&(e.exports=i)},{}],128:[function(t,e,n){e.exports=t("./lib/menubuilder")},{"./lib/menubuilder":129}],129:[function(t,e,n){var i,r,o
r=t("jbone"),o=t("backbone-viewj"),e.exports=i=o.extend({initialize:function(t){this._nodes=[],this.name=t.name||"",this.el.className+="smenubar"},render:function(){for(var t=this.el.firstChild;t;)this.el.removeChild(t),t=this.el.firstChild
this.el.appendChild(this.buildDOM())},setName:function(t){this.name=t},addNode:function(t,e,n){var i
null!=n&&(i=n.style),null==this._nodes&&(this._nodes=[]),this._nodes.push({label:t,callback:e,style:i})},getNode:function(t){var e=void 0
return this._nodes.forEach(function(n){n.label===t&&(e=n)}),e},modifyNode:function(t,e,n){var i=this.getNode(t)
i.callback=e||i.callback,n=n||{},i.style=n.style||i.style},renameNode:function(t,e){var n=this.getNode(t)
n.label=e||n.label},removeNode:function(t){var e=this.getNode(t)
this._nodes.splice(this._nodes.indexOf(e),1)},removeAllNodes:function(){this._nodes=[]},buildDOM:function(){var t=document.createElement("span")
return t.appendChild(this._buildM({nodes:this._nodes,name:this.name})),t},_buildM:function(t){var e,n,i,o,s,a,l,h=t.nodes,c=t.name,u=document.createElement("div")
u.className="smenu-dropdown smenu-dropdown-tip",u.style.display="none"
var d=document.createElement("ul")
d.className="smenu-dropdown-menu"
for(var f=0,g=h.length;g>f;f++){s=h[f],o=document.createElement("li"),o.textContent=s.label,l=s.style
for(i in l)a=l[i],o.style[i]=a
o.addEventListener("click",s.callback),this.trigger("new:node",o),d.appendChild(o)}return this.trigger("new:menu",d),u.appendChild(d),e=document.createElement("a"),e.textContent=c,e.className="smenubar_alink",this.trigger("new:button",e),r(e).on("click",function(t){return function(n){return t._showMenu(n,u,e),window.setTimeout(function(){return r(document.body).one("click",function(t){return u.style.display="none"})},5)}}(this)),n=document.createDocumentFragment(),n.appendChild(u),n.appendChild(e),n},_showMenu:function(t,e,n){var i
e.style.display="block",e.style.position="absolute",i=n.getBoundingClientRect(),e.style.left=i.left+"px",e.style.top=i.top+n.offsetHeight+"px"}})},{"backbone-viewj":67,jbone:126}],130:[function(t,e,n){var i
e.exports=i={rel:function(t){var e,n,i,r
return e=t.offsetX,n=t.offsetY,void 0==e&&(i=r.getBoundingClientRect(),r=t.target||t.srcElement,void 0==e&&(e=t.clientX-i.left,n=t.clientY-i.top),void 0==e&&(e=t.pageX-r.offsetLeft,n=t.pageY-r.offsetTop),void 0==e)?void console.log(t,"no mouse event defined. your browser sucks"):[e,n]},abs:function(t){var e,n
return e=t.pageX,n=t.pageY,void 0==e&&(e=t.layerX,n=t.layerY),void 0==e&&(e=t.clientX,n=t.clientY),void 0==e&&(e=t.x,n=t.y),[e,n]},wheelDelta:function(t){var e
return e=[t.deltaX,t.deltaY],void 0==e[0]&&t.mozMovementX&&(e=[0,t.mozMovementX]),isNaN(e[0])&&(e[0]=0),isNaN(e[1])&&(e[1]=0),e}}},{}],131:[function(t,e,n){e.exports={A:"#00a35c",R:"#00fc03",N:"#00eb14",D:"#00eb14",C:"#0000ff",Q:"#00f10e",E:"#00f10e",G:"#009d62",H:"#00d52a",I:"#0054ab",L:"#007b84",K:"#00ff00",M:"#009768",F:"#008778",P:"#00e01f",S:"#00d52a",T:"#00db24",W:"#00a857",Y:"#00e619",V:"#005fa0",B:"#00eb14",X:"#00b649",Z:"#00f10e"}},{}],132:[function(t,e,n){e.exports={A:"#BBBBBB",B:"grey",C:"yellow",D:"red",E:"red",F:"magenta",G:"brown",H:"#00FFFF",I:"#BBBBBB",J:"#fff",K:"#00FFFF",L:"#BBBBBB",M:"#BBBBBB",N:"green",O:"#fff",P:"brown",Q:"green",R:"#00FFFF",S:"green",T:"green",U:"#fff",V:"#BBBBBB",W:"magenta",X:"grey",Y:"magenta",Z:"grey",Gap:"grey"}},{}],133:[function(t,e,n){e.exports={A:"orange",B:"#fff",C:"green",D:"red",E:"red",F:"blue",G:"orange",H:"red",I:"green",J:"#fff",K:"red",L:"green",M:"green",N:"#fff",O:"#fff",P:"orange",Q:"#fff",R:"red",S:"orange",T:"orange",U:"#fff",V:"green",W:"blue",X:"#fff",Y:"blue",Z:"#fff",Gap:"#fff"}},{}],134:[function(t,e,n){e.exports={A:"#80a0f0",R:"#f01505",N:"#00ff00",D:"#c048c0",C:"#f08080",Q:"#00ff00",E:"#c048c0",G:"#f09048",H:"#15a4a4",I:"#80a0f0",L:"#80a0f0",K:"#f01505",M:"#80a0f0",F:"#80a0f0",P:"#ffff00",S:"#00ff00",T:"#00ff00",W:"#80a0f0",Y:"#15a4a4",V:"#80a0f0",B:"#fff",X:"#fff",Z:"#fff"}},{}],135:[function(t,e,n){e.exports={A:"#e718e7",R:"#6f906f",N:"#1be41b",D:"#778877",C:"#23dc23",Q:"#926d92",E:"#ff00ff",G:"#00ff00",H:"#758a75",I:"#8a758a",L:"#ae51ae",K:"#a05fa0",M:"#ef10ef",F:"#986798",P:"#00ff00",S:"#36c936",T:"#47b847",W:"#8a758a",Y:"#21de21",V:"#857a85",B:"#49b649",X:"#758a75",Z:"#c936c9"}},{}],136:[function(t,e,n){e.exports={A:"#ad0052",B:"#0c00f3",C:"#c2003d",D:"#0c00f3",E:"#0c00f3",F:"#cb0034",G:"#6a0095",H:"#1500ea",I:"#ff0000",J:"#fff",K:"#0000ff",L:"#ea0015",M:"#b0004f",N:"#0c00f3",O:"#fff",P:"#4600b9",Q:"#0c00f3",R:"#0000ff",S:"#5e00a1",T:"#61009e",U:"#fff",V:"#f60009",W:"#5b00a4",X:"#680097",Y:"#4f00b0",Z:"#0c00f3"}},{}],137:[function(t,e,n){function i(t){if(null==t||"object"!=typeof t)return t
var e=t.constructor()
for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
return e}var r=t("./schemeclass"),o=r.stat,s=r.dyn,a=t("./buried"),l=t("./cinema"),h=t("./clustal"),c=t("./clustal2"),u=t("./helix"),d=t("./hydrophobicity"),f=t("./lesk"),g=t("./mae"),p=t("./nucleotide"),m=t("./purine"),v=t("./strand"),b=t("./taylor"),x=t("./turn"),w=t("./zappo"),y={buried:a,buried_index:a,cinema:l,clustal2:c,clustal:h,helix:u,helix_propensity:u,hydro:d,lesk:f,mae:g,nucleotide:p,purine:m,purine_pyrimidine:m,strand:v,strand_propensity:v,taylor:b,turn:x,turn_propensity:x,zappo:w},_=t("./pid_colors.js"),S={pid:_}
e.exports=Colors=function(t){this.maps=i(y),this.dyn=i(S),this.opt=t},Colors.getScheme=function(t){return y[t]},Colors.prototype.getScheme=function(t){var e=this.maps[t]
return void 0===e&&(e={},void 0!=this.dyn[t])?new s(this.dyn[t],this.opt):new o(e)},Colors.prototype.addStaticScheme=function(t,e){this.maps[t]=e},Colors.prototype.addDynScheme=function(t,e){this.dyn[t]=e}},{"./buried":131,"./cinema":132,"./clustal":133,"./clustal2":134,"./helix":135,"./hydrophobicity":136,"./lesk":138,"./mae":139,"./nucleotide":140,"./pid_colors.js":141,"./purine":142,"./schemeclass":143,"./strand":144,"./taylor":145,"./turn":146,"./zappo":147}],138:[function(t,e,n){e.exports={A:" orange",B:" #fff",C:" green",D:" red",E:" red",F:" green",G:" orange",H:" magenta",I:" green",J:" #fff",K:" red",L:" green",M:" green",N:" magenta",O:" #fff",P:" green",Q:" magenta",R:" red",S:" orange",T:" orange",U:" #fff",V:" green",W:" green",X:" #fff",Y:" green",Z:" #fff",Gap:" #fff"}},{}],139:[function(t,e,n){e.exports={A:" #77dd88",B:" #fff",C:" #99ee66",D:" #55bb33",E:" #55bb33",F:" #9999ff",G:" #77dd88",H:" #5555ff",I:" #66bbff",J:" #fff",K:" #ffcc77",L:" #66bbff",M:" #66bbff",N:" #55bb33",O:" #fff",P:" #eeaaaa",Q:" #55bb33",R:" #ffcc77",S:" #ff4455",T:" #ff4455",U:" #fff",V:" #66bbff",W:" #9999ff",X:" #fff",Y:" #9999ff",Z:" #fff",Gap:" #fff"}},{}],140:[function(t,e,n){e.exports={A:" #64F73F",C:" #FFB340",G:" #EB413C",T:" #3C88EE",U:" #3C88EE"}},{}],141:[function(t,e,n){var i
e.exports=i={},i.init=function(){this.cons=this.opt.conservation()},i.run=function(t,e){var n=this.cons[e.pos]
return n>.8?"#6464ff":n>.6?"#9da5ff":n>.4?"#cccccc":"#ffffff"}},{}],142:[function(t,e,n){e.exports={A:" #FF83FA",C:" #40E0D0",G:" #FF83FA",R:" #FF83FA",T:" #40E0D0",U:" #40E0D0",Y:" #40E0D0"}},{}],143:[function(t,e,n){var i=function(t){this.defaultColor="#ffffff",this.type="static",this.map=t,this.getColor=function(t){return void 0!==this.map[t]?this.map[t]:this.defaultColor}},r=function(t,e){this.type="dyn",this.opt=e,void 0!==t.init?(t.init.call(this),this.getColor=t.run,this.reset=t.init):this.getColor=t}
e.exports.stat=i,e.exports.dyn=r},{}],144:[function(t,e,n){e.exports={A:"#5858a7",R:"#6b6b94",N:"#64649b",D:"#2121de",C:"#9d9d62",Q:"#8c8c73",E:"#0000ff",G:"#4949b6",H:"#60609f",I:"#ecec13",L:"#b2b24d",K:"#4747b8",M:"#82827d",F:"#c2c23d",P:"#2323dc",S:"#4949b6",T:"#9d9d62",W:"#c0c03f",Y:"#d3d32c",V:"#ffff00",B:"#4343bc",X:"#797986",Z:"#4747b8"}},{}],145:[function(t,e,n){e.exports={A:"#ccff00",R:"#0000ff",N:"#cc00ff",D:"#ff0000",C:"#ffff00",Q:"#ff00cc",E:"#ff0066",G:"#ff9900",H:"#0066ff",I:"#66ff00",L:"#33ff00",K:"#6600ff",M:"#00ff00",F:"#00ff66",P:"#ffcc00",S:"#ff3300",T:"#ff6600",W:"#00ccff",Y:"#00ffcc",V:"#99ff00",B:"#fff",X:"#fff",Z:"#fff"}},{}],146:[function(t,e,n){e.exports={A:"#2cd3d3",R:"#708f8f",N:"#ff0000",D:"#e81717",C:"#a85757",Q:"#3fc0c0",E:"#778888",G:"#ff0000",H:"#708f8f",I:"#00ffff",L:"#1ce3e3",K:"#7e8181",M:"#1ee1e1",F:"#1ee1e1",P:"#f60909",S:"#e11e1e",T:"#738c8c",W:"#738c8c",Y:"#9d6262",V:"#07f8f8",B:"#f30c0c",X:"#7c8383",Z:"#5ba4a4"}},{}],147:[function(t,e,n){e.exports={A:"#ffafaf",R:"#6464ff",N:"#00ff00",D:"#ff0000",C:"#ffff00",Q:"#00ff00",E:"#ff0000",G:"#ff00ff",H:"#6464ff",I:"#ffafaf",L:"#ffafaf",K:"#6464ff",M:"#ffafaf",F:"#ffc800",P:"#ff00ff",S:"#00ff00",T:"#00ff00",W:"#ffc800",Y:"#ffc800",V:"#ffafaf",B:"#fff",X:"#fff",Z:"#fff"}},{}],148:[function(t,e,n){var i={}
e.exports=i,i.getMeta=function(t){if(i.contains(t,"|")){for(var e,n,s=t.split("|"),a=0,l={};a<s.length-1;)e=s[a],n=s[a+1],l[e]=n,a+=2
var h=s[s.length-1]
if(h.indexOf("=")>=0&&h.indexOf("OS")>=0){var c={},u=h.split(" ")
c.en=u[0],u=u.splice(1)
var d=r(u,"="),f=u.splice(d-1)
h=u.join(" "),u=f,a=0
var g=[]
return u.forEach(function(t){g.push(t),t.indexOf("=")>=0&&(o(g.join(" "),"=",c),g=[])}),{name:h,ids:l,details:c}}return{name:h,ids:l}}return{name:t}}
var r=function(t,e){for(var n=0;n<t.lenght;n++)if(t[n].indexOf(n))return n
return t.length-1},o=function(t,e,n){n=n||{}
var i=t.split(e)
return n[i[0].toLowerCase()]=i[1],n},s={sp:{link:"http://www.uniprot.org/%s",name:"Uniprot"},tr:{link:"http://www.uniprot.org/%s",name:"Trembl"},gb:{link:"http://www.ncbi.nlm.nih.gov/nuccore/%s",name:"Genbank"},pdb:{link:"http://www.rcsb.org/pdb/explore/explore.do?structureId=%s",name:"PDB"}}
i.buildLinks=function(t){var e={}
return t=t||{},Object.keys(t).forEach(function(n){if(n in s){var i=s[n],r=i.link.replace("%s",t[n])
e[i.name]=r}}),e},i.contains=function(t,e){return-1!=="".indexOf.call(t,e,0)},i.splitNChars=function(t,e){var n,i
e=e||80
var r=[]
for(n=0,i=t.length-1;i>=n;n+=e)r.push(t.substr(n,e))
return r},i.reverse=function(t){return t.split("").reverse().join("")},i.complement=function(t){var e=t+"",n=[[/g/g,"0"],[/c/g,"1"],[/0/g,"c"],[/1/g,"g"],[/G/g,"0"],[/C/g,"1"],[/0/g,"C"],[/1/g,"G"],[/a/g,"0"],[/t/g,"1"],[/0/g,"t"],[/1/g,"a"],[/A/g,"0"],[/T/g,"1"],[/0/g,"T"],[/1/g,"A"]]
for(var i in n)e=e.replace(n[i][0],n[i][1])
return e},i.reverseComplement=function(t){return i.reverse(i.complement(t))},i.model=function(t,e,n){this.seq=t,this.name=e,this.id=n,this.ids={}}},{}],149:[function(t,e,n){var i=t("underscore"),r=function(t,e){if(this.constructor!==r)return new r(t)
if(void 0===t||"string"==typeof t)throw new TypeError("you need to give the seq stat an array")
this.resetSeqs(t),this.alphabetSize=4,this._useBackground=!1,this.useGaps=!1,this.ignoredChars=["-","*"],i.extend(this,e)}
r.prototype.addSeq=function(t){this.seqs.push(t),this._reset()},r.prototype.removeSeq=function(t){"number"==typeof t?this.seqs.splice(t,1):i.each(this.seqs,function(e,n){t===e&&this.seqs.splice(n,1)}.bind(this)),this._reset()},r.prototype.addSeqs=function(t){t.forEach(function(t){this.addSeq(t)}.bind(this))},r.prototype.resetSeqs=function(t){if(this.seqs=[],!t instanceof Array||"at"in t){this.mseqs=t
var e=function(){var t=this.mseqs.pluck("seq")
this.resetSeqs(t)}
t.on("add change reset ",e,this),e.call(this)}else this.addSeqs(t),this._reset(),this.trigger("reset")}
var o=["consensus","frequency","maxLength","ic","gaps"]
r.prototype._reset=function(){for(var t=0;t<o.length;t++)this["_"+o[t]]=void 0
this._identity=void 0,this._background=void 0},r.prototype.setBackground=function(t){this._useBackground=t,this._reset()},r.prototype.useBackground=function(){this.setBackground(!0)},r.prototype.setDNA=function(){this.alphabetSize=4},r.prototype.setProtein=function(){this.alphabetSize=20},o.forEach(function(t){r.prototype[t]=function(){return void 0===this["_"+t]&&(this["_"+t]=this[t+"Calc"]()),this["_"+t]}}),r.prototype.identity=function(t){var e
return(void 0===this._identity||t)&&(e=this.identityCalc(t),this._identity=void 0),this._identity||e},r.prototype.background=function(){return void 0!==this.bg?this.bg:(void 0===this._background&&this.backgroundCalc(),this._background)},r.prototype.frequencyCalc=function(t){var e,n
e=new Array(this.maxLength()),n=new Array(this.seqs.length)
var r=this.ignoredChars
return void 0!==t&&t.all&&(r=[]),i.each(this.seqs,function(t){i.each(t,function(t,i){r.indexOf(t)>=0||(void 0===e[i]&&(e[i]={}),void 0===e[i][t]&&(e[i][t]=0),e[i][t]++,void 0===n[i]&&(n[i]=0),n[i]++)})}),i.each(e,function(t,r){return i.each(t,function(t,i){return e[r][i]=t/n[r]})}),this._frequency=e,e},r.prototype.backgroundCalc=function(){var t={},e=0
return i.each(this.seqs,function(n){i.each(n,function(n){return void 0===t[n]&&(t[n]=0),t[n]++,e++})}),t=i.mapValues(t,function(t){return t/e}),this._background=t,t},r.prototype.icCalc=function(){var t=this.frequency()
if(this._useBackground)var e=this.background()
var n=this.ignoredChars,r=this._useBackground,o=i.map(t,function(t){return i.reduce(t,function(t,i,o){return n.indexOf(o)>=0?t:(r&&(i/=e[o]),t-i*(Math.log(i)/Math.log(2)))},0)})
return this._ic=o,o},r.prototype.conservation=function(t){var e=this.ic(),n=this.gaps(),r=this
t=t||this.alphabetSize
var o=Math.log(t)/Math.log(2),s=0,a=i.map(e,function(t){var e=o-t
return r.useGaps&&(e*=1-n[s++]),e})
return a},r.prototype.conservResidue=function(t){var e,n=t?t.alphabetSize:void 0,r=this.ignoredChars
e=void 0!==t&&t.scaled?this.scale(this.conservation(n)):this.conservation(n)
var o,s=this.frequency(),a=i.map(s,function(t,n){o=i.reject(i.keys(t),function(t){return r.indexOf(t)>=0})
var s={}
return i.each(o,function(i){s[i]=t[i]*e[n]}),s})
return a},r.prototype.conservResidue2=function(t){var e=this.frequency(),n=this.conservation(t),r=this.background(),o=i.map(e,function(t,o){return i.map(t,function(t){var s=i.reduce(e[o],function(t,e){return t+e/r[o]},0)
return t/r[o]/s*n[o]},0)})
return o},r.prototype.scale=function(t,e){e=e||this.alphabetSize
var n=Math.log(e)/Math.log(2),r=i.map(t,function(t){return t/n})
return r},r.prototype.maxLengthCalc=function(){return 0===this.seqs.length?0:i.max(this.seqs,function(t){return t.length}).length},r.prototype.consensusCalc=function(){var t=new Array(this.maxLength())
return i.each(this.seqs,function(e){i.each(e,function(e,n){void 0===t[n]&&(t[n]={}),void 0===t[n][e]&&(t[n][e]=0),t[n][e]++})}),this._consensus=i.reduce(t,function(t,e){var n
return n=i.keys(e),t+=i.max(n,function(t){return e[t]})},""),this._consensus},r.prototype.identityCalc=function(t){var e=t||this.consensus()
return this._identity=this.seqs.map(function(t){for(var n=0,i=0,r=0;r<t.length;r++)"-"!==t[r]&&"-"!==e[r]&&(i++,t[r]===e[r]&&n++)
return n/i}),this._identity},r.prototype.gapsCalc=function(){var t=this.maxLength()
if(1>=t||"undefined"==typeof t)return[]
var e=new Array(this.maxLength())
return i.each(this.seqs,function(t){i.each(t,function(t,n){void 0===e[n]&&(e[n]={g:0,t:0}),t="-"===t?"g":"t",e[n][t]++})}),this._gaps=i.map(e,function(t){return t.g/(t.g+t.t)}),this._gaps},i.mixin({mapValues:function(t,e){return i.object(i.keys(t),i.map(t,e))}}),t("biojs-events").mixin(r.prototype),e.exports=r},{"biojs-events":71,underscore:150}],150:[function(t,e,n){(function(){function t(t){function e(e,n,i,r,o,s){for(;o>=0&&s>o;o+=t){var a=r?r[o]:o
i=n(i,e[a],a,e)}return i}return function(n,i,r,o){i=y(i,o,4)
var s=!j(n)&&w.keys(n),a=(s||n).length,l=t>0?0:a-1
return arguments.length<3&&(r=n[s?s[l]:l],l+=t),e(n,i,r,s,l,a)}}function i(t){return function(e,n,i){n=_(n,i)
for(var r=z(e),o=t>0?0:r-1;o>=0&&r>o;o+=t)if(n(e[o],o,e))return o
return-1}}function r(t,e,n){return function(i,r,o){var s=0,a=z(i)
if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1
else if(n&&o&&a)return o=n(i,r),i[o]===r?o:-1
if(r!==r)return o=e(d.call(i,s,a),w.isNaN),o>=0?o+s:-1
for(o=t>0?s:a-1;o>=0&&a>o;o+=t)if(i[o]===r)return o
return-1}}function o(t,e){var n=R.length,i=t.constructor,r=w.isFunction(i)&&i.prototype||h,o="constructor"
for(w.has(t,o)&&!w.contains(e,o)&&e.push(o);n--;)o=R[n],o in t&&t[o]!==r[o]&&!w.contains(e,o)&&e.push(o)}var s=this,a=s._,l=Array.prototype,h=Object.prototype,c=Function.prototype,u=l.push,d=l.slice,f=h.toString,g=h.hasOwnProperty,p=Array.isArray,m=Object.keys,v=c.bind,b=Object.create,x=function(){},w=function(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)}
"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=w),n._=w):s._=w,w.VERSION="1.8.3"
var y=function(t,e,n){if(void 0===e)return t
switch(null==n?3:n){case 1:return function(n){return t.call(e,n)}
case 2:return function(n,i){return t.call(e,n,i)}
case 3:return function(n,i,r){return t.call(e,n,i,r)}
case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return null==t?w.identity:w.isFunction(t)?y(t,e,n):w.isObject(t)?w.matcher(t):w.property(t)}
w.iteratee=function(t,e){return _(t,e,1/0)}
var S=function(t,e){return function(n){var i=arguments.length
if(2>i||null==n)return n
for(var r=1;i>r;r++)for(var o=arguments[r],s=t(o),a=s.length,l=0;a>l;l++){var h=s[l]
e&&void 0!==n[h]||(n[h]=o[h])}return n}},k=function(t){if(!w.isObject(t))return{}
if(b)return b(t)
x.prototype=t
var e=new x
return x.prototype=null,e},C=function(t){return function(e){return null==e?void 0:e[t]}},E=Math.pow(2,53)-1,z=C("length"),j=function(t){var e=z(t)
return"number"==typeof e&&e>=0&&E>=e}
w.each=w.forEach=function(t,e,n){e=y(e,n)
var i,r
if(j(t))for(i=0,r=t.length;r>i;i++)e(t[i],i,t)
else{var o=w.keys(t)
for(i=0,r=o.length;r>i;i++)e(t[o[i]],o[i],t)}return t},w.map=w.collect=function(t,e,n){e=_(e,n)
for(var i=!j(t)&&w.keys(t),r=(i||t).length,o=Array(r),s=0;r>s;s++){var a=i?i[s]:s
o[s]=e(t[a],a,t)}return o},w.reduce=w.foldl=w.inject=t(1),w.reduceRight=w.foldr=t(-1),w.find=w.detect=function(t,e,n){var i
return i=j(t)?w.findIndex(t,e,n):w.findKey(t,e,n),void 0!==i&&-1!==i?t[i]:void 0},w.filter=w.select=function(t,e,n){var i=[]
return e=_(e,n),w.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i},w.reject=function(t,e,n){return w.filter(t,w.negate(_(e)),n)},w.every=w.all=function(t,e,n){e=_(e,n)
for(var i=!j(t)&&w.keys(t),r=(i||t).length,o=0;r>o;o++){var s=i?i[o]:o
if(!e(t[s],s,t))return!1}return!0},w.some=w.any=function(t,e,n){e=_(e,n)
for(var i=!j(t)&&w.keys(t),r=(i||t).length,o=0;r>o;o++){var s=i?i[o]:o
if(e(t[s],s,t))return!0}return!1},w.contains=w.includes=w.include=function(t,e,n,i){return j(t)||(t=w.values(t)),("number"!=typeof n||i)&&(n=0),w.indexOf(t,e,n)>=0},w.invoke=function(t,e){var n=d.call(arguments,2),i=w.isFunction(e)
return w.map(t,function(t){var r=i?e:t[e]
return null==r?r:r.apply(t,n)})},w.pluck=function(t,e){return w.map(t,w.property(e))},w.where=function(t,e){return w.filter(t,w.matcher(e))},w.findWhere=function(t,e){return w.find(t,w.matcher(e))},w.max=function(t,e,n){var i,r,o=-(1/0),s=-(1/0)
if(null==e&&null!=t){t=j(t)?t:w.values(t)
for(var a=0,l=t.length;l>a;a++)i=t[a],i>o&&(o=i)}else e=_(e,n),w.each(t,function(t,n,i){r=e(t,n,i),(r>s||r===-(1/0)&&o===-(1/0))&&(o=t,s=r)})
return o},w.min=function(t,e,n){var i,r,o=1/0,s=1/0
if(null==e&&null!=t){t=j(t)?t:w.values(t)
for(var a=0,l=t.length;l>a;a++)i=t[a],o>i&&(o=i)}else e=_(e,n),w.each(t,function(t,n,i){r=e(t,n,i),(s>r||r===1/0&&o===1/0)&&(o=t,s=r)})
return o},w.shuffle=function(t){for(var e,n=j(t)?t:w.values(t),i=n.length,r=Array(i),o=0;i>o;o++)e=w.random(0,o),e!==o&&(r[o]=r[e]),r[e]=n[o]
return r},w.sample=function(t,e,n){return null==e||n?(j(t)||(t=w.values(t)),t[w.random(t.length-1)]):w.shuffle(t).slice(0,Math.max(0,e))},w.sortBy=function(t,e,n){return e=_(e,n),w.pluck(w.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria
if(n!==i){if(n>i||void 0===n)return 1
if(i>n||void 0===i)return-1}return t.index-e.index}),"value")}
var T=function(t){return function(e,n,i){var r={}
return n=_(n,i),w.each(e,function(i,o){var s=n(i,o,e)
t(r,i,s)}),r}}
w.groupBy=T(function(t,e,n){w.has(t,n)?t[n].push(e):t[n]=[e]}),w.indexBy=T(function(t,e,n){t[n]=e}),w.countBy=T(function(t,e,n){w.has(t,n)?t[n]++:t[n]=1}),w.toArray=function(t){return t?w.isArray(t)?d.call(t):j(t)?w.map(t,w.identity):w.values(t):[]},w.size=function(t){return null==t?0:j(t)?t.length:w.keys(t).length},w.partition=function(t,e,n){e=_(e,n)
var i=[],r=[]
return w.each(t,function(t,n,o){(e(t,n,o)?i:r).push(t)}),[i,r]},w.first=w.head=w.take=function(t,e,n){return null!=t?null==e||n?t[0]:w.initial(t,t.length-e):void 0},w.initial=function(t,e,n){return d.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},w.last=function(t,e,n){return null!=t?null==e||n?t[t.length-1]:w.rest(t,Math.max(0,t.length-e)):void 0},w.rest=w.tail=w.drop=function(t,e,n){return d.call(t,null==e||n?1:e)},w.compact=function(t){return w.filter(t,w.identity)}
var q=function(t,e,n,i){for(var r=[],o=0,s=i||0,a=z(t);a>s;s++){var l=t[s]
if(j(l)&&(w.isArray(l)||w.isArguments(l))){e||(l=q(l,e,n))
var h=0,c=l.length
for(r.length+=c;c>h;)r[o++]=l[h++]}else n||(r[o++]=l)}return r}
w.flatten=function(t,e){return q(t,e,!1)},w.without=function(t){return w.difference(t,d.call(arguments,1))},w.uniq=w.unique=function(t,e,n,i){w.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i))
for(var r=[],o=[],s=0,a=z(t);a>s;s++){var l=t[s],h=n?n(l,s,t):l
e?(s&&o===h||r.push(l),o=h):n?w.contains(o,h)||(o.push(h),r.push(l)):w.contains(r,l)||r.push(l)}return r},w.union=function(){return w.uniq(q(arguments,!0,!0))},w.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=z(t);r>i;i++){var o=t[i]
if(!w.contains(e,o)){for(var s=1;n>s&&w.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},w.difference=function(t){var e=q(arguments,!0,!0,1)
return w.filter(t,function(t){return!w.contains(e,t)})},w.zip=function(){return w.unzip(arguments)},w.unzip=function(t){for(var e=t&&w.max(t,z).length||0,n=Array(e),i=0;e>i;i++)n[i]=w.pluck(t,i)
return n},w.object=function(t,e){for(var n={},i=0,r=z(t);r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1]
return n},w.findIndex=i(1),w.findLastIndex=i(-1),w.sortedIndex=function(t,e,n,i){n=_(n,i,1)
for(var r=n(e),o=0,s=z(t);s>o;){var a=Math.floor((o+s)/2)
n(t[a])<r?o=a+1:s=a}return o},w.indexOf=r(1,w.findIndex,w.sortedIndex),w.lastIndexOf=r(-1,w.findLastIndex),w.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1
for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;i>o;o++,t+=n)r[o]=t
return r}
var M=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r)
var o=k(t.prototype),s=t.apply(o,r)
return w.isObject(s)?s:o}
w.bind=function(t,e){if(v&&t.bind===v)return v.apply(t,d.call(arguments,1))
if(!w.isFunction(t))throw new TypeError("Bind must be called on a function")
var n=d.call(arguments,2),i=function(){return M(t,i,e,this,n.concat(d.call(arguments)))}
return i},w.partial=function(t){var e=d.call(arguments,1),n=function(){for(var i=0,r=e.length,o=Array(r),s=0;r>s;s++)o[s]=e[s]===w?arguments[i++]:e[s]
for(;i<arguments.length;)o.push(arguments[i++])
return M(t,n,this,this,o)}
return n},w.bindAll=function(t){var e,n,i=arguments.length
if(1>=i)throw new Error("bindAll must be passed function names")
for(e=1;i>e;e++)n=arguments[e],t[n]=w.bind(t[n],t)
return t},w.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i)
return w.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]}
return n.cache={},n},w.delay=function(t,e){var n=d.call(arguments,2)
return setTimeout(function(){return t.apply(null,n)},e)},w.defer=w.partial(w.delay,w,1),w.throttle=function(t,e,n){var i,r,o,s=null,a=0
n||(n={})
var l=function(){a=n.leading===!1?0:w.now(),s=null,o=t.apply(i,r),s||(i=r=null)}
return function(){var h=w.now()
a||n.leading!==!1||(a=h)
var c=e-(h-a)
return i=this,r=arguments,0>=c||c>e?(s&&(clearTimeout(s),s=null),a=h,o=t.apply(i,r),s||(i=r=null)):s||n.trailing===!1||(s=setTimeout(l,c)),o}},w.debounce=function(t,e,n){var i,r,o,s,a,l=function(){var h=w.now()-s
e>h&&h>=0?i=setTimeout(l,e-h):(i=null,n||(a=t.apply(o,r),i||(o=r=null)))}
return function(){o=this,r=arguments,s=w.now()
var h=n&&!i
return i||(i=setTimeout(l,e)),h&&(a=t.apply(o,r),o=r=null),a}},w.wrap=function(t,e){return w.partial(e,t)},w.negate=function(t){return function(){return!t.apply(this,arguments)}},w.compose=function(){var t=arguments,e=t.length-1
return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i)
return i}},w.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},w.before=function(t,e){var n
return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},w.once=w.partial(w.before,2)
var L=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"]
w.keys=function(t){if(!w.isObject(t))return[]
if(m)return m(t)
var e=[]
for(var n in t)w.has(t,n)&&e.push(n)
return L&&o(t,e),e},w.allKeys=function(t){if(!w.isObject(t))return[]
var e=[]
for(var n in t)e.push(n)
return L&&o(t,e),e},w.values=function(t){for(var e=w.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=t[e[r]]
return i},w.mapObject=function(t,e,n){e=_(e,n)
for(var i,r=w.keys(t),o=r.length,s={},a=0;o>a;a++)i=r[a],s[i]=e(t[i],i,t)
return s},w.pairs=function(t){for(var e=w.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]]
return i},w.invert=function(t){for(var e={},n=w.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i]
return e},w.functions=w.methods=function(t){var e=[]
for(var n in t)w.isFunction(t[n])&&e.push(n)
return e.sort()},w.extend=S(w.allKeys),w.extendOwn=w.assign=S(w.keys),w.findKey=function(t,e,n){e=_(e,n)
for(var i,r=w.keys(t),o=0,s=r.length;s>o;o++)if(i=r[o],e(t[i],i,t))return i},w.pick=function(t,e,n){var i,r,o={},s=t
if(null==s)return o
w.isFunction(e)?(r=w.allKeys(s),i=y(e,n)):(r=q(arguments,!1,!1,1),i=function(t,e,n){return e in n},s=Object(s))
for(var a=0,l=r.length;l>a;a++){var h=r[a],c=s[h]
i(c,h,s)&&(o[h]=c)}return o},w.omit=function(t,e,n){if(w.isFunction(e))e=w.negate(e)
else{var i=w.map(q(arguments,!1,!1,1),String)
e=function(t,e){return!w.contains(i,e)}}return w.pick(t,e,n)},w.defaults=S(w.allKeys,!0),w.create=function(t,e){var n=k(t)
return e&&w.extendOwn(n,e),n},w.clone=function(t){return w.isObject(t)?w.isArray(t)?t.slice():w.extend({},t):t},w.tap=function(t,e){return e(t),t},w.isMatch=function(t,e){var n=w.keys(e),i=n.length
if(null==t)return!i
for(var r=Object(t),o=0;i>o;o++){var s=n[o]
if(e[s]!==r[s]||!(s in r))return!1}return!0}
var N=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e
if(null==t||null==e)return t===e
t instanceof w&&(t=t._wrapped),e instanceof w&&(e=e._wrapped)
var r=f.call(t)
if(r!==f.call(e))return!1
switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e
case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e
case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===r
if(!o){if("object"!=typeof t||"object"!=typeof e)return!1
var s=t.constructor,a=e.constructor
if(s!==a&&!(w.isFunction(s)&&s instanceof s&&w.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[]
for(var l=n.length;l--;)if(n[l]===t)return i[l]===e
if(n.push(t),i.push(e),o){if(l=t.length,l!==e.length)return!1
for(;l--;)if(!N(t[l],e[l],n,i))return!1}else{var h,c=w.keys(t)
if(l=c.length,w.keys(e).length!==l)return!1
for(;l--;)if(h=c[l],!w.has(e,h)||!N(t[h],e[h],n,i))return!1}return n.pop(),i.pop(),!0}
w.isEqual=function(t,e){return N(t,e)},w.isEmpty=function(t){return null==t?!0:j(t)&&(w.isArray(t)||w.isString(t)||w.isArguments(t))?0===t.length:0===w.keys(t).length},w.isElement=function(t){return!(!t||1!==t.nodeType)},w.isArray=p||function(t){return"[object Array]"===f.call(t)},w.isObject=function(t){var e=typeof t
return"function"===e||"object"===e&&!!t},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){w["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(t){return w.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(t){return"function"==typeof t||!1}),w.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},w.isNaN=function(t){return w.isNumber(t)&&t!==+t},w.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===f.call(t)},w.isNull=function(t){return null===t},w.isUndefined=function(t){return void 0===t},w.has=function(t,e){return null!=t&&g.call(t,e)},w.noConflict=function(){return s._=a,this},w.identity=function(t){return t},w.constant=function(t){return function(){return t}},w.noop=function(){},w.property=C,w.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},w.matcher=w.matches=function(t){return t=w.extendOwn({},t),function(e){return w.isMatch(e,t)}},w.times=function(t,e,n){var i=Array(Math.max(0,t))
e=y(e,n,1)
for(var r=0;t>r;r++)i[r]=e(r)
return i},w.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},w.now=Date.now||function(){return(new Date).getTime()}
var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},A=w.invert(O),F=function(t){var e=function(e){return t[e]},n="(?:"+w.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g")
return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}}
w.escape=F(O),w.unescape=F(A),w.result=function(t,e,n){var i=null==t?void 0:t[e]
return void 0===i&&(i=n),w.isFunction(i)?i.call(t):i}
var I=0
w.uniqueId=function(t){var e=++I+""
return t?t+e:e},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}
var H=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g,B=function(t){return"\\"+D[t]}
w.template=function(t,e,n){!e&&n&&(e=n),e=w.defaults({},e,w.templateSettings)
var i=RegExp([(e.escape||H).source,(e.interpolate||H).source,(e.evaluate||H).source].join("|")+"|$","g"),r=0,o="__p+='"
t.replace(i,function(e,n,i,s,a){return o+=t.slice(r,a).replace(W,B),r=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n"
try{var s=new Function(e.variable||"obj","_",o)}catch(a){throw a.source=o,a}var l=function(t){return s.call(this,t,w)},h=e.variable||"obj"
return l.source="function("+h+"){\n"+o+"}",l},w.chain=function(t){var e=w(t)
return e._chain=!0,e}
var P=function(t,e){return t._chain?w(e).chain():e}
w.mixin=function(t){w.each(w.functions(t),function(e){var n=w[e]=t[e]
w.prototype[e]=function(){var t=[this._wrapped]
return u.apply(t,arguments),P(this,n.apply(w,t))}})},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=l[t]
w.prototype[t]=function(){var n=this._wrapped
return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],P(this,n)}}),w.each(["concat","join","slice"],function(t){var e=l[t]
w.prototype[t]=function(){return P(this,e.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return w})}).call(this)},{}],151:[function(t,e,n){function i(t,e){function n(){4===p.readyState&&S()}function i(){var t=null
if(p.response?t=p.response:"text"!==p.responseType&&p.responseType||(t=p.responseText||p.responseXML),_)try{t=JSON.parse(t)}catch(e){}return t}function o(){return 1223===p.status?204:p.status}function u(t,e){var n=null
if(0===t||t>=400&&600>t){var i=("string"==typeof e?e:!1)||l[String(t).charAt(0)]
n=new Error(i),n.statusCode=t}return n}function d(){var t=o(),n=i(),r=u(t,n),s={body:n,statusCode:t,statusText:p.statusText,raw:p}
p.getAllResponseHeaders?s.headers=a(p.getAllResponseHeaders()):s.headers={},e(r,s,s.body)}function f(){var t=o(),n=u(t)
p.status=p.statusCode=t,p.body=i(),p.headers=a(p.getAllResponseHeaders()),e(n,p,p.body)}function g(t){e(t,p)}"string"==typeof t&&(t={uri:t}),t=t||{},e=s(e)
var p=t.xhr||null
p||(p=t.cors||t.useXDR?new c:new h)
var m,v=p.url=t.uri||t.url,b=p.method=t.method||"GET",x=t.body||t.data,w=p.headers=t.headers||{},y=!!t.sync,_=!1,S=t.response?d:f
if("json"in t&&(_=!0,w.Accept="application/json","GET"!==b&&"HEAD"!==b&&(w["Content-Type"]="application/json",x=JSON.stringify(t.json))),p.onreadystatechange=n,p.onload=S,p.onerror=g,p.onprogress=function(){},p.ontimeout=r,p.open(b,v,!y),(t.withCredentials||t.cors&&t.withCredentials!==!1)&&(p.withCredentials=!0),y||(p.timeout="timeout"in t?t.timeout:5e3),p.setRequestHeader)for(m in w)w.hasOwnProperty(m)&&p.setRequestHeader(m,w[m])
else if(t.headers)throw new Error("Headers cannot be set on an XDomainRequest object")
return"responseType"in t&&(p.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(p),p.send(x),p}function r(){}var o=t("global/window"),s=t("once"),a=t("parse-headers"),l={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},h=o.XMLHttpRequest||r,c="withCredentials"in new h?h:o.XDomainRequest
e.exports=i},{"global/window":152,once:153,"parse-headers":157}],152:[function(t,e,n){arguments[4][78][0].apply(n,arguments)},{dup:78}],153:[function(t,e,n){arguments[4][79][0].apply(n,arguments)},{dup:79}],154:[function(t,e,n){arguments[4][80][0].apply(n,arguments)},{dup:80,"is-function":155}],155:[function(t,e,n){arguments[4][81][0].apply(n,arguments)},{dup:81}],156:[function(t,e,n){arguments[4][82][0].apply(n,arguments)},{dup:82}],157:[function(t,e,n){arguments[4][83][0].apply(n,arguments)},{dup:83,"for-each":154,trim:156}],msa:[function(t,e,n){var i
i=t("./msa"),e.exports=function(){var t
return t=function(t){return i.apply(this,t)},t.prototype=i.prototype,new t(arguments)},e.exports.msa=i,e.exports.model=t("./model"),e.exports.menu=t("./menu"),e.exports.utils=t("./utils"),e.exports.selection=t("./g/selection/Selection"),e.exports.selcol=t("./g/selection/SelectionCol"),e.exports.view=t("backbone-viewj"),e.exports.boneView=t("backbone-childs"),e.exports._=t("underscore"),e.exports.$=t("jbone"),e.exports.io={},e.exports.io.xhr=t("xhr"),e.exports.io.fasta=t("biojs-io-fasta"),e.exports.io.clustal=t("biojs-io-clustal"),e.exports.io.gff=t("biojs-io-gff"),e.exports.version="0.2.0"},{"./g/selection/Selection":6,"./g/selection/SelectionCol":7,"./menu":13,"./model":29,"./msa":30,"./utils":34,"backbone-childs":60,"backbone-viewj":67,"biojs-io-clustal":74,"biojs-io-fasta":84,"biojs-io-gff":94,jbone:126,underscore:150,xhr:151}]},{},[])
